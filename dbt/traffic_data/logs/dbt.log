[0m18:02:20.316125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0e36cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0c91f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0c91fd60>]}


============================== 18:02:20.321322 | 5451191f-3ed2-4f38-a789-8c8078e396f7 ==============================
[0m18:02:20.321322 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:02:20.322619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:02:20.323789 [info ] [MainThread]: dbt version: 1.7.13
[0m18:02:20.324740 [info ] [MainThread]: python version: 3.8.10
[0m18:02:20.325690 [info ] [MainThread]: python path: /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/bin/python3
[0m18:02:20.326646 [info ] [MainThread]: os info: Linux-5.15.0-105-generic-x86_64-with-glibc2.29
[0m18:02:20.508081 [info ] [MainThread]: Using profiles dir at /home/yohanes/.dbt
[0m18:02:20.509172 [info ] [MainThread]: Using profiles.yml file at /home/yohanes/.dbt/profiles.yml
[0m18:02:20.510144 [info ] [MainThread]: Using dbt_project.yml file at /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/dbt_project.yml
[0m18:02:20.511396 [info ] [MainThread]: adapter type: postgres
[0m18:02:20.512359 [info ] [MainThread]: adapter version: 1.7.13
[0m18:02:20.691149 [info ] [MainThread]: Configuration:
[0m18:02:20.692449 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:02:20.693545 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:02:20.694654 [info ] [MainThread]: Required dependencies:
[0m18:02:20.695756 [debug] [MainThread]: Executing "git --help"
[0m18:02:20.707427 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:02:20.710527 [debug] [MainThread]: STDERR: "b''"
[0m18:02:20.712806 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:02:20.715390 [info ] [MainThread]: Connection:
[0m18:02:20.717071 [info ] [MainThread]:   host: localhost
[0m18:02:20.718390 [info ] [MainThread]:   port: 5432
[0m18:02:20.719794 [info ] [MainThread]:   user: postgres
[0m18:02:20.722629 [info ] [MainThread]:   database: traffic
[0m18:02:20.725180 [info ] [MainThread]:   schema: traffic_schema
[0m18:02:20.727124 [info ] [MainThread]:   connect_timeout: 10
[0m18:02:20.728694 [info ] [MainThread]:   role: None
[0m18:02:20.730537 [info ] [MainThread]:   search_path: None
[0m18:02:20.732725 [info ] [MainThread]:   keepalives_idle: 0
[0m18:02:20.734404 [info ] [MainThread]:   sslmode: None
[0m18:02:20.736049 [info ] [MainThread]:   sslcert: None
[0m18:02:20.737750 [info ] [MainThread]:   sslkey: None
[0m18:02:20.740729 [info ] [MainThread]:   sslrootcert: None
[0m18:02:20.742778 [info ] [MainThread]:   application_name: dbt
[0m18:02:20.744846 [info ] [MainThread]:   retries: 1
[0m18:02:20.747082 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m18:02:20.750244 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:02:20.752904 [debug] [MainThread]: Using postgres connection "debug"
[0m18:02:20.754477 [debug] [MainThread]: On debug: select 1 as id
[0m18:02:20.757177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:20.787931 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m18:02:20.793174 [debug] [MainThread]: On debug: Close
[0m18:02:20.795177 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:02:20.796578 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:02:20.799771 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.58511835, "process_user_time": 4.290543, "process_kernel_time": 0.222678, "process_mem_max_rss": "95888", "process_in_blocks": "80", "process_out_blocks": "16"}
[0m18:02:20.801842 [debug] [MainThread]: Command `dbt debug` succeeded at 18:02:20.801240 after 0.59 seconds
[0m18:02:20.803688 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:02:20.805875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0e36cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0b00e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd0b04f7c0>]}
[0m18:02:20.808625 [debug] [MainThread]: Flushing usage events
[0m18:02:30.960600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc12649a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc10bf5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc10bf5a60>]}


============================== 18:02:30.965819 | 1a2911c8-4efc-427b-83dc-f098fb8a4b4a ==============================
[0m18:02:30.965819 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:02:30.967235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'version_check': 'True', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:02:31.633647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a2911c8-4efc-427b-83dc-f098fb8a4b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc10bf5460>]}
[0m18:02:31.818680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a2911c8-4efc-427b-83dc-f098fb8a4b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc0f270e80>]}
[0m18:02:31.820252 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m18:02:31.840986 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m18:02:31.842589 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:02:31.844171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a2911c8-4efc-427b-83dc-f098fb8a4b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc0f1ac6d0>]}
[0m18:02:34.127049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a2911c8-4efc-427b-83dc-f098fb8a4b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc0e619640>]}
[0m18:02:34.146460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a2911c8-4efc-427b-83dc-f098fb8a4b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc0e619820>]}
[0m18:02:34.148358 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:02:34.149588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a2911c8-4efc-427b-83dc-f098fb8a4b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc0f070ee0>]}
[0m18:02:34.152672 [info ] [MainThread]: 
[0m18:02:34.154501 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:02:34.158268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m18:02:34.203058 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m18:02:34.207449 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m18:02:34.208732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:34.315630 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:02:34.318094 [debug] [ThreadPool]: On list_traffic: Close
[0m18:02:34.321428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now create_traffic_traffic_schema)
[0m18:02:34.323519 [debug] [ThreadPool]: Creating schema "database: "traffic"
schema: "traffic_schema"
"
[0m18:02:34.333660 [debug] [ThreadPool]: Using postgres connection "create_traffic_traffic_schema"
[0m18:02:34.334689 [debug] [ThreadPool]: On create_traffic_traffic_schema: BEGIN
[0m18:02:34.335599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:34.370025 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:02:34.372132 [debug] [ThreadPool]: Using postgres connection "create_traffic_traffic_schema"
[0m18:02:34.373909 [debug] [ThreadPool]: On create_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "create_traffic_traffic_schema"} */
create schema if not exists "traffic_schema"
[0m18:02:34.456818 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:02:34.460353 [debug] [ThreadPool]: On create_traffic_traffic_schema: COMMIT
[0m18:02:34.462143 [debug] [ThreadPool]: Using postgres connection "create_traffic_traffic_schema"
[0m18:02:34.463907 [debug] [ThreadPool]: On create_traffic_traffic_schema: COMMIT
[0m18:02:34.483192 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:02:34.485072 [debug] [ThreadPool]: On create_traffic_traffic_schema: Close
[0m18:02:34.489198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_traffic_traffic_schema, now list_traffic_traffic_schema)
[0m18:02:34.504799 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:02:34.506820 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m18:02:34.508527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:34.530068 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:02:34.532250 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:02:34.534210 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m18:02:34.765600 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:02:34.768610 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m18:02:34.770377 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m18:02:34.785244 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:34.786349 [debug] [MainThread]: On master: BEGIN
[0m18:02:34.787297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:34.810842 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:02:34.812672 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:34.814800 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:02:34.935125 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:02:34.939209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a2911c8-4efc-427b-83dc-f098fb8a4b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc0dd7bd30>]}
[0m18:02:34.940670 [debug] [MainThread]: On master: ROLLBACK
[0m18:02:34.942331 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:34.944517 [debug] [MainThread]: On master: BEGIN
[0m18:02:34.947461 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:02:34.949614 [debug] [MainThread]: On master: COMMIT
[0m18:02:34.951268 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:34.952282 [debug] [MainThread]: On master: COMMIT
[0m18:02:34.953647 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:02:34.954713 [debug] [MainThread]: On master: Close
[0m18:02:34.956436 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m18:02:34.957757 [info ] [MainThread]: 
[0m18:02:34.986346 [debug] [Thread-1  ]: Began running node model.traffic_data.my_first_dbt_model
[0m18:02:34.987812 [info ] [Thread-1  ]: 1 of 2 START sql table model traffic_schema.my_first_dbt_model ................. [RUN]
[0m18:02:34.989518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.my_first_dbt_model)
[0m18:02:34.990732 [debug] [Thread-1  ]: Began compiling node model.traffic_data.my_first_dbt_model
[0m18:02:35.014096 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.my_first_dbt_model"
[0m18:02:35.017621 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (compile): 18:02:34.991866 => 18:02:35.016421
[0m18:02:35.019739 [debug] [Thread-1  ]: Began executing node model.traffic_data.my_first_dbt_model
[0m18:02:35.111404 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.my_first_dbt_model"
[0m18:02:35.113065 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:02:35.114098 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: BEGIN
[0m18:02:35.115268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:02:35.136387 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:02:35.137838 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:02:35.139190 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */

  
    

  create  table "traffic"."traffic_schema"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:02:35.176253 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m18:02:35.193171 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:02:35.194462 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
alter table "traffic"."traffic_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:02:35.220498 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:02:35.265188 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: COMMIT
[0m18:02:35.266411 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:02:35.267530 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: COMMIT
[0m18:02:35.296778 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:02:35.311296 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."my_first_dbt_model__dbt_backup"
[0m18:02:35.320969 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:02:35.322180 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
drop table if exists "traffic"."traffic_schema"."my_first_dbt_model__dbt_backup" cascade
[0m18:02:35.323836 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:02:35.327132 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (execute): 18:02:35.020867 => 18:02:35.326528
[0m18:02:35.328268 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: Close
[0m18:02:35.330061 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a2911c8-4efc-427b-83dc-f098fb8a4b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc0dd2afd0>]}
[0m18:02:35.332040 [info ] [Thread-1  ]: 1 of 2 OK created sql table model traffic_schema.my_first_dbt_model ............ [[32mSELECT 2[0m in 0.34s]
[0m18:02:35.333764 [debug] [Thread-1  ]: Finished running node model.traffic_data.my_first_dbt_model
[0m18:02:35.336037 [debug] [Thread-3  ]: Began running node model.traffic_data.my_second_dbt_model
[0m18:02:35.337335 [info ] [Thread-3  ]: 2 of 2 START sql view model traffic_schema.my_second_dbt_model ................. [RUN]
[0m18:02:35.339899 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.my_second_dbt_model'
[0m18:02:35.342037 [debug] [Thread-3  ]: Began compiling node model.traffic_data.my_second_dbt_model
[0m18:02:35.351872 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.my_second_dbt_model"
[0m18:02:35.354913 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (compile): 18:02:35.343322 => 18:02:35.353660
[0m18:02:35.357387 [debug] [Thread-3  ]: Began executing node model.traffic_data.my_second_dbt_model
[0m18:02:35.415982 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.my_second_dbt_model"
[0m18:02:35.417528 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:02:35.418603 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: BEGIN
[0m18:02:35.419644 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:02:35.444228 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:02:35.446797 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:02:35.448522 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */

  create view "traffic"."traffic_schema"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "traffic"."traffic_schema"."my_first_dbt_model"
where id = 1
  );
[0m18:02:35.519969 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:02:35.530916 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:02:35.533967 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */
alter table "traffic"."traffic_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:02:35.536904 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:02:35.541196 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: COMMIT
[0m18:02:35.542419 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:02:35.543577 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: COMMIT
[0m18:02:35.552897 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:02:35.565147 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."my_second_dbt_model__dbt_backup"
[0m18:02:35.574378 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:02:35.575939 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */
drop view if exists "traffic"."traffic_schema"."my_second_dbt_model__dbt_backup" cascade
[0m18:02:35.580083 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:02:35.586070 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (execute): 18:02:35.358794 => 18:02:35.585011
[0m18:02:35.588047 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: Close
[0m18:02:35.592043 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a2911c8-4efc-427b-83dc-f098fb8a4b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc0c4bac70>]}
[0m18:02:35.595946 [info ] [Thread-3  ]: 2 of 2 OK created sql view model traffic_schema.my_second_dbt_model ............ [[32mCREATE VIEW[0m in 0.25s]
[0m18:02:35.599190 [debug] [Thread-3  ]: Finished running node model.traffic_data.my_second_dbt_model
[0m18:02:35.604533 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:35.606576 [debug] [MainThread]: On master: BEGIN
[0m18:02:35.609487 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:35.637089 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:02:35.638347 [debug] [MainThread]: On master: COMMIT
[0m18:02:35.639378 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:35.640356 [debug] [MainThread]: On master: COMMIT
[0m18:02:35.641801 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:02:35.642888 [debug] [MainThread]: On master: Close
[0m18:02:35.646428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:35.649337 [debug] [MainThread]: Connection 'model.traffic_data.my_first_dbt_model' was properly closed.
[0m18:02:35.651808 [debug] [MainThread]: Connection 'model.traffic_data.my_second_dbt_model' was properly closed.
[0m18:02:35.653438 [info ] [MainThread]: 
[0m18:02:35.654537 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m18:02:35.656541 [debug] [MainThread]: Command end result
[0m18:02:35.675938 [info ] [MainThread]: 
[0m18:02:35.677545 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:35.680431 [info ] [MainThread]: 
[0m18:02:35.684051 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:02:35.688413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.822227, "process_user_time": 7.535531, "process_kernel_time": 0.199352, "process_mem_max_rss": "110340", "process_in_blocks": "376", "process_out_blocks": "2440"}
[0m18:02:35.690596 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:35.690094 after 4.82 seconds
[0m18:02:35.691720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc12649a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc0e619820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc0f070400>]}
[0m18:02:35.692720 [debug] [MainThread]: Flushing usage events
[0m18:06:55.527757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78eed81c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ed334310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ed334d60>]}


============================== 18:06:55.532592 | 481e78a9-6dc9-4120-8cef-40076b00d5fe ==============================
[0m18:06:55.532592 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:06:55.533883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:55.535016 [info ] [MainThread]: dbt version: 1.7.13
[0m18:06:55.535978 [info ] [MainThread]: python version: 3.8.10
[0m18:06:55.536928 [info ] [MainThread]: python path: /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/bin/python3
[0m18:06:55.537947 [info ] [MainThread]: os info: Linux-5.15.0-105-generic-x86_64-with-glibc2.29
[0m18:06:55.819755 [info ] [MainThread]: Using profiles dir at /home/yohanes/.dbt
[0m18:06:55.822428 [info ] [MainThread]: Using profiles.yml file at /home/yohanes/.dbt/profiles.yml
[0m18:06:55.824880 [info ] [MainThread]: Using dbt_project.yml file at /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/dbt_project.yml
[0m18:06:55.828629 [info ] [MainThread]: adapter type: postgres
[0m18:06:55.832063 [info ] [MainThread]: adapter version: 1.7.13
[0m18:06:56.142124 [info ] [MainThread]: Configuration:
[0m18:06:56.143287 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:06:56.144263 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:06:56.145223 [info ] [MainThread]: Required dependencies:
[0m18:06:56.146214 [debug] [MainThread]: Executing "git --help"
[0m18:06:56.154780 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:06:56.156986 [debug] [MainThread]: STDERR: "b''"
[0m18:06:56.158386 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:06:56.159738 [info ] [MainThread]: Connection:
[0m18:06:56.161584 [info ] [MainThread]:   host: localhost
[0m18:06:56.163722 [info ] [MainThread]:   port: 5432
[0m18:06:56.166027 [info ] [MainThread]:   user: postgres
[0m18:06:56.168404 [info ] [MainThread]:   database: traffic
[0m18:06:56.170721 [info ] [MainThread]:   schema: traffic_schema
[0m18:06:56.173566 [info ] [MainThread]:   connect_timeout: 10
[0m18:06:56.185133 [info ] [MainThread]:   role: None
[0m18:06:56.187781 [info ] [MainThread]:   search_path: None
[0m18:06:56.190348 [info ] [MainThread]:   keepalives_idle: 0
[0m18:06:56.191989 [info ] [MainThread]:   sslmode: None
[0m18:06:56.193981 [info ] [MainThread]:   sslcert: None
[0m18:06:56.196941 [info ] [MainThread]:   sslkey: None
[0m18:06:56.200719 [info ] [MainThread]:   sslrootcert: None
[0m18:06:56.202618 [info ] [MainThread]:   application_name: dbt
[0m18:06:56.204492 [info ] [MainThread]:   retries: 1
[0m18:06:56.206408 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m18:06:56.209139 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:06:56.211460 [debug] [MainThread]: Using postgres connection "debug"
[0m18:06:56.214672 [debug] [MainThread]: On debug: select 1 as id
[0m18:06:56.217119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:56.249372 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m18:06:56.253986 [debug] [MainThread]: On debug: Close
[0m18:06:56.256066 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:06:56.257615 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:06:56.260137 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.8319124, "process_user_time": 4.428819, "process_kernel_time": 0.162853, "process_mem_max_rss": "95448", "process_out_blocks": "16", "process_in_blocks": "0"}
[0m18:06:56.261817 [debug] [MainThread]: Command `dbt debug` succeeded at 18:06:56.261351 after 0.83 seconds
[0m18:06:56.264737 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:06:56.267995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78eed81c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f05f4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f0fe16a0>]}
[0m18:06:56.270222 [debug] [MainThread]: Flushing usage events
[0m18:07:03.282459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005f03ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005d5ef400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005d5efb20>]}


============================== 18:07:03.288230 | 4d245130-12f5-4187-8246-9579f7469bb7 ==============================
[0m18:07:03.288230 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:07:03.289495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:07:03.621233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d245130-12f5-4187-8246-9579f7469bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00608b1d60>]}
[0m18:07:03.800642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d245130-12f5-4187-8246-9579f7469bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005bd8e3d0>]}
[0m18:07:03.802198 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m18:07:03.826314 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m18:07:03.895255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:07:03.896503 [debug] [MainThread]: Partial parsing: added file: traffic_data://models/example/trajectory_summary.sql
[0m18:07:04.156871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d245130-12f5-4187-8246-9579f7469bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005b30f7f0>]}
[0m18:07:04.173792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d245130-12f5-4187-8246-9579f7469bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005ba2bdc0>]}
[0m18:07:04.175051 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:07:04.176386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d245130-12f5-4187-8246-9579f7469bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005ba2bd30>]}
[0m18:07:04.181040 [info ] [MainThread]: 
[0m18:07:04.183384 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:07:04.186660 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m18:07:04.218937 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m18:07:04.220338 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m18:07:04.221487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:04.250025 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:07:04.253443 [debug] [ThreadPool]: On list_traffic: Close
[0m18:07:04.256808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m18:07:04.275277 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:07:04.277972 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m18:07:04.279355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:04.302754 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:07:04.303910 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:07:04.304944 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m18:07:04.311293 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:07:04.314227 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m18:07:04.316147 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m18:07:04.328717 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:04.329966 [debug] [MainThread]: On master: BEGIN
[0m18:07:04.331093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:04.355366 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:04.357010 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:04.358624 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:07:04.368643 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m18:07:04.373621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d245130-12f5-4187-8246-9579f7469bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005b2b6880>]}
[0m18:07:04.375492 [debug] [MainThread]: On master: ROLLBACK
[0m18:07:04.377564 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:04.379497 [debug] [MainThread]: On master: BEGIN
[0m18:07:04.381827 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:04.383618 [debug] [MainThread]: On master: COMMIT
[0m18:07:04.385377 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:04.387253 [debug] [MainThread]: On master: COMMIT
[0m18:07:04.388473 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:07:04.389415 [debug] [MainThread]: On master: Close
[0m18:07:04.391562 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m18:07:04.393305 [info ] [MainThread]: 
[0m18:07:04.398499 [debug] [Thread-1  ]: Began running node model.traffic_data.my_first_dbt_model
[0m18:07:04.400926 [debug] [Thread-2  ]: Began running node model.traffic_data.trajectory_summary
[0m18:07:04.402913 [info ] [Thread-1  ]: 1 of 3 START sql table model traffic_schema.my_first_dbt_model ................. [RUN]
[0m18:07:04.405014 [info ] [Thread-2  ]: 2 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m18:07:04.407290 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.my_first_dbt_model)
[0m18:07:04.413252 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.trajectory_summary'
[0m18:07:04.415645 [debug] [Thread-1  ]: Began compiling node model.traffic_data.my_first_dbt_model
[0m18:07:04.417665 [debug] [Thread-2  ]: Began compiling node model.traffic_data.trajectory_summary
[0m18:07:04.447312 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.my_first_dbt_model"
[0m18:07:04.450268 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m18:07:04.452949 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (compile): 18:07:04.419350 => 18:07:04.451891
[0m18:07:04.454647 [debug] [Thread-1  ]: Began executing node model.traffic_data.my_first_dbt_model
[0m18:07:04.463052 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (compile): 18:07:04.424576 => 18:07:04.461140
[0m18:07:04.470836 [debug] [Thread-2  ]: Began executing node model.traffic_data.trajectory_summary
[0m18:07:04.645785 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m18:07:04.655382 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.my_first_dbt_model"
[0m18:07:04.657236 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:07:04.658888 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m18:07:04.660536 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:07:04.661913 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:07:04.663693 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: BEGIN
[0m18:07:04.665255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:07:04.684970 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:07:04.687327 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:07:04.689139 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        -- MAX(time) AS total_time
    
    FROm trajectory
    GROUP BY track_id
)
  );
[0m18:07:04.690763 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:07:04.692691 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:07:04.694235 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */

  
    

  create  table "traffic"."traffic_schema"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:07:04.717473 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "FROm"
LINE 15:     FROm trajectory
             ^

[0m18:07:04.719204 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: ROLLBACK
[0m18:07:04.721742 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (execute): 18:07:04.477737 => 18:07:04.720844
[0m18:07:04.723053 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: Close
[0m18:07:04.725024 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m18:07:04.743364 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:07:04.744908 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
alter table "traffic"."traffic_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:07:04.746779 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:04.754081 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:07:04.755400 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
alter table "traffic"."traffic_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:07:04.757287 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:04.805023 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: COMMIT
[0m18:07:04.806247 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:07:04.807324 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: COMMIT
[0m18:07:04.847081 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:07:04.865840 [debug] [Thread-2  ]: Database Error in model trajectory_summary (models/example/trajectory_summary.sql)
  syntax error at or near "FROm"
  LINE 15:     FROm trajectory
               ^
  compiled Code at target/run/traffic_data/models/example/trajectory_summary.sql
[0m18:07:04.869220 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d245130-12f5-4187-8246-9579f7469bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005b2b6760>]}
[0m18:07:04.863787 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."my_first_dbt_model__dbt_backup"
[0m18:07:04.879201 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model traffic_schema.trajectory_summary ......... [[31mERROR[0m in 0.46s]
[0m18:07:04.886975 [debug] [Thread-2  ]: Finished running node model.traffic_data.trajectory_summary
[0m18:07:04.891177 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:07:04.893241 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
drop table if exists "traffic"."traffic_schema"."my_first_dbt_model__dbt_backup" cascade
[0m18:07:04.947824 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:07:04.953107 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (execute): 18:07:04.455587 => 18:07:04.952230
[0m18:07:04.954953 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: Close
[0m18:07:04.957510 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d245130-12f5-4187-8246-9579f7469bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005b2abd00>]}
[0m18:07:04.959840 [info ] [Thread-1  ]: 1 of 3 OK created sql table model traffic_schema.my_first_dbt_model ............ [[32mSELECT 2[0m in 0.55s]
[0m18:07:04.963290 [debug] [Thread-1  ]: Finished running node model.traffic_data.my_first_dbt_model
[0m18:07:04.968830 [debug] [Thread-3  ]: Began running node model.traffic_data.my_second_dbt_model
[0m18:07:04.971987 [info ] [Thread-3  ]: 3 of 3 START sql view model traffic_schema.my_second_dbt_model ................. [RUN]
[0m18:07:04.974887 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.my_second_dbt_model'
[0m18:07:04.978915 [debug] [Thread-3  ]: Began compiling node model.traffic_data.my_second_dbt_model
[0m18:07:04.991847 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.my_second_dbt_model"
[0m18:07:04.994405 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (compile): 18:07:04.981666 => 18:07:04.993416
[0m18:07:04.997112 [debug] [Thread-3  ]: Began executing node model.traffic_data.my_second_dbt_model
[0m18:07:05.017639 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.my_second_dbt_model"
[0m18:07:05.020252 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:07:05.022179 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: BEGIN
[0m18:07:05.024141 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:07:05.046302 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:07:05.048821 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:07:05.053417 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */

  create view "traffic"."traffic_schema"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "traffic"."traffic_schema"."my_first_dbt_model"
where id = 1
  );
[0m18:07:05.059338 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:07:05.077082 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:07:05.080671 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */
alter table "traffic"."traffic_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:07:05.085054 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:05.093286 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: COMMIT
[0m18:07:05.095191 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:07:05.096957 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: COMMIT
[0m18:07:05.124952 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:07:05.134310 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."my_second_dbt_model__dbt_backup"
[0m18:07:05.144516 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:07:05.147577 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */
drop view if exists "traffic"."traffic_schema"."my_second_dbt_model__dbt_backup" cascade
[0m18:07:05.150031 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:07:05.156561 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (execute): 18:07:04.998360 => 18:07:05.155409
[0m18:07:05.158839 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: Close
[0m18:07:05.162420 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d245130-12f5-4187-8246-9579f7469bb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00581cd1c0>]}
[0m18:07:05.165451 [info ] [Thread-3  ]: 3 of 3 OK created sql view model traffic_schema.my_second_dbt_model ............ [[32mCREATE VIEW[0m in 0.19s]
[0m18:07:05.167833 [debug] [Thread-3  ]: Finished running node model.traffic_data.my_second_dbt_model
[0m18:07:05.172473 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:05.173609 [debug] [MainThread]: On master: BEGIN
[0m18:07:05.180203 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:05.209911 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:05.212534 [debug] [MainThread]: On master: COMMIT
[0m18:07:05.215457 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:05.218375 [debug] [MainThread]: On master: COMMIT
[0m18:07:05.221381 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:07:05.222600 [debug] [MainThread]: On master: Close
[0m18:07:05.225576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:05.227506 [debug] [MainThread]: Connection 'model.traffic_data.my_first_dbt_model' was properly closed.
[0m18:07:05.228964 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m18:07:05.230910 [debug] [MainThread]: Connection 'model.traffic_data.my_second_dbt_model' was properly closed.
[0m18:07:05.232712 [info ] [MainThread]: 
[0m18:07:05.234320 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m18:07:05.237328 [debug] [MainThread]: Command end result
[0m18:07:05.262530 [info ] [MainThread]: 
[0m18:07:05.265412 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:07:05.267539 [info ] [MainThread]: 
[0m18:07:05.269331 [error] [MainThread]:   Database Error in model trajectory_summary (models/example/trajectory_summary.sql)
  syntax error at or near "FROm"
  LINE 15:     FROm trajectory
               ^
  compiled Code at target/run/traffic_data/models/example/trajectory_summary.sql
[0m18:07:05.271178 [info ] [MainThread]: 
[0m18:07:05.273124 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:07:05.275193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0872822, "process_user_time": 5.610956, "process_kernel_time": 0.15208, "process_mem_max_rss": "109188", "process_in_blocks": "56", "process_out_blocks": "2464", "command_success": false}
[0m18:07:05.277101 [debug] [MainThread]: Command `dbt run` failed at 18:07:05.276672 after 2.09 seconds
[0m18:07:05.278137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005f03ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005ba2bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005bd8e3d0>]}
[0m18:07:05.279278 [debug] [MainThread]: Flushing usage events
[0m18:07:42.166277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9c814ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9adca760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9adcaac0>]}


============================== 18:07:42.171200 | f2cde5ac-5444-408c-aded-605f4e5c486b ==============================
[0m18:07:42.171200 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:07:42.172637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'version_check': 'True', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:07:42.505292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2cde5ac-5444-408c-aded-605f4e5c486b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9bf4c520>]}
[0m18:07:42.679297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2cde5ac-5444-408c-aded-605f4e5c486b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9add3820>]}
[0m18:07:42.680853 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m18:07:42.706900 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m18:07:42.776195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:42.777904 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/example/trajectory_summary.sql
[0m18:07:43.037328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2cde5ac-5444-408c-aded-605f4e5c486b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb988e2790>]}
[0m18:07:43.058823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2cde5ac-5444-408c-aded-605f4e5c486b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb992d1d30>]}
[0m18:07:43.060046 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:07:43.061363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2cde5ac-5444-408c-aded-605f4e5c486b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb992d1f10>]}
[0m18:07:43.065678 [info ] [MainThread]: 
[0m18:07:43.068307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:07:43.072304 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m18:07:43.106919 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m18:07:43.110119 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m18:07:43.114562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:43.150132 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:07:43.154592 [debug] [ThreadPool]: On list_traffic: Close
[0m18:07:43.164396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m18:07:43.185515 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:07:43.187308 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m18:07:43.189048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:43.213811 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:07:43.214955 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:07:43.215980 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m18:07:43.223513 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:07:43.227248 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m18:07:43.228992 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m18:07:43.241570 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:43.243281 [debug] [MainThread]: On master: BEGIN
[0m18:07:43.245105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:43.268053 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:43.269108 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:43.270147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:07:43.280197 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m18:07:43.284288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2cde5ac-5444-408c-aded-605f4e5c486b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb992d1ee0>]}
[0m18:07:43.285806 [debug] [MainThread]: On master: ROLLBACK
[0m18:07:43.287470 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:43.288693 [debug] [MainThread]: On master: BEGIN
[0m18:07:43.290439 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:43.291750 [debug] [MainThread]: On master: COMMIT
[0m18:07:43.292980 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:43.294405 [debug] [MainThread]: On master: COMMIT
[0m18:07:43.296064 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:07:43.297136 [debug] [MainThread]: On master: Close
[0m18:07:43.298870 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m18:07:43.300113 [info ] [MainThread]: 
[0m18:07:43.305738 [debug] [Thread-1  ]: Began running node model.traffic_data.my_first_dbt_model
[0m18:07:43.307777 [debug] [Thread-2  ]: Began running node model.traffic_data.trajectory_summary
[0m18:07:43.309915 [info ] [Thread-1  ]: 1 of 3 START sql table model traffic_schema.my_first_dbt_model ................. [RUN]
[0m18:07:43.311797 [info ] [Thread-2  ]: 2 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m18:07:43.314279 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.my_first_dbt_model)
[0m18:07:43.317639 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.trajectory_summary'
[0m18:07:43.320816 [debug] [Thread-1  ]: Began compiling node model.traffic_data.my_first_dbt_model
[0m18:07:43.323789 [debug] [Thread-2  ]: Began compiling node model.traffic_data.trajectory_summary
[0m18:07:43.357039 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m18:07:43.355531 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.my_first_dbt_model"
[0m18:07:43.362848 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (compile): 18:07:43.327153 => 18:07:43.361152
[0m18:07:43.365425 [debug] [Thread-1  ]: Began executing node model.traffic_data.my_first_dbt_model
[0m18:07:43.378773 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (compile): 18:07:43.338087 => 18:07:43.377184
[0m18:07:43.385474 [debug] [Thread-2  ]: Began executing node model.traffic_data.trajectory_summary
[0m18:07:43.540701 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m18:07:43.553090 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.my_first_dbt_model"
[0m18:07:43.554912 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:07:43.556568 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:07:43.558217 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: BEGIN
[0m18:07:43.560165 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m18:07:43.562274 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:07:43.563776 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:07:43.585645 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:07:43.587690 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:07:43.589520 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:07:43.591541 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:07:43.593305 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */

  
    

  create  table "traffic"."traffic_schema"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:07:43.595542 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)
  );
[0m18:07:43.600129 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 18:   );
           ^

[0m18:07:43.602498 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m18:07:43.604445 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: ROLLBACK
[0m18:07:43.623336 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:07:43.625750 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (execute): 18:07:43.391650 => 18:07:43.624546
[0m18:07:43.628299 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
alter table "traffic"."traffic_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:07:43.630197 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: Close
[0m18:07:43.633430 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:43.641114 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:07:43.642641 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
alter table "traffic"."traffic_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:07:43.644909 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:43.685820 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: COMMIT
[0m18:07:43.687144 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:07:43.688279 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: COMMIT
[0m18:07:43.693051 [debug] [Thread-2  ]: Database Error in model trajectory_summary (models/example/trajectory_summary.sql)
  syntax error at or near ")"
  LINE 18:   );
             ^
  compiled Code at target/run/traffic_data/models/example/trajectory_summary.sql
[0m18:07:43.695612 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:07:43.697121 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cde5ac-5444-408c-aded-605f4e5c486b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9177edc0>]}
[0m18:07:43.709785 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model traffic_schema.trajectory_summary ......... [[31mERROR[0m in 0.38s]
[0m18:07:43.717385 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."my_first_dbt_model__dbt_backup"
[0m18:07:43.720804 [debug] [Thread-2  ]: Finished running node model.traffic_data.trajectory_summary
[0m18:07:43.738728 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:07:43.740024 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
drop table if exists "traffic"."traffic_schema"."my_first_dbt_model__dbt_backup" cascade
[0m18:07:43.752859 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:07:43.756683 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (execute): 18:07:43.366545 => 18:07:43.756084
[0m18:07:43.758464 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: Close
[0m18:07:43.763422 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cde5ac-5444-408c-aded-605f4e5c486b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb917f8fd0>]}
[0m18:07:43.766376 [info ] [Thread-1  ]: 1 of 3 OK created sql table model traffic_schema.my_first_dbt_model ............ [[32mSELECT 2[0m in 0.45s]
[0m18:07:43.768843 [debug] [Thread-1  ]: Finished running node model.traffic_data.my_first_dbt_model
[0m18:07:43.771105 [debug] [Thread-3  ]: Began running node model.traffic_data.my_second_dbt_model
[0m18:07:43.772656 [info ] [Thread-3  ]: 3 of 3 START sql view model traffic_schema.my_second_dbt_model ................. [RUN]
[0m18:07:43.776019 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.my_second_dbt_model'
[0m18:07:43.779729 [debug] [Thread-3  ]: Began compiling node model.traffic_data.my_second_dbt_model
[0m18:07:43.787971 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.my_second_dbt_model"
[0m18:07:43.790656 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (compile): 18:07:43.781192 => 18:07:43.789865
[0m18:07:43.792414 [debug] [Thread-3  ]: Began executing node model.traffic_data.my_second_dbt_model
[0m18:07:43.810537 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.my_second_dbt_model"
[0m18:07:43.813788 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:07:43.817154 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: BEGIN
[0m18:07:43.818985 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:07:43.843255 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:07:43.845737 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:07:43.847858 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */

  create view "traffic"."traffic_schema"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "traffic"."traffic_schema"."my_first_dbt_model"
where id = 1
  );
[0m18:07:43.852269 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:07:43.859283 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:07:43.860775 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */
alter table "traffic"."traffic_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:07:43.862770 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:07:43.866882 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: COMMIT
[0m18:07:43.868095 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:07:43.869172 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: COMMIT
[0m18:07:43.918487 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:07:43.927879 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."my_second_dbt_model__dbt_backup"
[0m18:07:43.934777 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:07:43.936015 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */
drop view if exists "traffic"."traffic_schema"."my_second_dbt_model__dbt_backup" cascade
[0m18:07:43.937746 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:07:43.941359 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (execute): 18:07:43.793692 => 18:07:43.940622
[0m18:07:43.942584 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: Close
[0m18:07:43.945351 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2cde5ac-5444-408c-aded-605f4e5c486b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb91788280>]}
[0m18:07:43.947885 [info ] [Thread-3  ]: 3 of 3 OK created sql view model traffic_schema.my_second_dbt_model ............ [[32mCREATE VIEW[0m in 0.17s]
[0m18:07:43.950111 [debug] [Thread-3  ]: Finished running node model.traffic_data.my_second_dbt_model
[0m18:07:43.954904 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:43.956759 [debug] [MainThread]: On master: BEGIN
[0m18:07:43.958430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:43.984781 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:07:43.986209 [debug] [MainThread]: On master: COMMIT
[0m18:07:43.987501 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:43.988579 [debug] [MainThread]: On master: COMMIT
[0m18:07:43.989862 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:07:43.990893 [debug] [MainThread]: On master: Close
[0m18:07:43.992951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:43.995729 [debug] [MainThread]: Connection 'model.traffic_data.my_first_dbt_model' was properly closed.
[0m18:07:43.998489 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m18:07:43.999752 [debug] [MainThread]: Connection 'model.traffic_data.my_second_dbt_model' was properly closed.
[0m18:07:44.000901 [info ] [MainThread]: 
[0m18:07:44.002770 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m18:07:44.005476 [debug] [MainThread]: Command end result
[0m18:07:44.023422 [info ] [MainThread]: 
[0m18:07:44.024893 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:07:44.026403 [info ] [MainThread]: 
[0m18:07:44.028915 [error] [MainThread]:   Database Error in model trajectory_summary (models/example/trajectory_summary.sql)
  syntax error at or near ")"
  LINE 18:   );
             ^
  compiled Code at target/run/traffic_data/models/example/trajectory_summary.sql
[0m18:07:44.030930 [info ] [MainThread]: 
[0m18:07:44.032454 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m18:07:44.035489 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9618391, "process_user_time": 5.542421, "process_kernel_time": 0.160649, "process_mem_max_rss": "108916", "process_out_blocks": "2472", "command_success": false, "process_in_blocks": "0"}
[0m18:07:44.038410 [debug] [MainThread]: Command `dbt run` failed at 18:07:44.037475 after 1.96 seconds
[0m18:07:44.039876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9c814ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9bf4c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb9801cfd0>]}
[0m18:07:44.041042 [debug] [MainThread]: Flushing usage events
[0m18:08:37.598128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc4fbaac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc35667f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3566c10>]}


============================== 18:08:37.603731 | 9c8ec63e-f490-4fe8-8f3b-3c8ea6790a67 ==============================
[0m18:08:37.603731 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:08:37.605108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:08:37.936692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c8ec63e-f490-4fe8-8f3b-3c8ea6790a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc46fa520>]}
[0m18:08:38.132267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c8ec63e-f490-4fe8-8f3b-3c8ea6790a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc3575820>]}
[0m18:08:38.133828 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m18:08:38.160232 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m18:08:38.230280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:08:38.232711 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/example/trajectory_summary.sql
[0m18:08:38.495873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c8ec63e-f490-4fe8-8f3b-3c8ea6790a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc1089790>]}
[0m18:08:38.516972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c8ec63e-f490-4fe8-8f3b-3c8ea6790a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc1a76d30>]}
[0m18:08:38.518157 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:08:38.519178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c8ec63e-f490-4fe8-8f3b-3c8ea6790a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc1a76f10>]}
[0m18:08:38.522892 [info ] [MainThread]: 
[0m18:08:38.524550 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:08:38.528670 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m18:08:38.565941 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m18:08:38.568152 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m18:08:38.570546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:38.604931 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:08:38.610166 [debug] [ThreadPool]: On list_traffic: Close
[0m18:08:38.614787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m18:08:38.628322 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:08:38.629536 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m18:08:38.630610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:38.649383 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:08:38.650992 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:08:38.652033 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m18:08:38.657283 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m18:08:38.661240 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m18:08:38.663071 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m18:08:38.676918 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:38.677954 [debug] [MainThread]: On master: BEGIN
[0m18:08:38.678843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:38.700310 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:38.701510 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:38.702694 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:08:38.712826 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m18:08:38.717525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c8ec63e-f490-4fe8-8f3b-3c8ea6790a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc1a76ee0>]}
[0m18:08:38.719415 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:38.721112 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:38.722437 [debug] [MainThread]: On master: BEGIN
[0m18:08:38.724452 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:38.725939 [debug] [MainThread]: On master: COMMIT
[0m18:08:38.727251 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:38.728250 [debug] [MainThread]: On master: COMMIT
[0m18:08:38.729815 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:08:38.730909 [debug] [MainThread]: On master: Close
[0m18:08:38.732633 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m18:08:38.733875 [info ] [MainThread]: 
[0m18:08:38.738792 [debug] [Thread-1  ]: Began running node model.traffic_data.my_first_dbt_model
[0m18:08:38.740892 [debug] [Thread-2  ]: Began running node model.traffic_data.trajectory_summary
[0m18:08:38.742857 [info ] [Thread-1  ]: 1 of 3 START sql table model traffic_schema.my_first_dbt_model ................. [RUN]
[0m18:08:38.744944 [info ] [Thread-2  ]: 2 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m18:08:38.747372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.my_first_dbt_model)
[0m18:08:38.752044 [debug] [Thread-1  ]: Began compiling node model.traffic_data.my_first_dbt_model
[0m18:08:38.750019 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.trajectory_summary'
[0m18:08:38.767953 [debug] [Thread-2  ]: Began compiling node model.traffic_data.trajectory_summary
[0m18:08:38.794043 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m18:08:38.803783 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (compile): 18:08:38.775714 => 18:08:38.801514
[0m18:08:38.797030 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.my_first_dbt_model"
[0m18:08:38.807048 [debug] [Thread-2  ]: Began executing node model.traffic_data.trajectory_summary
[0m18:08:38.834516 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (compile): 18:08:38.753716 => 18:08:38.833768
[0m18:08:38.841288 [debug] [Thread-1  ]: Began executing node model.traffic_data.my_first_dbt_model
[0m18:08:38.959271 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m18:08:38.967748 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.my_first_dbt_model"
[0m18:08:38.969957 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:08:38.971948 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m18:08:38.973172 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:08:38.975495 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:08:38.978202 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: BEGIN
[0m18:08:38.979542 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:08:38.998626 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:08:38.999848 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:08:39.001449 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m18:08:39.003761 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:08:39.005115 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:08:39.006394 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */

  
    

  create  table "traffic"."traffic_schema"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:08:39.010196 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m18:08:39.023973 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:08:39.025601 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
alter table "traffic"."traffic_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:08:39.027493 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:08:39.036271 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:08:39.038243 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
alter table "traffic"."traffic_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:08:39.040528 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:08:39.061106 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:08:39.081314 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:08:39.088986 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m18:08:39.101605 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:08:39.103097 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: COMMIT
[0m18:08:39.109523 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m18:08:39.111103 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:08:39.112652 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:08:39.114155 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: COMMIT
[0m18:08:39.115690 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m18:08:39.132411 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:08:39.150254 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."my_first_dbt_model__dbt_backup"
[0m18:08:39.151867 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:08:39.163572 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:08:39.176422 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
drop table if exists "traffic"."traffic_schema"."my_first_dbt_model__dbt_backup" cascade
[0m18:08:39.179071 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m18:08:39.186355 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:08:39.188011 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:08:39.189467 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m18:08:39.194294 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (execute): 18:08:38.847507 => 18:08:39.193383
[0m18:08:39.196529 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: Close
[0m18:08:39.198287 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:08:39.203361 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (execute): 18:08:38.808038 => 18:08:39.202436
[0m18:08:39.205514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c8ec63e-f490-4fe8-8f3b-3c8ea6790a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc1bb37f0>]}
[0m18:08:39.206982 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: Close
[0m18:08:39.209224 [info ] [Thread-1  ]: 1 of 3 OK created sql table model traffic_schema.my_first_dbt_model ............ [[32mSELECT 2[0m in 0.46s]
[0m18:08:39.212489 [debug] [Thread-1  ]: Finished running node model.traffic_data.my_first_dbt_model
[0m18:08:39.215423 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c8ec63e-f490-4fe8-8f3b-3c8ea6790a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc07bffa0>]}
[0m18:08:39.218330 [debug] [Thread-3  ]: Began running node model.traffic_data.my_second_dbt_model
[0m18:08:39.221189 [info ] [Thread-2  ]: 2 of 3 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.47s]
[0m18:08:39.227636 [debug] [Thread-2  ]: Finished running node model.traffic_data.trajectory_summary
[0m18:08:39.223924 [info ] [Thread-3  ]: 3 of 3 START sql view model traffic_schema.my_second_dbt_model ................. [RUN]
[0m18:08:39.233103 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.my_second_dbt_model'
[0m18:08:39.235879 [debug] [Thread-3  ]: Began compiling node model.traffic_data.my_second_dbt_model
[0m18:08:39.245463 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.my_second_dbt_model"
[0m18:08:39.247445 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (compile): 18:08:39.236821 => 18:08:39.246585
[0m18:08:39.250727 [debug] [Thread-3  ]: Began executing node model.traffic_data.my_second_dbt_model
[0m18:08:39.264423 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.my_second_dbt_model"
[0m18:08:39.268567 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:08:39.271685 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: BEGIN
[0m18:08:39.273468 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:08:39.296926 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:08:39.298247 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:08:39.300314 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */

  create view "traffic"."traffic_schema"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "traffic"."traffic_schema"."my_first_dbt_model"
where id = 1
  );
[0m18:08:39.305871 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:08:39.314190 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:08:39.315672 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */
alter table "traffic"."traffic_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:08:39.317897 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:08:39.321670 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: COMMIT
[0m18:08:39.322878 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:08:39.323992 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: COMMIT
[0m18:08:39.354633 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:08:39.362091 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."my_second_dbt_model__dbt_backup"
[0m18:08:39.365402 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:08:39.366899 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */
drop view if exists "traffic"."traffic_schema"."my_second_dbt_model__dbt_backup" cascade
[0m18:08:39.368785 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:08:39.372059 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (execute): 18:08:39.252154 => 18:08:39.371344
[0m18:08:39.373381 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: Close
[0m18:08:39.375642 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c8ec63e-f490-4fe8-8f3b-3c8ea6790a67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc07bffa0>]}
[0m18:08:39.377925 [info ] [Thread-3  ]: 3 of 3 OK created sql view model traffic_schema.my_second_dbt_model ............ [[32mCREATE VIEW[0m in 0.14s]
[0m18:08:39.379695 [debug] [Thread-3  ]: Finished running node model.traffic_data.my_second_dbt_model
[0m18:08:39.383676 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:39.385528 [debug] [MainThread]: On master: BEGIN
[0m18:08:39.387037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:39.411430 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:08:39.412685 [debug] [MainThread]: On master: COMMIT
[0m18:08:39.413789 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:39.414841 [debug] [MainThread]: On master: COMMIT
[0m18:08:39.417907 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:08:39.419734 [debug] [MainThread]: On master: Close
[0m18:08:39.424455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:39.427222 [debug] [MainThread]: Connection 'model.traffic_data.my_first_dbt_model' was properly closed.
[0m18:08:39.428145 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m18:08:39.428998 [debug] [MainThread]: Connection 'model.traffic_data.my_second_dbt_model' was properly closed.
[0m18:08:39.429971 [info ] [MainThread]: 
[0m18:08:39.431146 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m18:08:39.434798 [debug] [MainThread]: Command end result
[0m18:08:39.455889 [info ] [MainThread]: 
[0m18:08:39.458003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:39.459878 [info ] [MainThread]: 
[0m18:08:39.461926 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:08:39.464334 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9645532, "process_user_time": 5.676414, "process_kernel_time": 0.179507, "process_mem_max_rss": "109136", "process_in_blocks": "120", "process_out_blocks": "2472"}
[0m18:08:39.465981 [debug] [MainThread]: Command `dbt run` succeeded at 18:08:39.465574 after 1.97 seconds
[0m18:08:39.468278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc4fbaac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc1bb9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc1982220>]}
[0m18:08:39.470297 [debug] [MainThread]: Flushing usage events
[0m18:10:10.891713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb977cdca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb976292460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb976292b80>]}


============================== 18:10:10.896788 | c8ed6a57-7a4b-4122-80b8-9b802199bdb6 ==============================
[0m18:10:10.896788 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:10:10.898081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'debug': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m18:10:11.226333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8ed6a57-7a4b-4122-80b8-9b802199bdb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97954fcd0>]}
[0m18:10:11.402576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8ed6a57-7a4b-4122-80b8-9b802199bdb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb974a2d490>]}
[0m18:10:11.404200 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m18:10:11.426822 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m18:10:11.492288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:10:11.493304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:10:11.503861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8ed6a57-7a4b-4122-80b8-9b802199bdb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9746ecf10>]}
[0m18:10:11.507039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8ed6a57-7a4b-4122-80b8-9b802199bdb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb974798d30>]}
[0m18:10:11.508179 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:10:11.509396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8ed6a57-7a4b-4122-80b8-9b802199bdb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb974798eb0>]}
[0m18:10:11.512458 [info ] [MainThread]: 
[0m18:10:11.514181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:11.517505 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic_traffic_schema'
[0m18:10:11.546442 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:10:11.547604 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m18:10:11.550087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:11.576055 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:10:11.577406 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:10:11.578407 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m18:10:11.587009 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:10:11.593417 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m18:10:11.596171 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m18:10:11.611158 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:11.612638 [debug] [MainThread]: On master: BEGIN
[0m18:10:11.613631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:11.636573 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:10:11.637709 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:11.638864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:11.649659 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:10:11.653587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8ed6a57-7a4b-4122-80b8-9b802199bdb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97491d250>]}
[0m18:10:11.655057 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:11.656638 [debug] [MainThread]: On master: Close
[0m18:10:11.659141 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m18:10:11.660805 [info ] [MainThread]: 
[0m18:10:11.666221 [debug] [Thread-1  ]: Began running node model.traffic_data.my_first_dbt_model
[0m18:10:11.668462 [debug] [Thread-2  ]: Began running node model.traffic_data.trajectory_summary
[0m18:10:11.670833 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.my_first_dbt_model)
[0m18:10:11.673834 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.trajectory_summary'
[0m18:10:11.675669 [debug] [Thread-1  ]: Began compiling node model.traffic_data.my_first_dbt_model
[0m18:10:11.677739 [debug] [Thread-2  ]: Began compiling node model.traffic_data.trajectory_summary
[0m18:10:11.706492 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.my_first_dbt_model"
[0m18:10:11.708453 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m18:10:11.710631 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (compile): 18:10:11.679129 => 18:10:11.709836
[0m18:10:11.712021 [debug] [Thread-1  ]: Began executing node model.traffic_data.my_first_dbt_model
[0m18:10:11.713453 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (execute): 18:10:11.712773 => 18:10:11.712793
[0m18:10:11.717214 [debug] [Thread-1  ]: Finished running node model.traffic_data.my_first_dbt_model
[0m18:10:11.719399 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (compile): 18:10:11.689787 => 18:10:11.718224
[0m18:10:11.722372 [debug] [Thread-2  ]: Began executing node model.traffic_data.trajectory_summary
[0m18:10:11.724555 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (execute): 18:10:11.723609 => 18:10:11.723643
[0m18:10:11.728100 [debug] [Thread-2  ]: Finished running node model.traffic_data.trajectory_summary
[0m18:10:11.730086 [debug] [Thread-3  ]: Began running node model.traffic_data.my_second_dbt_model
[0m18:10:11.732527 [debug] [Thread-1  ]: Began running node test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:10:11.734366 [debug] [Thread-2  ]: Began running node test.traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m18:10:11.736851 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.my_second_dbt_model'
[0m18:10:11.739330 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.traffic_data.my_first_dbt_model, now test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710)
[0m18:10:11.741785 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.traffic_data.trajectory_summary, now test.traffic_data.unique_my_first_dbt_model_id.16e066b321)
[0m18:10:11.743992 [debug] [Thread-3  ]: Began compiling node model.traffic_data.my_second_dbt_model
[0m18:10:11.745804 [debug] [Thread-1  ]: Began compiling node test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:10:11.747578 [debug] [Thread-2  ]: Began compiling node test.traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m18:10:11.757686 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.my_second_dbt_model"
[0m18:10:11.802505 [debug] [Thread-1  ]: Writing injected SQL for node "test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:10:11.804449 [debug] [Thread-2  ]: Writing injected SQL for node "test.traffic_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:10:11.807161 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (compile): 18:10:11.748598 => 18:10:11.806228
[0m18:10:11.809417 [debug] [Thread-3  ]: Began executing node model.traffic_data.my_second_dbt_model
[0m18:10:11.811436 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (execute): 18:10:11.810670 => 18:10:11.810749
[0m18:10:11.813598 [debug] [Thread-3  ]: Finished running node model.traffic_data.my_second_dbt_model
[0m18:10:11.815598 [debug] [Thread-1  ]: Timing info for test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 18:10:11.758854 => 18:10:11.814921
[0m18:10:11.817779 [debug] [Thread-2  ]: Timing info for test.traffic_data.unique_my_first_dbt_model_id.16e066b321 (compile): 18:10:11.769224 => 18:10:11.816738
[0m18:10:11.819686 [debug] [Thread-1  ]: Began executing node test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:10:11.821565 [debug] [Thread-3  ]: Began running node test.traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:10:11.823229 [debug] [Thread-2  ]: Began executing node test.traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m18:10:11.825345 [debug] [Thread-1  ]: Timing info for test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 18:10:11.824504 => 18:10:11.824533
[0m18:10:11.827741 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.traffic_data.my_second_dbt_model, now test.traffic_data.not_null_my_second_dbt_model_id.151b76d778)
[0m18:10:11.829928 [debug] [Thread-2  ]: Timing info for test.traffic_data.unique_my_first_dbt_model_id.16e066b321 (execute): 18:10:11.828755 => 18:10:11.828797
[0m18:10:11.832944 [debug] [Thread-1  ]: Finished running node test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:10:11.834683 [debug] [Thread-3  ]: Began compiling node test.traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:10:11.837511 [debug] [Thread-2  ]: Finished running node test.traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m18:10:11.839094 [debug] [Thread-1  ]: Began running node test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:10:11.852129 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710, now test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:10:11.854223 [debug] [Thread-3  ]: Writing injected SQL for node "test.traffic_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:10:11.855419 [debug] [Thread-1  ]: Began compiling node test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:10:11.865650 [debug] [Thread-1  ]: Writing injected SQL for node "test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:10:11.867690 [debug] [Thread-3  ]: Timing info for test.traffic_data.not_null_my_second_dbt_model_id.151b76d778 (compile): 18:10:11.840206 => 18:10:11.866627
[0m18:10:11.869574 [debug] [Thread-3  ]: Began executing node test.traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:10:11.871872 [debug] [Thread-3  ]: Timing info for test.traffic_data.not_null_my_second_dbt_model_id.151b76d778 (execute): 18:10:11.870830 => 18:10:11.870862
[0m18:10:11.875398 [debug] [Thread-3  ]: Finished running node test.traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:10:11.877015 [debug] [Thread-1  ]: Timing info for test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493 (compile): 18:10:11.856383 => 18:10:11.876440
[0m18:10:11.878323 [debug] [Thread-1  ]: Began executing node test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:10:11.880319 [debug] [Thread-1  ]: Timing info for test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493 (execute): 18:10:11.879280 => 18:10:11.879311
[0m18:10:11.883545 [debug] [Thread-1  ]: Finished running node test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:10:11.886395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:11.888019 [debug] [MainThread]: Connection 'test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:10:11.889489 [debug] [MainThread]: Connection 'test.traffic_data.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m18:10:11.890985 [debug] [MainThread]: Connection 'test.traffic_data.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m18:10:11.896111 [debug] [MainThread]: Command end result
[0m18:10:11.935197 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:10:11.937211 [info ] [MainThread]: Building catalog
[0m18:10:11.943853 [debug] [ThreadPool]: Acquiring new postgres connection 'traffic.information_schema'
[0m18:10:11.974789 [debug] [ThreadPool]: Using postgres connection "traffic.information_schema"
[0m18:10:11.977930 [debug] [ThreadPool]: On traffic.information_schema: BEGIN
[0m18:10:11.981014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:12.010818 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:10:12.012995 [debug] [ThreadPool]: Using postgres connection "traffic.information_schema"
[0m18:10:12.015567 [debug] [ThreadPool]: On traffic.information_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "traffic.information_schema"} */

    
    

    select
        'traffic' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('my_second_dbt_model')) or (upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('trajectory_summary')) or (upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('my_first_dbt_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:10:12.134811 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:10:12.150968 [debug] [ThreadPool]: On traffic.information_schema: ROLLBACK
[0m18:10:12.153120 [debug] [ThreadPool]: On traffic.information_schema: Close
[0m18:10:12.178020 [info ] [MainThread]: Catalog written to /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/target/catalog.json
[0m18:10:12.181610 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.416697, "process_user_time": 4.963586, "process_kernel_time": 0.148226, "process_mem_max_rss": "104268", "process_in_blocks": "192", "process_out_blocks": "4648"}
[0m18:10:12.184194 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:10:12.183711 after 1.42 seconds
[0m18:10:12.187439 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:10:12.189158 [debug] [MainThread]: Connection 'traffic.information_schema' was properly closed.
[0m18:10:12.190944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb977cdca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97954fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97492cfd0>]}
[0m18:10:12.193329 [debug] [MainThread]: Flushing usage events
[0m18:10:36.929766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df283cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df0de4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df0de4910>]}


============================== 18:10:36.934881 | e0140b15-8c57-4c02-8019-87f5ab0a4969 ==============================
[0m18:10:36.934881 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:10:36.936280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:10:37.263783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0140b15-8c57-4c02-8019-87f5ab0a4969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df40add00>]}
[0m18:10:37.440150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0140b15-8c57-4c02-8019-87f5ab0a4969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9def4d9eb0>]}
[0m18:12:11.212858 [error] [MainThread]: Encountered an error:

[0m18:12:12.214935 [error] [MainThread]: Traceback (most recent call last):
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.8/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m18:12:12.338338 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 95.50367, "process_user_time": 4.478785, "process_kernel_time": 0.115968, "process_mem_max_rss": "94288", "process_in_blocks": "920", "process_out_blocks": "2960", "command_success": false}
[0m18:12:12.340157 [debug] [MainThread]: Command `dbt docs serve` failed at 18:12:12.339774 after 95.51 seconds
[0m18:12:12.341256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9df283cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9def3b3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9def3b3130>]}
[0m18:12:12.342342 [debug] [MainThread]: Flushing usage events
[0m18:12:24.688316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b009fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ae655370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ae655910>]}


============================== 18:12:24.693618 | 2c3bcd5f-7ee7-4113-8a9f-5cebbcde2254 ==============================
[0m18:12:24.693618 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:12:24.695095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:12:25.688858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c3bcd5f-7ee7-4113-8a9f-5cebbcde2254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ae655340>]}
[0m18:12:25.867397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c3bcd5f-7ee7-4113-8a9f-5cebbcde2254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3accc9e80>]}
[0m18:12:25.869064 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m18:12:25.894957 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m18:12:25.984099 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m18:12:25.985322 [debug] [MainThread]: Partial parsing: added file: traffic_data://models/trajectory_summary.sql
[0m18:12:25.986294 [debug] [MainThread]: Partial parsing: deleted file: traffic_data://models/example/trajectory_summary.sql
[0m18:12:26.261822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c3bcd5f-7ee7-4113-8a9f-5cebbcde2254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ac371760>]}
[0m18:12:26.279376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c3bcd5f-7ee7-4113-8a9f-5cebbcde2254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3acb5eca0>]}
[0m18:12:26.280551 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:12:26.281671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c3bcd5f-7ee7-4113-8a9f-5cebbcde2254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3acb5ef70>]}
[0m18:12:26.285954 [info ] [MainThread]: 
[0m18:12:26.288310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:12:26.291348 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m18:12:26.322530 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m18:12:26.324182 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m18:12:26.327536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:26.352876 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:12:26.355407 [debug] [ThreadPool]: On list_traffic: Close
[0m18:12:26.362334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m18:12:26.378673 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:12:26.379938 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m18:12:26.380899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:26.399895 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:12:26.401042 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:12:26.402102 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m18:12:26.409846 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:12:26.413354 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m18:12:26.414969 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m18:12:26.426919 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:26.427950 [debug] [MainThread]: On master: BEGIN
[0m18:12:26.428815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:26.446819 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:12:26.448304 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:26.449816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:12:26.460265 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:12:26.464103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c3bcd5f-7ee7-4113-8a9f-5cebbcde2254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3acb5efa0>]}
[0m18:12:26.465511 [debug] [MainThread]: On master: ROLLBACK
[0m18:12:26.467148 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:26.468735 [debug] [MainThread]: On master: BEGIN
[0m18:12:26.470565 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:12:26.471874 [debug] [MainThread]: On master: COMMIT
[0m18:12:26.473092 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:26.474453 [debug] [MainThread]: On master: COMMIT
[0m18:12:26.475906 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:12:26.476941 [debug] [MainThread]: On master: Close
[0m18:12:26.478594 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m18:12:26.479966 [info ] [MainThread]: 
[0m18:12:26.484242 [debug] [Thread-1  ]: Began running node model.traffic_data.my_first_dbt_model
[0m18:12:26.485727 [debug] [Thread-2  ]: Began running node model.traffic_data.trajectory_summary
[0m18:12:26.487872 [info ] [Thread-1  ]: 1 of 3 START sql table model traffic_schema.my_first_dbt_model ................. [RUN]
[0m18:12:26.492366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.my_first_dbt_model)
[0m18:12:26.494544 [debug] [Thread-1  ]: Began compiling node model.traffic_data.my_first_dbt_model
[0m18:12:26.489514 [info ] [Thread-2  ]: 2 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m18:12:26.510688 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.trajectory_summary'
[0m18:12:26.512800 [debug] [Thread-2  ]: Began compiling node model.traffic_data.trajectory_summary
[0m18:12:26.529660 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.my_first_dbt_model"
[0m18:12:26.527393 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m18:12:26.533483 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (compile): 18:12:26.513774 => 18:12:26.532771
[0m18:12:26.535500 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (compile): 18:12:26.496437 => 18:12:26.534254
[0m18:12:26.537304 [debug] [Thread-2  ]: Began executing node model.traffic_data.trajectory_summary
[0m18:12:26.538631 [debug] [Thread-1  ]: Began executing node model.traffic_data.my_first_dbt_model
[0m18:12:26.713267 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m18:12:26.726766 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.my_first_dbt_model"
[0m18:12:26.728338 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:12:26.729538 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m18:12:26.730643 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:12:26.732315 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:12:26.733591 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: BEGIN
[0m18:12:26.734818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:26.751905 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:12:26.753185 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:12:26.755128 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m18:12:26.757669 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:12:26.759540 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:12:26.760930 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */

  
    

  create  table "traffic"."traffic_schema"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:12:26.777909 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m18:12:26.779896 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:12:26.802156 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:12:26.803761 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:12:26.805050 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m18:12:26.806396 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
alter table "traffic"."traffic_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:12:26.808458 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:12:26.809613 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:12:26.816532 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:12:26.825948 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:12:26.827499 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m18:12:26.829047 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
alter table "traffic"."traffic_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:12:26.830982 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:12:26.832406 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:12:26.918963 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: COMMIT
[0m18:12:26.920339 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m18:12:26.921604 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:12:26.922948 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:12:26.924354 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: COMMIT
[0m18:12:26.925753 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m18:12:26.956565 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:12:26.977509 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."my_first_dbt_model__dbt_backup"
[0m18:12:26.986858 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:12:26.988014 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
drop table if exists "traffic"."traffic_schema"."my_first_dbt_model__dbt_backup" cascade
[0m18:12:26.989260 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:12:26.996580 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m18:12:27.002621 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:12:27.003757 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m18:12:27.034321 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:12:27.037611 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (execute): 18:12:26.551246 => 18:12:27.037032
[0m18:12:27.038689 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: Close
[0m18:12:27.040879 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c3bcd5f-7ee7-4113-8a9f-5cebbcde2254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ac2d6fa0>]}
[0m18:12:27.042500 [info ] [Thread-1  ]: 1 of 3 OK created sql table model traffic_schema.my_first_dbt_model ............ [[32mSELECT 2[0m in 0.55s]
[0m18:12:27.044150 [debug] [Thread-1  ]: Finished running node model.traffic_data.my_first_dbt_model
[0m18:12:27.046220 [debug] [Thread-3  ]: Began running node model.traffic_data.my_second_dbt_model
[0m18:12:27.048490 [info ] [Thread-3  ]: 3 of 3 START sql view model traffic_schema.my_second_dbt_model ................. [RUN]
[0m18:12:27.051713 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.my_second_dbt_model'
[0m18:12:27.054078 [debug] [Thread-3  ]: Began compiling node model.traffic_data.my_second_dbt_model
[0m18:12:27.064911 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.my_second_dbt_model"
[0m18:12:27.067525 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:12:27.072346 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (execute): 18:12:26.539609 => 18:12:27.071765
[0m18:12:27.073701 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: Close
[0m18:12:27.075415 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (compile): 18:12:27.055626 => 18:12:27.074596
[0m18:12:27.077628 [debug] [Thread-3  ]: Began executing node model.traffic_data.my_second_dbt_model
[0m18:12:27.086123 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c3bcd5f-7ee7-4113-8a9f-5cebbcde2254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ac2c03d0>]}
[0m18:12:27.094262 [info ] [Thread-2  ]: 2 of 3 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.58s]
[0m18:12:27.104174 [debug] [Thread-2  ]: Finished running node model.traffic_data.trajectory_summary
[0m18:12:27.106210 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.my_second_dbt_model"
[0m18:12:27.108169 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:12:27.109300 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: BEGIN
[0m18:12:27.110571 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:12:27.137721 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:12:27.139319 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:12:27.140942 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */

  create view "traffic"."traffic_schema"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "traffic"."traffic_schema"."my_first_dbt_model"
where id = 1
  );
[0m18:12:27.144353 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:12:27.157203 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:12:27.159075 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */
alter table "traffic"."traffic_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:12:27.161501 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:12:27.166866 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: COMMIT
[0m18:12:27.168192 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:12:27.169366 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: COMMIT
[0m18:12:27.189525 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:12:27.197769 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."my_second_dbt_model__dbt_backup"
[0m18:12:27.201993 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:12:27.203487 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */
drop view if exists "traffic"."traffic_schema"."my_second_dbt_model__dbt_backup" cascade
[0m18:12:27.205180 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:12:27.209008 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (execute): 18:12:27.080040 => 18:12:27.208380
[0m18:12:27.210231 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: Close
[0m18:12:27.212162 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c3bcd5f-7ee7-4113-8a9f-5cebbcde2254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ac2e75e0>]}
[0m18:12:27.214013 [info ] [Thread-3  ]: 3 of 3 OK created sql view model traffic_schema.my_second_dbt_model ............ [[32mCREATE VIEW[0m in 0.16s]
[0m18:12:27.215797 [debug] [Thread-3  ]: Finished running node model.traffic_data.my_second_dbt_model
[0m18:12:27.218980 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:27.219982 [debug] [MainThread]: On master: BEGIN
[0m18:12:27.221290 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:12:27.251970 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:12:27.253250 [debug] [MainThread]: On master: COMMIT
[0m18:12:27.254222 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:27.255189 [debug] [MainThread]: On master: COMMIT
[0m18:12:27.256726 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:12:27.258202 [debug] [MainThread]: On master: Close
[0m18:12:27.260272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:27.262187 [debug] [MainThread]: Connection 'model.traffic_data.my_first_dbt_model' was properly closed.
[0m18:12:27.264638 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m18:12:27.266282 [debug] [MainThread]: Connection 'model.traffic_data.my_second_dbt_model' was properly closed.
[0m18:12:27.267831 [info ] [MainThread]: 
[0m18:12:27.269425 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m18:12:27.271977 [debug] [MainThread]: Command end result
[0m18:12:27.299045 [info ] [MainThread]: 
[0m18:12:27.302283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:27.304680 [info ] [MainThread]: 
[0m18:12:27.306835 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:12:27.311177 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.905192, "process_user_time": 5.538108, "process_kernel_time": 0.243564, "process_mem_max_rss": "108704", "process_in_blocks": "6584", "process_out_blocks": "2456"}
[0m18:12:27.314003 [debug] [MainThread]: Command `dbt run` succeeded at 18:12:27.313035 after 2.91 seconds
[0m18:12:27.316243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b009fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3acc056a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3ac2841c0>]}
[0m18:12:27.317493 [debug] [MainThread]: Flushing usage events
[0m18:12:34.958831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99baee4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b94994c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b9499c70>]}


============================== 18:12:34.964010 | 55aa6a05-3166-451b-9882-42cbbbcc2a3e ==============================
[0m18:12:34.964010 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:12:34.965302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:12:35.297728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55aa6a05-3166-451b-9882-42cbbbcc2a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bc757d60>]}
[0m18:12:35.472842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55aa6a05-3166-451b-9882-42cbbbcc2a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bb62edf0>]}
[0m18:12:35.474448 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m18:12:35.497626 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m18:12:35.565740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:35.566797 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:35.577602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55aa6a05-3166-451b-9882-42cbbbcc2a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b78f40d0>]}
[0m18:12:35.582252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55aa6a05-3166-451b-9882-42cbbbcc2a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b79bc850>]}
[0m18:12:35.584561 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:12:35.586521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55aa6a05-3166-451b-9882-42cbbbcc2a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b79bca00>]}
[0m18:12:35.592148 [info ] [MainThread]: 
[0m18:12:35.594927 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:12:35.598663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic_traffic_schema'
[0m18:12:35.637516 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:12:35.639282 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m18:12:35.640456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:35.668303 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:12:35.669711 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:12:35.671291 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m18:12:35.678904 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:12:35.682049 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m18:12:35.683613 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m18:12:35.698055 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:35.699466 [debug] [MainThread]: On master: BEGIN
[0m18:12:35.700624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:35.727544 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:12:35.729817 [debug] [MainThread]: Using postgres connection "master"
[0m18:12:35.731536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:12:35.741364 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:12:35.745667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55aa6a05-3166-451b-9882-42cbbbcc2a3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b7bdf580>]}
[0m18:12:35.747327 [debug] [MainThread]: On master: ROLLBACK
[0m18:12:35.748848 [debug] [MainThread]: On master: Close
[0m18:12:35.751267 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m18:12:35.753273 [info ] [MainThread]: 
[0m18:12:35.758660 [debug] [Thread-1  ]: Began running node model.traffic_data.my_first_dbt_model
[0m18:12:35.760980 [debug] [Thread-2  ]: Began running node model.traffic_data.trajectory_summary
[0m18:12:35.764094 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.my_first_dbt_model)
[0m18:12:35.767203 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.trajectory_summary'
[0m18:12:35.769298 [debug] [Thread-1  ]: Began compiling node model.traffic_data.my_first_dbt_model
[0m18:12:35.771871 [debug] [Thread-2  ]: Began compiling node model.traffic_data.trajectory_summary
[0m18:12:35.800808 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.my_first_dbt_model"
[0m18:12:35.803811 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m18:12:35.807510 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (compile): 18:12:35.784374 => 18:12:35.805737
[0m18:12:35.811354 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (compile): 18:12:35.773053 => 18:12:35.809105
[0m18:12:35.813433 [debug] [Thread-2  ]: Began executing node model.traffic_data.trajectory_summary
[0m18:12:35.815865 [debug] [Thread-1  ]: Began executing node model.traffic_data.my_first_dbt_model
[0m18:12:35.817936 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (execute): 18:12:35.816915 => 18:12:35.816949
[0m18:12:35.819928 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (execute): 18:12:35.819262 => 18:12:35.819280
[0m18:12:35.823669 [debug] [Thread-2  ]: Finished running node model.traffic_data.trajectory_summary
[0m18:12:35.827507 [debug] [Thread-1  ]: Finished running node model.traffic_data.my_first_dbt_model
[0m18:12:35.831031 [debug] [Thread-3  ]: Began running node model.traffic_data.my_second_dbt_model
[0m18:12:35.832928 [debug] [Thread-2  ]: Began running node test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:12:35.835261 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.my_second_dbt_model'
[0m18:12:35.836909 [debug] [Thread-1  ]: Began running node test.traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m18:12:35.839003 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.traffic_data.trajectory_summary, now test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710)
[0m18:12:35.840299 [debug] [Thread-3  ]: Began compiling node model.traffic_data.my_second_dbt_model
[0m18:12:35.842600 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.traffic_data.my_first_dbt_model, now test.traffic_data.unique_my_first_dbt_model_id.16e066b321)
[0m18:12:35.856215 [debug] [Thread-1  ]: Began compiling node test.traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m18:12:35.844116 [debug] [Thread-2  ]: Began compiling node test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:12:35.859137 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.my_second_dbt_model"
[0m18:12:35.901156 [debug] [Thread-1  ]: Writing injected SQL for node "test.traffic_data.unique_my_first_dbt_model_id.16e066b321"
[0m18:12:35.913560 [debug] [Thread-2  ]: Writing injected SQL for node "test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:12:35.916206 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (compile): 18:12:35.845146 => 18:12:35.915077
[0m18:12:35.918480 [debug] [Thread-1  ]: Timing info for test.traffic_data.unique_my_first_dbt_model_id.16e066b321 (compile): 18:12:35.860446 => 18:12:35.917406
[0m18:12:35.920815 [debug] [Thread-2  ]: Timing info for test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 18:12:35.870940 => 18:12:35.919784
[0m18:12:35.922381 [debug] [Thread-3  ]: Began executing node model.traffic_data.my_second_dbt_model
[0m18:12:35.924122 [debug] [Thread-1  ]: Began executing node test.traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m18:12:35.925612 [debug] [Thread-2  ]: Began executing node test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:12:35.927579 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (execute): 18:12:35.926632 => 18:12:35.926666
[0m18:12:35.929599 [debug] [Thread-1  ]: Timing info for test.traffic_data.unique_my_first_dbt_model_id.16e066b321 (execute): 18:12:35.928639 => 18:12:35.928666
[0m18:12:35.931582 [debug] [Thread-2  ]: Timing info for test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 18:12:35.930685 => 18:12:35.930725
[0m18:12:35.934624 [debug] [Thread-3  ]: Finished running node model.traffic_data.my_second_dbt_model
[0m18:12:35.938585 [debug] [Thread-1  ]: Finished running node test.traffic_data.unique_my_first_dbt_model_id.16e066b321
[0m18:12:35.941950 [debug] [Thread-2  ]: Finished running node test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:12:35.945105 [debug] [Thread-3  ]: Began running node test.traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:35.946884 [debug] [Thread-1  ]: Began running node test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:35.948927 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.traffic_data.my_second_dbt_model, now test.traffic_data.not_null_my_second_dbt_model_id.151b76d778)
[0m18:12:35.950901 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.traffic_data.unique_my_first_dbt_model_id.16e066b321, now test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493)
[0m18:12:35.952558 [debug] [Thread-3  ]: Began compiling node test.traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:35.954120 [debug] [Thread-1  ]: Began compiling node test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:35.971010 [debug] [Thread-3  ]: Writing injected SQL for node "test.traffic_data.not_null_my_second_dbt_model_id.151b76d778"
[0m18:12:35.977962 [debug] [Thread-1  ]: Writing injected SQL for node "test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:12:35.980323 [debug] [Thread-3  ]: Timing info for test.traffic_data.not_null_my_second_dbt_model_id.151b76d778 (compile): 18:12:35.955181 => 18:12:35.979251
[0m18:12:35.982141 [debug] [Thread-3  ]: Began executing node test.traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:35.984441 [debug] [Thread-1  ]: Timing info for test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493 (compile): 18:12:35.965559 => 18:12:35.983347
[0m18:12:35.986433 [debug] [Thread-3  ]: Timing info for test.traffic_data.not_null_my_second_dbt_model_id.151b76d778 (execute): 18:12:35.985660 => 18:12:35.985685
[0m18:12:35.988522 [debug] [Thread-1  ]: Began executing node test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:35.991379 [debug] [Thread-3  ]: Finished running node test.traffic_data.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:35.993318 [debug] [Thread-1  ]: Timing info for test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493 (execute): 18:12:35.992347 => 18:12:35.992382
[0m18:12:35.997266 [debug] [Thread-1  ]: Finished running node test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:36.000495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:36.001762 [debug] [MainThread]: Connection 'test.traffic_data.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:12:36.003008 [debug] [MainThread]: Connection 'test.traffic_data.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m18:12:36.004463 [debug] [MainThread]: Connection 'test.traffic_data.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m18:12:36.009360 [debug] [MainThread]: Command end result
[0m18:12:36.096381 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:12:36.097369 [info ] [MainThread]: Building catalog
[0m18:12:36.101718 [debug] [ThreadPool]: Acquiring new postgres connection 'traffic.information_schema'
[0m18:12:36.131266 [debug] [ThreadPool]: Using postgres connection "traffic.information_schema"
[0m18:12:36.133025 [debug] [ThreadPool]: On traffic.information_schema: BEGIN
[0m18:12:36.135239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:36.163886 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:12:36.165893 [debug] [ThreadPool]: Using postgres connection "traffic.information_schema"
[0m18:12:36.168091 [debug] [ThreadPool]: On traffic.information_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "traffic.information_schema"} */

    
    

    select
        'traffic' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('trajectory_summary')) or (upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('my_first_dbt_model')) or (upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('my_second_dbt_model')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:12:36.175164 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:12:36.186033 [debug] [ThreadPool]: On traffic.information_schema: ROLLBACK
[0m18:12:36.188464 [debug] [ThreadPool]: On traffic.information_schema: Close
[0m18:12:36.209906 [info ] [MainThread]: Catalog written to /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/target/catalog.json
[0m18:12:36.211819 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.3482753, "process_user_time": 4.980312, "process_kernel_time": 0.147771, "process_mem_max_rss": "103960", "process_in_blocks": "368", "process_out_blocks": "4632"}
[0m18:12:36.213374 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:12:36.213019 after 1.35 seconds
[0m18:12:36.214311 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:12:36.215361 [debug] [MainThread]: Connection 'traffic.information_schema' was properly closed.
[0m18:12:36.216882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99baee4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bc757d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99b7a44790>]}
[0m18:12:36.218106 [debug] [MainThread]: Flushing usage events
[0m18:12:43.279061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab233b9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2196b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2196bb20>]}


============================== 18:12:43.284042 | a95f79e5-e58a-4275-ae99-2d7e633b2e6b ==============================
[0m18:12:43.284042 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:12:43.285543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:12:43.627495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a95f79e5-e58a-4275-ae99-2d7e633b2e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab24c4ad90>]}
[0m18:12:43.818022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a95f79e5-e58a-4275-ae99-2d7e633b2e6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab2197a940>]}
[0m18:12:44.883571 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m18:12:44.889931 [error] [MainThread]: Traceback (most recent call last):
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/lib/python3.8/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/lib/python3.8/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m18:12:44.905462 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 1.7287631, "process_user_time": 4.393057, "process_kernel_time": 0.179879, "process_mem_max_rss": "94124", "process_out_blocks": "2960", "command_success": false, "process_in_blocks": "0"}
[0m18:12:44.909256 [debug] [MainThread]: Command `dbt docs serve` failed at 18:12:44.908032 after 1.73 seconds
[0m18:12:44.917873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab233b9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1ff33130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab1ff334c0>]}
[0m18:12:44.924754 [debug] [MainThread]: Flushing usage events
[0m18:13:16.788088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc268ea2ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc267454370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc267454910>]}


============================== 18:13:16.793125 | 978cdebf-4b08-4ad9-a1d9-88a252460024 ==============================
[0m18:13:16.793125 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:13:16.794459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:13:17.130737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '978cdebf-4b08-4ad9-a1d9-88a252460024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26a733d00>]}
[0m18:13:17.320595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '978cdebf-4b08-4ad9-a1d9-88a252460024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc265b40eb0>]}
[0m18:45:17.363516 [error] [MainThread]: Encountered an error:

[0m18:45:17.367832 [error] [MainThread]: Traceback (most recent call last):
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.8/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m18:45:17.372175 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 1920.6792, "process_user_time": 4.671198, "process_kernel_time": 0.21401, "process_mem_max_rss": "94384", "process_in_blocks": "40", "process_out_blocks": "2960", "command_success": false}
[0m18:45:17.375205 [debug] [MainThread]: Command `dbt docs serve` failed at 18:45:17.374418 after 1920.68 seconds
[0m18:45:17.377383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc268ea2ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc265a1a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc265a1a220>]}
[0m18:45:17.379368 [debug] [MainThread]: Flushing usage events
[0m18:45:24.425993 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:45:37.046204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bbfedac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ba59e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ba59eac0>]}


============================== 18:45:37.051630 | fff246c9-2614-4264-8e2f-1c1059dc4b74 ==============================
[0m18:45:37.051630 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:45:37.052971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'debug': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:45:37.399350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fff246c9-2614-4264-8e2f-1c1059dc4b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bb76d520>]}
[0m18:45:37.583661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fff246c9-2614-4264-8e2f-1c1059dc4b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ba5ac820>]}
[0m18:45:37.585268 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m18:45:37.604661 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m18:45:37.673743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:37.675182 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/trajectory_summary.sql
[0m18:45:37.960042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fff246c9-2614-4264-8e2f-1c1059dc4b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b80bd790>]}
[0m18:45:37.976886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fff246c9-2614-4264-8e2f-1c1059dc4b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b8aaad30>]}
[0m18:45:37.978252 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:45:37.979338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fff246c9-2614-4264-8e2f-1c1059dc4b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b8aaaf10>]}
[0m18:45:37.983246 [info ] [MainThread]: 
[0m18:45:37.985412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:45:37.988713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m18:45:38.022378 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m18:45:38.024417 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m18:45:38.026560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:38.052847 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:45:38.057018 [debug] [ThreadPool]: On list_traffic: Close
[0m18:45:38.062208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m18:45:38.076886 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:45:38.077951 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m18:45:38.078891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:45:38.119103 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:45:38.120237 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:45:38.121232 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m18:45:38.129959 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m18:45:38.132993 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m18:45:38.134443 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m18:45:38.147900 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:38.149003 [debug] [MainThread]: On master: BEGIN
[0m18:45:38.149924 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:38.173191 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:45:38.174614 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:38.176782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:45:38.187340 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m18:45:38.190999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fff246c9-2614-4264-8e2f-1c1059dc4b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b8aaaee0>]}
[0m18:45:38.192601 [debug] [MainThread]: On master: ROLLBACK
[0m18:45:38.194225 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:38.195435 [debug] [MainThread]: On master: BEGIN
[0m18:45:38.197290 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:45:38.198624 [debug] [MainThread]: On master: COMMIT
[0m18:45:38.199804 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:38.200943 [debug] [MainThread]: On master: COMMIT
[0m18:45:38.202424 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:45:38.203500 [debug] [MainThread]: On master: Close
[0m18:45:38.205299 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m18:45:38.206541 [info ] [MainThread]: 
[0m18:45:38.211501 [debug] [Thread-1  ]: Began running node model.traffic_data.my_first_dbt_model
[0m18:45:38.213649 [debug] [Thread-2  ]: Began running node model.traffic_data.trajectory_summary
[0m18:45:38.216160 [info ] [Thread-1  ]: 1 of 3 START sql table model traffic_schema.my_first_dbt_model ................. [RUN]
[0m18:45:38.218677 [info ] [Thread-2  ]: 2 of 3 START sql table model traffic_schema.trajectory_summary ................. [RUN]
[0m18:45:38.221509 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.my_first_dbt_model)
[0m18:45:38.224427 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.trajectory_summary'
[0m18:45:38.226564 [debug] [Thread-1  ]: Began compiling node model.traffic_data.my_first_dbt_model
[0m18:45:38.229686 [debug] [Thread-2  ]: Began compiling node model.traffic_data.trajectory_summary
[0m18:45:38.262851 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.my_first_dbt_model"
[0m18:45:38.264579 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m18:45:38.267341 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (compile): 18:45:38.232110 => 18:45:38.266336
[0m18:45:38.269063 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (compile): 18:45:38.242440 => 18:45:38.268230
[0m18:45:38.270569 [debug] [Thread-1  ]: Began executing node model.traffic_data.my_first_dbt_model
[0m18:45:38.273296 [debug] [Thread-2  ]: Began executing node model.traffic_data.trajectory_summary
[0m18:45:38.490559 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.my_first_dbt_model"
[0m18:45:38.488780 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m18:45:38.493092 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:45:38.494628 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:45:38.496143 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m18:45:38.498029 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: BEGIN
[0m18:45:38.499749 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:45:38.501283 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:45:38.523456 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m18:45:38.524885 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:45:38.526134 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:45:38.527767 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:45:38.529362 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  
    

  create  table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
  
  
    as
  
  (
    

WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
  
[0m18:45:38.531209 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */

  
    

  create  table "traffic"."traffic_schema"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:45:38.554865 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
[0m18:45:38.571006 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:45:38.573358 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
alter table "traffic"."traffic_schema"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:45:38.600338 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:45:38.607661 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:45:38.609402 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
alter table "traffic"."traffic_schema"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:45:38.611785 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:45:38.661862 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: COMMIT
[0m18:45:38.663437 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:45:38.664721 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: COMMIT
[0m18:45:38.726650 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:45:38.743243 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."my_first_dbt_model__dbt_backup"
[0m18:45:38.753289 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.my_first_dbt_model"
[0m18:45:38.754489 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_first_dbt_model"} */
drop table if exists "traffic"."traffic_schema"."my_first_dbt_model__dbt_backup" cascade
[0m18:45:38.816094 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m18:45:38.820980 [debug] [Thread-1  ]: Timing info for model.traffic_data.my_first_dbt_model (execute): 18:45:38.275011 => 18:45:38.820069
[0m18:45:38.822659 [debug] [Thread-1  ]: On model.traffic_data.my_first_dbt_model: Close
[0m18:45:38.825577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff246c9-2614-4264-8e2f-1c1059dc4b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ab7ebcd0>]}
[0m18:45:38.827972 [info ] [Thread-1  ]: 1 of 3 OK created sql table model traffic_schema.my_first_dbt_model ............ [[32mSELECT 2[0m in 0.60s]
[0m18:45:38.829752 [debug] [Thread-1  ]: Finished running node model.traffic_data.my_first_dbt_model
[0m18:45:38.831683 [debug] [Thread-3  ]: Began running node model.traffic_data.my_second_dbt_model
[0m18:45:38.833108 [info ] [Thread-3  ]: 3 of 3 START sql view model traffic_schema.my_second_dbt_model ................. [RUN]
[0m18:45:38.835913 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.my_second_dbt_model'
[0m18:45:38.837254 [debug] [Thread-3  ]: Began compiling node model.traffic_data.my_second_dbt_model
[0m18:45:38.845655 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.my_second_dbt_model"
[0m18:45:38.849633 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (compile): 18:45:38.838142 => 18:45:38.848038
[0m18:45:38.852597 [debug] [Thread-3  ]: Began executing node model.traffic_data.my_second_dbt_model
[0m18:45:38.921676 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.my_second_dbt_model"
[0m18:45:38.925708 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:45:38.927104 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: BEGIN
[0m18:45:38.928380 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:45:38.946223 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m18:45:38.947741 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:45:38.949021 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */

  create view "traffic"."traffic_schema"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "traffic"."traffic_schema"."my_first_dbt_model"
where id = 1
  );
[0m18:45:38.951997 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:45:38.959233 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:45:38.960448 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */
alter table "traffic"."traffic_schema"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:45:38.962155 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:45:38.966347 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: COMMIT
[0m18:45:38.967589 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:45:38.968696 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: COMMIT
[0m18:45:39.060770 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m18:45:39.072107 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."my_second_dbt_model__dbt_backup"
[0m18:45:39.078476 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.my_second_dbt_model"
[0m18:45:39.079966 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.my_second_dbt_model"} */
drop view if exists "traffic"."traffic_schema"."my_second_dbt_model__dbt_backup" cascade
[0m18:45:39.081561 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:45:39.084884 [debug] [Thread-3  ]: Timing info for model.traffic_data.my_second_dbt_model (execute): 18:45:38.854521 => 18:45:39.084303
[0m18:45:39.085989 [debug] [Thread-3  ]: On model.traffic_data.my_second_dbt_model: Close
[0m18:45:39.087819 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff246c9-2614-4264-8e2f-1c1059dc4b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ab7f9640>]}
[0m18:45:39.089446 [info ] [Thread-3  ]: 3 of 3 OK created sql view model traffic_schema.my_second_dbt_model ............ [[32mCREATE VIEW[0m in 0.25s]
[0m18:45:39.091200 [debug] [Thread-3  ]: Finished running node model.traffic_data.my_second_dbt_model
[0m18:45:39.587944 [debug] [Thread-2  ]: SQL status: SELECT 607 in 1.0 seconds
[0m18:45:39.594513 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:45:39.595681 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m18:45:39.597629 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:45:39.604126 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:45:39.605233 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m18:45:39.607015 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:45:39.612191 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m18:45:39.613427 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:45:39.614491 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m18:45:39.638489 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m18:45:39.644626 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m18:45:39.647218 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m18:45:39.648336 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m18:45:39.660986 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:45:39.665770 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (execute): 18:45:38.286228 => 18:45:39.664924
[0m18:45:39.667242 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: Close
[0m18:45:39.669003 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fff246c9-2614-4264-8e2f-1c1059dc4b74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b8be7d90>]}
[0m18:45:39.670600 [info ] [Thread-2  ]: 2 of 3 OK created sql table model traffic_schema.trajectory_summary ............ [[32mSELECT 607[0m in 1.45s]
[0m18:45:39.673023 [debug] [Thread-2  ]: Finished running node model.traffic_data.trajectory_summary
[0m18:45:39.677306 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:39.679760 [debug] [MainThread]: On master: BEGIN
[0m18:45:39.681881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:45:39.707390 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:45:39.708673 [debug] [MainThread]: On master: COMMIT
[0m18:45:39.710890 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:39.713430 [debug] [MainThread]: On master: COMMIT
[0m18:45:39.715884 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:45:39.717312 [debug] [MainThread]: On master: Close
[0m18:45:39.719899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:39.721489 [debug] [MainThread]: Connection 'model.traffic_data.my_first_dbt_model' was properly closed.
[0m18:45:39.723159 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m18:45:39.724298 [debug] [MainThread]: Connection 'model.traffic_data.my_second_dbt_model' was properly closed.
[0m18:45:39.725566 [info ] [MainThread]: 
[0m18:45:39.727685 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m18:45:39.730838 [debug] [MainThread]: Command end result
[0m18:45:39.752438 [info ] [MainThread]: 
[0m18:45:39.754083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:45:39.755362 [info ] [MainThread]: 
[0m18:45:39.756535 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:45:39.758354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8353348, "process_user_time": 5.62913, "process_kernel_time": 0.195761, "process_mem_max_rss": "108772", "process_in_blocks": "552", "process_out_blocks": "2464"}
[0m18:45:39.761454 [debug] [MainThread]: Command `dbt run` succeeded at 18:45:39.760200 after 2.84 seconds
[0m18:45:39.763685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6bbfedac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ba5ac820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b89ab220>]}
[0m18:45:39.765760 [debug] [MainThread]: Flushing usage events
[0m20:33:20.038451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f176688ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1764e3f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1764e3f8b0>]}


============================== 20:33:20.076106 | 52d6061e-eb45-4d32-af82-0fd667566f60 ==============================
[0m20:33:20.076106 [info ] [MainThread]: Running with dbt=1.7.13
[0m20:33:20.078780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:33:20.081017 [info ] [MainThread]: dbt version: 1.7.13
[0m20:33:20.082997 [info ] [MainThread]: python version: 3.8.10
[0m20:33:20.085080 [info ] [MainThread]: python path: /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/bin/python3
[0m20:33:20.086760 [info ] [MainThread]: os info: Linux-5.15.0-105-generic-x86_64-with-glibc2.29
[0m20:33:20.274440 [info ] [MainThread]: Using profiles dir at /home/yohanes/.dbt
[0m20:33:20.275583 [info ] [MainThread]: Using profiles.yml file at /home/yohanes/.dbt/profiles.yml
[0m20:33:20.276567 [info ] [MainThread]: Using dbt_project.yml file at /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/dbt_project.yml
[0m20:33:20.277811 [info ] [MainThread]: adapter type: postgres
[0m20:33:20.278790 [info ] [MainThread]: adapter version: 1.7.13
[0m20:33:20.437455 [info ] [MainThread]: Configuration:
[0m20:33:20.438588 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:33:20.439618 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:33:20.440580 [info ] [MainThread]: Required dependencies:
[0m20:33:20.441574 [debug] [MainThread]: Executing "git --help"
[0m20:33:20.453289 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:33:20.455723 [debug] [MainThread]: STDERR: "b''"
[0m20:33:20.457740 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:33:20.459411 [info ] [MainThread]: Connection:
[0m20:33:20.461235 [info ] [MainThread]:   host: localhost
[0m20:33:20.463435 [info ] [MainThread]:   port: 5432
[0m20:33:20.465633 [info ] [MainThread]:   user: postgres
[0m20:33:20.468748 [info ] [MainThread]:   database: traffic
[0m20:33:20.471138 [info ] [MainThread]:   schema: traffic_schema
[0m20:33:20.473109 [info ] [MainThread]:   connect_timeout: 10
[0m20:33:20.474651 [info ] [MainThread]:   role: None
[0m20:33:20.476086 [info ] [MainThread]:   search_path: None
[0m20:33:20.477613 [info ] [MainThread]:   keepalives_idle: 0
[0m20:33:20.479871 [info ] [MainThread]:   sslmode: None
[0m20:33:20.481126 [info ] [MainThread]:   sslcert: None
[0m20:33:20.482619 [info ] [MainThread]:   sslkey: None
[0m20:33:20.484232 [info ] [MainThread]:   sslrootcert: None
[0m20:33:20.485526 [info ] [MainThread]:   application_name: dbt
[0m20:33:20.486533 [info ] [MainThread]:   retries: 1
[0m20:33:20.488097 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m20:33:20.491109 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:33:20.492624 [debug] [MainThread]: Using postgres connection "debug"
[0m20:33:20.495017 [debug] [MainThread]: On debug: select 1 as id
[0m20:33:20.497176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:20.527734 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:33:20.532044 [debug] [MainThread]: On debug: Close
[0m20:33:20.533864 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:33:20.535756 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:33:20.539870 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.59494996, "process_user_time": 4.425783, "process_kernel_time": 0.131933, "process_mem_max_rss": "95632", "process_in_blocks": "16", "process_out_blocks": "24"}
[0m20:33:20.542193 [debug] [MainThread]: Command `dbt debug` succeeded at 20:33:20.541462 after 0.60 seconds
[0m20:33:20.543686 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:33:20.546758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f176688ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17680ffca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17635417c0>]}
[0m20:33:20.548513 [debug] [MainThread]: Flushing usage events
[0m20:33:32.335918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960360fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9601bc13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9601bc1af0>]}


============================== 20:33:32.343280 | 01c3585e-6073-4242-970f-fd1bd4432860 ==============================
[0m20:33:32.343280 [info ] [MainThread]: Running with dbt=1.7.13
[0m20:33:32.345722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:33:33.899235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01c3585e-6073-4242-970f-fd1bd4432860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9601bc13a0>]}
[0m20:33:34.111432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01c3585e-6073-4242-970f-fd1bd4432860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9601b54550>]}
[0m20:33:34.114079 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m20:33:34.202239 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m20:33:36.008888 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 1 files changed.
[0m20:33:36.010229 [debug] [MainThread]: Partial parsing: added file: traffic_data://models/vehicle_type.sql
[0m20:33:36.011415 [debug] [MainThread]: Partial parsing: deleted file: traffic_data://models/example/my_second_dbt_model.sql
[0m20:33:36.012349 [debug] [MainThread]: Partial parsing: deleted file: traffic_data://models/example/my_first_dbt_model.sql
[0m20:33:36.013457 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/trajectory_summary.sql
[0m20:33:36.317462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m20:33:36.328129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01c3585e-6073-4242-970f-fd1bd4432860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95ff6e0610>]}
[0m20:33:36.394903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01c3585e-6073-4242-970f-fd1bd4432860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96000c9c10>]}
[0m20:33:36.396192 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:33:36.397215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01c3585e-6073-4242-970f-fd1bd4432860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96000c9d90>]}
[0m20:33:36.400290 [info ] [MainThread]: 
[0m20:33:36.403401 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:33:36.407070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m20:33:36.437164 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m20:33:36.439882 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m20:33:36.441603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:36.495737 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:33:36.500408 [debug] [ThreadPool]: On list_traffic: Close
[0m20:33:36.505742 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic_traffic_schema'
[0m20:33:36.518190 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:33:36.519249 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m20:33:36.520208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:36.616505 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:33:36.618378 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:33:36.619854 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m20:33:36.800231 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:33:36.805010 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m20:33:36.807143 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m20:33:36.820508 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:36.821883 [debug] [MainThread]: On master: BEGIN
[0m20:33:36.823184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:36.844369 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:33:36.845592 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:36.846810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:33:37.097561 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:33:37.103167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01c3585e-6073-4242-970f-fd1bd4432860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95ff6e09a0>]}
[0m20:33:37.105414 [debug] [MainThread]: On master: ROLLBACK
[0m20:33:37.107449 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:37.108502 [debug] [MainThread]: On master: BEGIN
[0m20:33:37.110046 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:33:37.111139 [debug] [MainThread]: On master: COMMIT
[0m20:33:37.112197 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:37.113229 [debug] [MainThread]: On master: COMMIT
[0m20:33:37.114439 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:33:37.115565 [debug] [MainThread]: On master: Close
[0m20:33:37.117293 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:33:37.118609 [info ] [MainThread]: 
[0m20:33:37.147610 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m20:33:37.149753 [info ] [Thread-1  ]: 1 of 2 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m20:33:37.152582 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m20:33:37.154763 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m20:33:37.158445 [info ] [Thread-2  ]: 2 of 2 START sql view model traffic_schema.vehicle_type ........................ [RUN]
[0m20:33:37.162158 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m20:33:37.165186 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_traffic, now model.traffic_data.vehicle_type)
[0m20:33:37.178263 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m20:33:37.196327 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m20:33:37.198861 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m20:33:37.202227 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 20:33:37.184516 => 20:33:37.201225
[0m20:33:37.203695 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m20:33:37.221051 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 20:33:37.166972 => 20:33:37.220274
[0m20:33:37.232932 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m20:33:37.363810 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m20:33:37.363286 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m20:33:37.366861 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:33:37.368322 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:33:37.369687 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m20:33:37.371055 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m20:33:37.372454 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:33:37.374079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:37.397510 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:33:37.399658 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:33:37.401529 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:33:37.403378 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  create view "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
    
    
  as (
    ({config(materialized='table')})

WITH vehicle_summary AS (
    SELECT
    type AS 'Vehicle type',
    COUNT(type) AS 'Vehicle count',
    ROUND(AVG(traveled_d), 2) AS 'Average traveled distance',
    ROND(AVG(avg_speed), 2) AS 'Avergae speed by vehicle'
    FROM Vehicle
    GROUP BY type 
    ORDER BY 'Vehicle count' ASC
)

SELECT * FROM vehicle_summary
  );
[0m20:33:37.404847 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:33:37.406649 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m20:33:37.437432 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 7:     ({config(materialized='table')})
             ^

[0m20:33:37.439976 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: ROLLBACK
[0m20:33:37.443256 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 20:33:37.204582 => 20:33:37.442041
[0m20:33:37.445559 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m20:33:37.701640 [debug] [Thread-2  ]: Database Error in model vehicle_type (models/vehicle_type.sql)
  syntax error at or near "{"
  LINE 7:     ({config(materialized='table')})
               ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:33:37.703004 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c3585e-6073-4242-970f-fd1bd4432860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95ff6807f0>]}
[0m20:33:37.704506 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model traffic_schema.vehicle_type ............... [[31mERROR[0m in 0.54s]
[0m20:33:37.706284 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m20:33:37.934160 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 1.0 seconds
[0m20:33:37.950965 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:33:37.952121 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m20:33:37.954514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:37.965462 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:33:37.966642 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m20:33:37.968697 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:38.001995 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:33:38.003192 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:33:38.004201 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:33:38.071203 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:33:38.087635 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m20:33:38.096913 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:33:38.098068 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop table if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m20:33:38.538212 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m20:33:38.544434 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 20:33:37.239429 => 20:33:38.543266
[0m20:33:38.546393 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m20:33:38.548544 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c3585e-6073-4242-970f-fd1bd4432860', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fc594b50>]}
[0m20:33:38.550277 [info ] [Thread-1  ]: 1 of 2 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 1.39s]
[0m20:33:38.552125 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m20:33:38.556206 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:38.558084 [debug] [MainThread]: On master: BEGIN
[0m20:33:38.559742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:38.580729 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:33:38.583121 [debug] [MainThread]: On master: COMMIT
[0m20:33:38.585476 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:38.588613 [debug] [MainThread]: On master: COMMIT
[0m20:33:38.591509 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:33:38.593587 [debug] [MainThread]: On master: Close
[0m20:33:38.597541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:38.600074 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m20:33:38.603297 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m20:33:38.605831 [info ] [MainThread]: 
[0m20:33:38.608222 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m20:33:38.612602 [debug] [MainThread]: Command end result
[0m20:33:38.640415 [info ] [MainThread]: 
[0m20:33:38.642315 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:33:38.644349 [info ] [MainThread]: 
[0m20:33:38.646349 [error] [MainThread]:   Database Error in model vehicle_type (models/vehicle_type.sql)
  syntax error at or near "{"
  LINE 7:     ({config(materialized='table')})
               ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:33:38.652686 [info ] [MainThread]: 
[0m20:33:38.655288 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:33:38.659601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.4462934, "process_user_time": 6.16992, "process_kernel_time": 0.286417, "process_mem_max_rss": "107884", "process_in_blocks": "3408", "process_out_blocks": "2360", "command_success": false}
[0m20:33:38.662235 [debug] [MainThread]: Command `dbt run` failed at 20:33:38.661642 after 6.45 seconds
[0m20:33:38.664253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960360fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9600189100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fc523d60>]}
[0m20:33:38.666075 [debug] [MainThread]: Flushing usage events
[0m20:33:55.771781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e01751a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dffd00130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dffd005e0>]}


============================== 20:33:55.777294 | bfa9b076-ff3e-4b3a-9c6d-39e7e5a6dd9f ==============================
[0m20:33:55.777294 [info ] [MainThread]: Running with dbt=1.7.13
[0m20:33:55.778875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:33:56.196866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfa9b076-ff3e-4b3a-9c6d-39e7e5a6dd9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e02fc5ca0>]}
[0m20:33:56.538388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfa9b076-ff3e-4b3a-9c6d-39e7e5a6dd9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfe37bb80>]}
[0m20:33:56.541460 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m20:33:56.569695 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m20:33:56.639065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:33:56.640417 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_type.sql
[0m20:33:56.896501 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m20:33:56.909187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfa9b076-ff3e-4b3a-9c6d-39e7e5a6dd9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfd9b8550>]}
[0m20:33:56.933690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfa9b076-ff3e-4b3a-9c6d-39e7e5a6dd9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfe208850>]}
[0m20:33:56.937179 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:33:56.938887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa9b076-ff3e-4b3a-9c6d-39e7e5a6dd9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfe35e8b0>]}
[0m20:33:56.941689 [info ] [MainThread]: 
[0m20:33:56.943626 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:33:56.946379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m20:33:56.981573 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m20:33:56.984342 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m20:33:56.986131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:57.086437 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:33:57.091187 [debug] [ThreadPool]: On list_traffic: Close
[0m20:33:57.095698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m20:33:57.108692 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:33:57.109950 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m20:33:57.111054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:57.132445 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:33:57.133546 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:33:57.134528 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m20:33:57.141773 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:33:57.145465 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m20:33:57.147108 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m20:33:57.161433 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:57.162486 [debug] [MainThread]: On master: BEGIN
[0m20:33:57.163588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:57.184218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:33:57.185294 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:57.186346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:33:57.196696 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:33:57.201731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfa9b076-ff3e-4b3a-9c6d-39e7e5a6dd9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfda30a00>]}
[0m20:33:57.203415 [debug] [MainThread]: On master: ROLLBACK
[0m20:33:57.205200 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:57.206572 [debug] [MainThread]: On master: BEGIN
[0m20:33:57.208372 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:33:57.209301 [debug] [MainThread]: On master: COMMIT
[0m20:33:57.210219 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:57.211133 [debug] [MainThread]: On master: COMMIT
[0m20:33:57.212265 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:33:57.213191 [debug] [MainThread]: On master: Close
[0m20:33:57.215344 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:33:57.217118 [info ] [MainThread]: 
[0m20:33:57.223311 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m20:33:57.225444 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m20:33:57.227668 [info ] [Thread-1  ]: 1 of 2 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m20:33:57.230496 [info ] [Thread-2  ]: 2 of 2 START sql view model traffic_schema.vehicle_type ........................ [RUN]
[0m20:33:57.232964 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m20:33:57.238377 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m20:33:57.240292 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m20:33:57.241566 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m20:33:57.261728 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m20:33:57.268160 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m20:33:57.271641 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 20:33:57.252831 => 20:33:57.270239
[0m20:33:57.273582 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m20:33:57.286360 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 20:33:57.242380 => 20:33:57.284948
[0m20:33:57.293612 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m20:33:57.450783 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m20:33:57.446791 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m20:33:57.454219 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:33:57.456439 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m20:33:57.458510 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:33:57.460412 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:33:57.462209 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m20:33:57.463926 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:57.483724 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:33:57.484917 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:33:57.486959 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  create view "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
    
    
  as (
    ({ config(materialized='table')})

WITH vehicle_summary AS (
    SELECT
    type AS 'Vehicle type',
    COUNT(type) AS 'Vehicle count',
    ROUND(AVG(traveled_d), 2) AS 'Average traveled distance',
    ROND(AVG(avg_speed), 2) AS 'Avergae speed by vehicle'
    FROM Vehicle
    GROUP BY type 
    ORDER BY 'Vehicle count' ASC
)

SELECT * FROM vehicle_summary
  );
[0m20:33:57.489070 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 7:     ({ config(materialized='table')})
             ^

[0m20:33:57.490653 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:33:57.492203 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: ROLLBACK
[0m20:33:57.493899 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:33:57.495851 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m20:33:57.498626 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 20:33:57.274599 => 20:33:57.497726
[0m20:33:57.500609 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m20:33:57.503971 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:33:57.519845 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:33:57.521056 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m20:33:57.523908 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:57.531024 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:33:57.532305 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m20:33:57.534217 [debug] [Thread-2  ]: Database Error in model vehicle_type (models/vehicle_type.sql)
  syntax error at or near "{"
  LINE 7:     ({ config(materialized='table')})
               ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:33:57.536166 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa9b076-ff3e-4b3a-9c6d-39e7e5a6dd9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfc143580>]}
[0m20:33:57.537887 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:33:57.539633 [error] [Thread-2  ]: 2 of 2 ERROR creating sql view model traffic_schema.vehicle_type ............... [[31mERROR[0m in 0.30s]
[0m20:33:57.553273 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m20:33:57.590386 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:33:57.591744 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:33:57.593321 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:33:57.617304 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:33:57.633820 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m20:33:57.643209 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:33:57.644361 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m20:33:57.684215 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m20:33:57.689977 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 20:33:57.305097 => 20:33:57.688919
[0m20:33:57.692015 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m20:33:57.695508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfa9b076-ff3e-4b3a-9c6d-39e7e5a6dd9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfe337730>]}
[0m20:33:57.698294 [info ] [Thread-1  ]: 1 of 2 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.46s]
[0m20:33:57.701346 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m20:33:57.705514 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:57.707428 [debug] [MainThread]: On master: BEGIN
[0m20:33:57.708556 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:57.732075 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:33:57.733268 [debug] [MainThread]: On master: COMMIT
[0m20:33:57.735110 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:57.737121 [debug] [MainThread]: On master: COMMIT
[0m20:33:57.739438 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:33:57.741419 [debug] [MainThread]: On master: Close
[0m20:33:57.745094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:57.746834 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m20:33:57.747843 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m20:33:57.748813 [info ] [MainThread]: 
[0m20:33:57.749808 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m20:33:57.753417 [debug] [MainThread]: Command end result
[0m20:33:57.775018 [info ] [MainThread]: 
[0m20:33:57.776791 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:33:57.778014 [info ] [MainThread]: 
[0m20:33:57.779745 [error] [MainThread]:   Database Error in model vehicle_type (models/vehicle_type.sql)
  syntax error at or near "{"
  LINE 7:     ({ config(materialized='table')})
               ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:33:57.780969 [info ] [MainThread]: 
[0m20:33:57.782188 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:33:57.784732 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.113824, "process_user_time": 6.490134, "process_kernel_time": 0.247776, "process_mem_max_rss": "107672", "process_in_blocks": "32", "process_out_blocks": "2368", "command_success": false}
[0m20:33:57.787481 [debug] [MainThread]: Command `dbt run` failed at 20:33:57.786775 after 2.12 seconds
[0m20:33:57.789634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e01751a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfe35e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dfe369a60>]}
[0m20:33:57.791699 [debug] [MainThread]: Flushing usage events
[0m20:34:21.535121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd7a5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbbd5d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbbd5db50>]}


============================== 20:34:21.544408 | 9dc05554-167a-498f-b2b6-0d5f6c73d206 ==============================
[0m20:34:21.544408 [info ] [MainThread]: Running with dbt=1.7.13
[0m20:34:21.547741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:34:22.120076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dc05554-167a-498f-b2b6-0d5f6c73d206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbf018d90>]}
[0m20:34:22.336142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dc05554-167a-498f-b2b6-0d5f6c73d206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbdee8d90>]}
[0m20:34:22.337795 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m20:34:22.360191 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m20:34:22.464573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:34:22.467157 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_type.sql
[0m20:34:22.923131 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m20:34:22.943745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dc05554-167a-498f-b2b6-0d5f6c73d206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb9a0b640>]}
[0m20:34:23.003967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dc05554-167a-498f-b2b6-0d5f6c73d206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fba25c280>]}
[0m20:34:23.006343 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:34:23.009390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc05554-167a-498f-b2b6-0d5f6c73d206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fba3a4280>]}
[0m20:34:23.016706 [info ] [MainThread]: 
[0m20:34:23.020922 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:34:23.036840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m20:34:23.083629 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m20:34:23.086495 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m20:34:23.089238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:23.132085 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:34:23.138755 [debug] [ThreadPool]: On list_traffic: Close
[0m20:34:23.146798 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic_traffic_schema'
[0m20:34:23.166536 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:34:23.170458 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m20:34:23.173000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:34:23.202261 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:34:23.203824 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:34:23.205082 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m20:34:23.211220 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:34:23.216062 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m20:34:23.218042 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m20:34:23.232600 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:23.233798 [debug] [MainThread]: On master: BEGIN
[0m20:34:23.234824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:34:23.258634 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:34:23.259841 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:23.261004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:34:23.272854 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:34:23.277014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc05554-167a-498f-b2b6-0d5f6c73d206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb9a82f40>]}
[0m20:34:23.278537 [debug] [MainThread]: On master: ROLLBACK
[0m20:34:23.281138 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:23.283099 [debug] [MainThread]: On master: BEGIN
[0m20:34:23.285297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:34:23.286487 [debug] [MainThread]: On master: COMMIT
[0m20:34:23.287608 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:23.288640 [debug] [MainThread]: On master: COMMIT
[0m20:34:23.290022 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:34:23.291255 [debug] [MainThread]: On master: Close
[0m20:34:23.293050 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:34:23.294249 [info ] [MainThread]: 
[0m20:34:23.302850 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m20:34:23.305071 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m20:34:23.307079 [info ] [Thread-1  ]: 1 of 2 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m20:34:23.309441 [info ] [Thread-2  ]: 2 of 2 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m20:34:23.311783 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m20:34:23.314953 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_traffic, now model.traffic_data.vehicle_type)
[0m20:34:23.318930 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m20:34:23.321033 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m20:34:23.342321 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m20:34:23.354969 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m20:34:23.358191 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 20:34:23.322607 => 20:34:23.356652
[0m20:34:23.360322 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m20:34:23.361853 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 20:34:23.333553 => 20:34:23.361217
[0m20:34:23.375033 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m20:34:23.575899 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m20:34:23.585728 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m20:34:23.587896 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:34:23.589684 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m20:34:23.591426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:34:23.593684 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:34:23.595378 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m20:34:23.596900 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:34:23.617897 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:34:23.619875 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:34:23.622147 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m20:34:23.623712 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:34:23.625407 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:34:23.627808 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    type AS 'Vehicle type',
    COUNT(type) AS 'Vehicle count',
    ROUND(AVG(traveled_d), 2) AS 'Average traveled distance',
    ROND(AVG(avg_speed), 2) AS 'Avergae speed by vehicle'
    FROM Vehicle
    GROUP BY type 
    ORDER BY 'Vehicle count' ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m20:34:23.629651 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:34:23.637024 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "'Vehicle type'"
LINE 16:     type AS 'Vehicle type',
                     ^

[0m20:34:23.643720 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: ROLLBACK
[0m20:34:23.652462 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:34:23.654934 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 20:34:23.385484 => 20:34:23.653879
[0m20:34:23.656284 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m20:34:23.657586 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m20:34:23.660550 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:34:23.672265 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:34:23.673598 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m20:34:23.675819 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:34:23.717240 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:34:23.719224 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:34:23.720481 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:34:23.722869 [debug] [Thread-2  ]: Database Error in model vehicle_type (models/vehicle_type.sql)
  syntax error at or near "'Vehicle type'"
  LINE 16:     type AS 'Vehicle type',
                       ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:34:23.724290 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc05554-167a-498f-b2b6-0d5f6c73d206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb8139b50>]}
[0m20:34:23.726800 [error] [Thread-2  ]: 2 of 2 ERROR creating sql table model traffic_schema.vehicle_type .............. [[31mERROR[0m in 0.41s]
[0m20:34:23.728726 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m20:34:23.741258 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:34:23.765680 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m20:34:23.782211 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:34:23.785988 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m20:34:23.797204 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m20:34:23.803268 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 20:34:23.362500 => 20:34:23.802340
[0m20:34:23.805183 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m20:34:23.807506 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc05554-167a-498f-b2b6-0d5f6c73d206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fb8181850>]}
[0m20:34:23.809103 [info ] [Thread-1  ]: 1 of 2 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.50s]
[0m20:34:23.810764 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m20:34:23.813481 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:23.814676 [debug] [MainThread]: On master: BEGIN
[0m20:34:23.818107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:34:23.843641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:34:23.845108 [debug] [MainThread]: On master: COMMIT
[0m20:34:23.846561 [debug] [MainThread]: Using postgres connection "master"
[0m20:34:23.847729 [debug] [MainThread]: On master: COMMIT
[0m20:34:23.849145 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:34:23.852653 [debug] [MainThread]: On master: Close
[0m20:34:23.856288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:23.858342 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m20:34:23.859832 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m20:34:23.861222 [info ] [MainThread]: 
[0m20:34:23.863138 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m20:34:23.865903 [debug] [MainThread]: Command end result
[0m20:34:23.893342 [info ] [MainThread]: 
[0m20:34:23.894872 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:34:23.896290 [info ] [MainThread]: 
[0m20:34:23.897425 [error] [MainThread]:   Database Error in model vehicle_type (models/vehicle_type.sql)
  syntax error at or near "'Vehicle type'"
  LINE 16:     type AS 'Vehicle type',
                       ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:34:23.898767 [info ] [MainThread]: 
[0m20:34:23.901972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:34:23.905580 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.526069, "process_user_time": 6.519458, "process_kernel_time": 0.222074, "process_mem_max_rss": "107852", "process_out_blocks": "2368", "command_success": false, "process_in_blocks": "0"}
[0m20:34:23.909325 [debug] [MainThread]: Command `dbt run` failed at 20:34:23.908457 after 2.53 seconds
[0m20:34:23.911852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbd7a5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fbdee8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fba4cf790>]}
[0m20:34:23.912984 [debug] [MainThread]: Flushing usage events
[0m20:35:16.109138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95907a1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958ed59430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958ed59b50>]}


============================== 20:35:16.115446 | d726c45f-c05c-4e09-9c93-0fa3ca37f319 ==============================
[0m20:35:16.115446 [info ] [MainThread]: Running with dbt=1.7.13
[0m20:35:16.116919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:35:16.485739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd726c45f-c05c-4e09-9c93-0fa3ca37f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9592013d90>]}
[0m20:35:16.685861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd726c45f-c05c-4e09-9c93-0fa3ca37f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9590ee4d90>]}
[0m20:35:16.687562 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m20:35:16.711844 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m20:35:16.783100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:35:16.784995 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_type.sql
[0m20:35:17.090276 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m20:35:17.102625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd726c45f-c05c-4e09-9c93-0fa3ca37f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958c806640>]}
[0m20:35:17.128363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd726c45f-c05c-4e09-9c93-0fa3ca37f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958d25a280>]}
[0m20:35:17.130233 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:35:17.132556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd726c45f-c05c-4e09-9c93-0fa3ca37f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958d39e280>]}
[0m20:35:17.138827 [info ] [MainThread]: 
[0m20:35:17.142461 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:17.145641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m20:35:17.191013 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m20:35:17.193219 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m20:35:17.194366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:17.225569 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:35:17.228429 [debug] [ThreadPool]: On list_traffic: Close
[0m20:35:17.232174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m20:35:17.246544 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:35:17.247758 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m20:35:17.248775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:17.276976 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:35:17.278370 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:35:17.279635 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m20:35:17.287721 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:35:17.291389 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m20:35:17.292929 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m20:35:17.307156 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:17.308382 [debug] [MainThread]: On master: BEGIN
[0m20:35:17.309423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:17.329661 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:35:17.330944 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:17.332201 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:17.342502 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:35:17.347101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd726c45f-c05c-4e09-9c93-0fa3ca37f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958d1fefa0>]}
[0m20:35:17.348742 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:17.351353 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:17.353159 [debug] [MainThread]: On master: BEGIN
[0m20:35:17.355424 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:35:17.356641 [debug] [MainThread]: On master: COMMIT
[0m20:35:17.357687 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:17.358747 [debug] [MainThread]: On master: COMMIT
[0m20:35:17.360009 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:35:17.361056 [debug] [MainThread]: On master: Close
[0m20:35:17.362788 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:35:17.364202 [info ] [MainThread]: 
[0m20:35:17.371256 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m20:35:17.373401 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m20:35:17.375515 [info ] [Thread-1  ]: 1 of 2 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m20:35:17.377886 [info ] [Thread-2  ]: 2 of 2 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m20:35:17.380814 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m20:35:17.385409 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m20:35:17.388463 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m20:35:17.391104 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m20:35:17.425655 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m20:35:17.430792 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m20:35:17.433764 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 20:35:17.392735 => 20:35:17.432371
[0m20:35:17.437899 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m20:35:17.441527 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 20:35:17.403395 => 20:35:17.439686
[0m20:35:17.453991 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m20:35:17.633596 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m20:35:17.648055 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m20:35:17.650849 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:35:17.653625 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:35:17.655081 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m20:35:17.656889 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m20:35:17.658562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:35:17.659764 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:35:17.681107 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:35:17.682574 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:35:17.684227 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:35:17.686808 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:35:17.689460 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m20:35:17.691528 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    type AS "Vehicle type",
    COUNT(type) AS "Vehicle count",
    ROUND(AVG(traveled_d), 2) AS "Average traveled distance",
    ROND(AVG(avg_speed), 2) AS "Avergae speed by vehicle"
    FROM Vehicle
    GROUP BY type 
    ORDER BY"'Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m20:35:17.694351 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "vehicle" does not exist
LINE 20:     FROM Vehicle
                  ^

[0m20:35:17.695836 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: ROLLBACK
[0m20:35:17.697816 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 20:35:17.460779 => 20:35:17.697135
[0m20:35:17.699150 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m20:35:17.705898 [debug] [Thread-2  ]: Database Error in model vehicle_type (models/vehicle_type.sql)
  relation "vehicle" does not exist
  LINE 20:     FROM Vehicle
                    ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:35:17.707616 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd726c45f-c05c-4e09-9c93-0fa3ca37f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958c73af10>]}
[0m20:35:17.709439 [error] [Thread-2  ]: 2 of 2 ERROR creating sql table model traffic_schema.vehicle_type .............. [[31mERROR[0m in 0.32s]
[0m20:35:17.711223 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m20:35:17.744888 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:35:17.775840 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:35:17.777438 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m20:35:17.779524 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:35:17.788914 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:35:17.790611 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m20:35:17.792591 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:35:17.829716 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:35:17.830914 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:35:17.831940 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:35:17.845630 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:35:17.864532 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m20:35:17.875715 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:35:17.876890 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m20:35:17.889776 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m20:35:17.895294 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 20:35:17.442621 => 20:35:17.894301
[0m20:35:17.897188 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m20:35:17.899679 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd726c45f-c05c-4e09-9c93-0fa3ca37f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958c7c5c40>]}
[0m20:35:17.901421 [info ] [Thread-1  ]: 1 of 2 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.52s]
[0m20:35:17.904054 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m20:35:17.908091 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:17.909953 [debug] [MainThread]: On master: BEGIN
[0m20:35:17.912774 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:17.939103 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:35:17.941585 [debug] [MainThread]: On master: COMMIT
[0m20:35:17.944017 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:17.945364 [debug] [MainThread]: On master: COMMIT
[0m20:35:17.946955 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:35:17.948015 [debug] [MainThread]: On master: Close
[0m20:35:17.949646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:17.950885 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m20:35:17.952248 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m20:35:17.954815 [info ] [MainThread]: 
[0m20:35:17.957382 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m20:35:17.959768 [debug] [MainThread]: Command end result
[0m20:35:17.977936 [info ] [MainThread]: 
[0m20:35:17.979816 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:35:17.981338 [info ] [MainThread]: 
[0m20:35:17.982961 [error] [MainThread]:   Database Error in model vehicle_type (models/vehicle_type.sql)
  relation "vehicle" does not exist
  LINE 20:     FROM Vehicle
                    ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:35:17.984737 [info ] [MainThread]: 
[0m20:35:17.987495 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:35:17.992151 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.985313, "process_user_time": 5.601715, "process_kernel_time": 0.21545, "process_mem_max_rss": "108116", "process_out_blocks": "2368", "command_success": false, "process_in_blocks": "0"}
[0m20:35:17.995206 [debug] [MainThread]: Command `dbt run` failed at 20:35:17.994261 after 1.99 seconds
[0m20:35:17.996820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95907a1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958d304160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958d25a220>]}
[0m20:35:17.998224 [debug] [MainThread]: Flushing usage events
[0m20:36:02.764618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4a2c4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a48872400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a48872b20>]}


============================== 20:36:02.769458 | 1d219750-b311-407e-b2e7-ad7a5bdccd0d ==============================
[0m20:36:02.769458 [info ] [MainThread]: Running with dbt=1.7.13
[0m20:36:02.770747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:36:03.089831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d219750-b311-407e-b2e7-ad7a5bdccd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4bb37d60>]}
[0m20:36:03.259288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d219750-b311-407e-b2e7-ad7a5bdccd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a470143d0>]}
[0m20:36:03.260857 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m20:36:03.282948 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m20:36:03.349486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:36:03.350889 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_type.sql
[0m20:36:03.633487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m20:36:03.648495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d219750-b311-407e-b2e7-ad7a5bdccd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46329610>]}
[0m20:36:03.670307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d219750-b311-407e-b2e7-ad7a5bdccd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46d7c0d0>]}
[0m20:36:03.671599 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:36:03.673112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d219750-b311-407e-b2e7-ad7a5bdccd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46fdadc0>]}
[0m20:36:03.678620 [info ] [MainThread]: 
[0m20:36:03.681734 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:36:03.684512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m20:36:03.716197 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m20:36:03.717538 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m20:36:03.718817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:04.151443 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:36:04.153961 [debug] [ThreadPool]: On list_traffic: Close
[0m20:36:04.157328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m20:36:04.168854 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:36:04.170010 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m20:36:04.171022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:04.192929 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:36:04.194202 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:36:04.195408 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m20:36:04.200726 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:36:04.204323 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m20:36:04.205920 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m20:36:04.216602 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:04.217842 [debug] [MainThread]: On master: BEGIN
[0m20:36:04.218941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:36:04.241562 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:36:04.242823 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:04.244010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:36:04.254248 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:36:04.257397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d219750-b311-407e-b2e7-ad7a5bdccd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a463297f0>]}
[0m20:36:04.258543 [debug] [MainThread]: On master: ROLLBACK
[0m20:36:04.259879 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:04.260848 [debug] [MainThread]: On master: BEGIN
[0m20:36:04.262267 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:36:04.263236 [debug] [MainThread]: On master: COMMIT
[0m20:36:04.264142 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:04.265031 [debug] [MainThread]: On master: COMMIT
[0m20:36:04.266185 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:36:04.267136 [debug] [MainThread]: On master: Close
[0m20:36:04.269249 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:36:04.271027 [info ] [MainThread]: 
[0m20:36:04.276288 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m20:36:04.278373 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m20:36:04.280504 [info ] [Thread-1  ]: 1 of 2 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m20:36:04.282884 [info ] [Thread-2  ]: 2 of 2 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m20:36:04.285266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m20:36:04.288547 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m20:36:04.290370 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m20:36:04.292931 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m20:36:04.318392 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m20:36:04.322488 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m20:36:04.324647 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 20:36:04.294816 => 20:36:04.323780
[0m20:36:04.326878 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m20:36:04.345841 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 20:36:04.305268 => 20:36:04.344631
[0m20:36:04.353429 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m20:36:04.475966 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m20:36:04.494762 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m20:36:04.496142 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:36:04.497262 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m20:36:04.498311 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:04.499927 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:36:04.501421 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m20:36:04.502676 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:36:04.515953 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:36:04.517125 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:36:04.518322 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m20:36:04.520222 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:36:04.521496 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:36:04.522667 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    type AS "Vehicle type",
    COUNT(type) AS "Vehicle count",
    ROUND(AVG(traveled_d), 2) AS "Average traveled distance",
    ROND(AVG(avg_speed), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY type 
    ORDER BY"'Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m20:36:04.524505 [debug] [Thread-2  ]: Postgres adapter: Postgres error: column "type" does not exist
LINE 16:     type AS "Vehicle type",
             ^

[0m20:36:04.525718 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: ROLLBACK
[0m20:36:04.527441 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 20:36:04.365187 => 20:36:04.526842
[0m20:36:04.528594 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m20:36:04.533005 [debug] [Thread-2  ]: Database Error in model vehicle_type (models/vehicle_type.sql)
  column "type" does not exist
  LINE 16:     type AS "Vehicle type",
               ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:36:04.534481 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d219750-b311-407e-b2e7-ad7a5bdccd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a44255d90>]}
[0m20:36:04.536113 [error] [Thread-2  ]: 2 of 2 ERROR creating sql table model traffic_schema.vehicle_type .............. [[31mERROR[0m in 0.25s]
[0m20:36:04.537824 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m20:36:04.870298 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:36:04.886709 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:36:04.888000 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m20:36:04.889867 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:36:04.896559 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:36:04.897785 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m20:36:04.899562 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:36:04.932957 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:36:04.934220 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:36:04.935369 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:36:04.961129 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:36:04.978756 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m20:36:04.988993 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:36:04.990270 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m20:36:05.131690 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m20:36:05.135043 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 20:36:04.328964 => 20:36:05.134451
[0m20:36:05.136231 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m20:36:05.138062 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d219750-b311-407e-b2e7-ad7a5bdccd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a45ae7c10>]}
[0m20:36:05.139786 [info ] [Thread-1  ]: 1 of 2 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.85s]
[0m20:36:05.141649 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m20:36:05.144435 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:05.145573 [debug] [MainThread]: On master: BEGIN
[0m20:36:05.147022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:36:05.167689 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:36:05.169616 [debug] [MainThread]: On master: COMMIT
[0m20:36:05.171926 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:05.173399 [debug] [MainThread]: On master: COMMIT
[0m20:36:05.174948 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:36:05.176035 [debug] [MainThread]: On master: Close
[0m20:36:05.178280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:05.181382 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m20:36:05.182948 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m20:36:05.184935 [info ] [MainThread]: 
[0m20:36:05.187085 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m20:36:05.189754 [debug] [MainThread]: Command end result
[0m20:36:05.206834 [info ] [MainThread]: 
[0m20:36:05.208580 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:36:05.210135 [info ] [MainThread]: 
[0m20:36:05.212827 [error] [MainThread]:   Database Error in model vehicle_type (models/vehicle_type.sql)
  column "type" does not exist
  LINE 16:     type AS "Vehicle type",
               ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:36:05.216352 [info ] [MainThread]: 
[0m20:36:05.218797 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:36:05.222867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5501516, "process_user_time": 5.169743, "process_kernel_time": 0.199758, "process_mem_max_rss": "107968", "process_in_blocks": "8", "process_out_blocks": "2368", "command_success": false}
[0m20:36:05.225354 [debug] [MainThread]: Command `dbt run` failed at 20:36:05.224778 after 2.55 seconds
[0m20:36:05.227780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a4a2c4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46e37130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a46f23880>]}
[0m20:36:05.231268 [debug] [MainThread]: Flushing usage events
[0m20:37:38.955055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f79c9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f5f7c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f5f7caf0>]}


============================== 20:37:38.960644 | 12426fb9-253f-4514-8cfa-2d56adf976dc ==============================
[0m20:37:38.960644 [info ] [MainThread]: Running with dbt=1.7.13
[0m20:37:38.962084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:37:39.796368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12426fb9-253f-4514-8cfa-2d56adf976dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f5f7c3a0>]}
[0m20:37:39.996959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12426fb9-253f-4514-8cfa-2d56adf976dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f5f0f4c0>]}
[0m20:37:39.999094 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m20:37:40.026694 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m20:37:40.094436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:37:40.096338 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_type.sql
[0m20:37:40.372935 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m20:37:40.384263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12426fb9-253f-4514-8cfa-2d56adf976dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f3a2c5e0>]}
[0m20:37:40.409516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12426fb9-253f-4514-8cfa-2d56adf976dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f4480880>]}
[0m20:37:40.411463 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:37:40.412627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12426fb9-253f-4514-8cfa-2d56adf976dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f465c130>]}
[0m20:37:40.415379 [info ] [MainThread]: 
[0m20:37:40.417310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:37:40.422554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m20:37:40.465053 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m20:37:40.466922 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m20:37:40.468067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:40.533950 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:37:40.538148 [debug] [ThreadPool]: On list_traffic: Close
[0m20:37:40.541656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m20:37:40.555265 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:37:40.557049 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m20:37:40.558138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:40.576928 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:37:40.577955 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:37:40.578907 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m20:37:40.585477 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:37:40.588898 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m20:37:40.590879 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m20:37:40.606527 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:40.608561 [debug] [MainThread]: On master: BEGIN
[0m20:37:40.609711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:37:40.630675 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:37:40.632445 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:40.634133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:37:40.645993 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:37:40.650578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12426fb9-253f-4514-8cfa-2d56adf976dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f3a2c820>]}
[0m20:37:40.652162 [debug] [MainThread]: On master: ROLLBACK
[0m20:37:40.653716 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:40.655582 [debug] [MainThread]: On master: BEGIN
[0m20:37:40.657055 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:37:40.658074 [debug] [MainThread]: On master: COMMIT
[0m20:37:40.659238 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:40.660415 [debug] [MainThread]: On master: COMMIT
[0m20:37:40.661803 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:37:40.663139 [debug] [MainThread]: On master: Close
[0m20:37:40.667043 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:37:40.669690 [info ] [MainThread]: 
[0m20:37:40.682133 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m20:37:40.683749 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m20:37:40.687392 [info ] [Thread-2  ]: 2 of 2 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m20:37:40.685423 [info ] [Thread-1  ]: 1 of 2 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m20:37:40.692541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m20:37:40.693926 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m20:37:40.690034 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m20:37:40.709595 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m20:37:40.710935 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m20:37:40.718129 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m20:37:40.721039 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 20:37:40.711875 => 20:37:40.719859
[0m20:37:40.723465 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 20:37:40.694657 => 20:37:40.722650
[0m20:37:40.724611 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m20:37:40.725991 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m20:37:40.914836 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m20:37:40.932457 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m20:37:40.934340 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:37:40.935843 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m20:37:40.937013 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:37:40.938233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:37:40.940067 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m20:37:40.941748 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:37:40.963403 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:37:40.964943 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:37:40.966137 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:37:40.967298 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m20:37:40.968471 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:37:40.969681 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(type) AS "Vehicle count",
    ROUND(AVG(traveled_d), 2) AS "Average traveled distance",
    ROND(AVG(avg_speed), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY"'Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m20:37:40.971888 [debug] [Thread-2  ]: Postgres adapter: Postgres error: column "type" does not exist
LINE 17:     COUNT(type) AS "Vehicle count",
                   ^

[0m20:37:40.973676 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: ROLLBACK
[0m20:37:40.975847 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 20:37:40.729676 => 20:37:40.974821
[0m20:37:40.977031 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m20:37:40.981488 [debug] [Thread-2  ]: Database Error in model vehicle_type (models/vehicle_type.sql)
  column "type" does not exist
  LINE 17:     COUNT(type) AS "Vehicle count",
                     ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:37:40.982808 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12426fb9-253f-4514-8cfa-2d56adf976dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f09bd970>]}
[0m20:37:40.984214 [error] [Thread-2  ]: 2 of 2 ERROR creating sql table model traffic_schema.vehicle_type .............. [[31mERROR[0m in 0.29s]
[0m20:37:40.985808 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m20:37:40.998911 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:37:41.021422 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:37:41.024123 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m20:37:41.028951 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:37:41.041890 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:37:41.044644 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m20:37:41.047132 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:37:41.090072 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:37:41.091708 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:37:41.092857 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:37:41.546034 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:37:41.561456 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m20:37:41.571459 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:37:41.572744 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m20:37:41.634931 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m20:37:41.641190 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 20:37:40.742621 => 20:37:41.640251
[0m20:37:41.643130 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m20:37:41.644973 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12426fb9-253f-4514-8cfa-2d56adf976dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f4425f70>]}
[0m20:37:41.646667 [info ] [Thread-1  ]: 1 of 2 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.95s]
[0m20:37:41.649179 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m20:37:41.652334 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:41.655237 [debug] [MainThread]: On master: BEGIN
[0m20:37:41.657113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:37:41.680192 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:37:41.681974 [debug] [MainThread]: On master: COMMIT
[0m20:37:41.683421 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:41.684540 [debug] [MainThread]: On master: COMMIT
[0m20:37:41.685880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:37:41.686878 [debug] [MainThread]: On master: Close
[0m20:37:41.688979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:41.690837 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m20:37:41.693921 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m20:37:41.695823 [info ] [MainThread]: 
[0m20:37:41.697778 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m20:37:41.701464 [debug] [MainThread]: Command end result
[0m20:37:41.720718 [info ] [MainThread]: 
[0m20:37:41.721938 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:37:41.722914 [info ] [MainThread]: 
[0m20:37:41.723912 [error] [MainThread]:   Database Error in model vehicle_type (models/vehicle_type.sql)
  column "type" does not exist
  LINE 17:     COUNT(type) AS "Vehicle count",
                     ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:37:41.725141 [info ] [MainThread]: 
[0m20:37:41.726231 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:37:41.727916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.87601, "process_user_time": 5.793547, "process_kernel_time": 0.23525, "process_mem_max_rss": "108140", "process_in_blocks": "2600", "process_out_blocks": "2368", "command_success": false}
[0m20:37:41.729247 [debug] [MainThread]: Command `dbt run` failed at 20:37:41.728889 after 2.88 seconds
[0m20:37:41.730247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f79c9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f46cca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f5f0f4c0>]}
[0m20:37:41.731266 [debug] [MainThread]: Flushing usage events
[0m20:38:05.560268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf717c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbdccf4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbdccfbb0>]}


============================== 20:38:05.637966 | 2d32aa68-e31b-4247-a523-a197040c63ef ==============================
[0m20:38:05.637966 [info ] [MainThread]: Running with dbt=1.7.13
[0m20:38:05.639548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'profiles_dir': '/home/yohanes/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:38:12.001022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d32aa68-e31b-4247-a523-a197040c63ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc0f8adc0>]}
[0m20:38:12.195255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d32aa68-e31b-4247-a523-a197040c63ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbc45a490>]}
[0m20:38:12.196881 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m20:38:12.223906 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m20:38:12.292694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:38:12.294127 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_type.sql
[0m20:38:12.554914 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m20:38:12.569341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d32aa68-e31b-4247-a523-a197040c63ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbb77f670>]}
[0m20:38:12.591482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d32aa68-e31b-4247-a523-a197040c63ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbc1d02b0>]}
[0m20:38:12.594852 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:38:12.597420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d32aa68-e31b-4247-a523-a197040c63ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbc3745b0>]}
[0m20:38:12.600464 [info ] [MainThread]: 
[0m20:38:12.604051 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:38:12.608777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m20:38:12.649639 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m20:38:12.651417 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m20:38:12.652825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:12.703618 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:38:12.706082 [debug] [ThreadPool]: On list_traffic: Close
[0m20:38:12.710817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic_traffic_schema'
[0m20:38:12.725458 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:38:12.726971 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m20:38:12.728079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:12.744721 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:38:12.745880 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:38:12.746934 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m20:38:12.752228 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:38:12.755026 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m20:38:12.756286 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m20:38:12.768409 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:12.769452 [debug] [MainThread]: On master: BEGIN
[0m20:38:12.770338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:38:12.789195 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:38:12.790599 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:12.792599 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:38:12.801255 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:38:12.805220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d32aa68-e31b-4247-a523-a197040c63ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbc364250>]}
[0m20:38:12.806641 [debug] [MainThread]: On master: ROLLBACK
[0m20:38:12.808193 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:12.809836 [debug] [MainThread]: On master: BEGIN
[0m20:38:12.811792 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:38:12.813100 [debug] [MainThread]: On master: COMMIT
[0m20:38:12.814251 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:12.815406 [debug] [MainThread]: On master: COMMIT
[0m20:38:12.816665 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:38:12.817706 [debug] [MainThread]: On master: Close
[0m20:38:12.819380 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:38:12.820655 [info ] [MainThread]: 
[0m20:38:12.824862 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m20:38:12.827016 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m20:38:12.828519 [info ] [Thread-1  ]: 1 of 2 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m20:38:12.830299 [info ] [Thread-2  ]: 2 of 2 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m20:38:12.832629 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m20:38:12.837426 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m20:38:12.835080 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_traffic, now model.traffic_data.vehicle_type)
[0m20:38:12.849741 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m20:38:12.864160 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m20:38:12.869252 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m20:38:12.871634 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 20:38:12.855772 => 20:38:12.870557
[0m20:38:12.873241 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 20:38:12.838291 => 20:38:12.872601
[0m20:38:12.874504 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m20:38:12.877541 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m20:38:13.025260 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m20:38:13.042627 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m20:38:13.044610 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:38:13.045803 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m20:38:13.046946 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:38:13.049017 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:38:13.050415 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m20:38:13.051689 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m20:38:13.064581 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:38:13.065816 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:38:13.066904 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m20:38:13.069115 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:38:13.070411 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:38:13.071621 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(traveled_d), 2) AS "Average traveled distance",
    ROND(AVG(avg_speed), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY"'Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m20:38:13.078239 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:38:13.090906 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:38:13.092118 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m20:38:13.094745 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:38:13.103677 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:38:13.105037 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m20:38:13.106946 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:38:13.141011 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:38:13.142287 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:38:13.143751 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:38:13.248492 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:38:13.264376 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m20:38:13.274466 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:38:13.275651 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m20:38:13.337977 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m20:38:13.343520 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 20:38:12.889683 => 20:38:13.342387
[0m20:38:13.345537 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m20:38:13.348000 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d32aa68-e31b-4247-a523-a197040c63ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbb77f910>]}
[0m20:38:13.349629 [info ] [Thread-1  ]: 1 of 2 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.52s]
[0m20:38:13.352281 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m20:38:13.359931 [debug] [Thread-2  ]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 18:     ROUND(AVG(traveled_d), 2) AS "Average traveled distance"...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:38:13.361476 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: ROLLBACK
[0m20:38:13.363592 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 20:38:12.879082 => 20:38:13.362895
[0m20:38:13.364945 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m20:38:13.370155 [debug] [Thread-2  ]: Database Error in model vehicle_type (models/vehicle_type.sql)
  function round(double precision, integer) does not exist
  LINE 18:     ROUND(AVG(traveled_d), 2) AS "Average traveled distance"...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:38:13.371677 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d32aa68-e31b-4247-a523-a197040c63ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb86a3850>]}
[0m20:38:13.373160 [error] [Thread-2  ]: 2 of 2 ERROR creating sql table model traffic_schema.vehicle_type .............. [[31mERROR[0m in 0.54s]
[0m20:38:13.374785 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m20:38:13.378062 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:13.379123 [debug] [MainThread]: On master: BEGIN
[0m20:38:13.380003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:38:13.396609 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:38:13.397796 [debug] [MainThread]: On master: COMMIT
[0m20:38:13.398754 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:13.399660 [debug] [MainThread]: On master: COMMIT
[0m20:38:13.400757 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:38:13.401668 [debug] [MainThread]: On master: Close
[0m20:38:13.403941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:13.405699 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m20:38:13.406776 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m20:38:13.407727 [info ] [MainThread]: 
[0m20:38:13.408743 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m20:38:13.411249 [debug] [MainThread]: Command end result
[0m20:38:13.426042 [info ] [MainThread]: 
[0m20:38:13.427418 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:38:13.429241 [info ] [MainThread]: 
[0m20:38:13.430909 [error] [MainThread]:   Database Error in model vehicle_type (models/vehicle_type.sql)
  function round(double precision, integer) does not exist
  LINE 18:     ROUND(AVG(traveled_d), 2) AS "Average traveled distance"...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:38:13.432360 [info ] [MainThread]: 
[0m20:38:13.433532 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:38:15.524276 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.006531, "process_user_time": 5.485686, "process_kernel_time": 0.200061, "process_mem_max_rss": "108064", "process_in_blocks": "1088", "process_out_blocks": "2368", "command_success": false}
[0m20:38:15.526779 [debug] [MainThread]: Command `dbt run` failed at 20:38:15.526074 after 11.01 seconds
[0m20:38:15.528624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf717c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbc45a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbc318760>]}
[0m20:38:15.529968 [debug] [MainThread]: Flushing usage events
[0m20:39:35.455885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a57ada60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a3d65340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a3d65520>]}


============================== 20:39:35.460917 | 8df95c8f-0958-4960-8713-3ab4bb3c9849 ==============================
[0m20:39:35.460917 [info ] [MainThread]: Running with dbt=1.7.13
[0m20:39:35.462420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:39:36.084471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8df95c8f-0958-4960-8713-3ab4bb3c9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a7021ca0>]}
[0m20:39:36.284428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8df95c8f-0958-4960-8713-3ab4bb3c9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a23d7b80>]}
[0m20:39:36.286076 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m20:39:36.310505 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m20:39:36.377696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:36.379186 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_type.sql
[0m20:39:36.667763 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m20:39:36.682019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8df95c8f-0958-4960-8713-3ab4bb3c9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a1813550>]}
[0m20:39:36.711756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8df95c8f-0958-4960-8713-3ab4bb3c9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a2267af0>]}
[0m20:39:36.714503 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:39:36.716542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8df95c8f-0958-4960-8713-3ab4bb3c9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a23bc8b0>]}
[0m20:39:36.721377 [info ] [MainThread]: 
[0m20:39:36.726114 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:39:36.730526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m20:39:36.757780 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m20:39:36.760080 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m20:39:36.762336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:36.786826 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:39:36.789430 [debug] [ThreadPool]: On list_traffic: Close
[0m20:39:36.797915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m20:39:36.812072 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:39:36.813225 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m20:39:36.814116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:36.836424 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.838611 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:39:36.840659 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m20:39:36.846813 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:39:36.849685 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m20:39:36.851165 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m20:39:36.869801 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:36.871815 [debug] [MainThread]: On master: BEGIN
[0m20:39:36.873613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:36.898559 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.899808 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:36.901030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:39:36.910412 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:39:36.914092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8df95c8f-0958-4960-8713-3ab4bb3c9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a23cba60>]}
[0m20:39:36.915651 [debug] [MainThread]: On master: ROLLBACK
[0m20:39:36.917385 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:36.918911 [debug] [MainThread]: On master: BEGIN
[0m20:39:36.920865 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:39:36.922329 [debug] [MainThread]: On master: COMMIT
[0m20:39:36.923649 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:36.924834 [debug] [MainThread]: On master: COMMIT
[0m20:39:36.926087 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:39:36.927222 [debug] [MainThread]: On master: Close
[0m20:39:36.929011 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:39:36.930430 [info ] [MainThread]: 
[0m20:39:36.934840 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m20:39:36.936525 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m20:39:36.938690 [info ] [Thread-1  ]: 1 of 2 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m20:39:36.940803 [info ] [Thread-2  ]: 2 of 2 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m20:39:36.943332 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m20:39:36.948154 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m20:39:36.945976 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m20:39:36.956757 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m20:39:36.977465 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m20:39:36.995063 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 20:39:36.949560 => 20:39:36.993655
[0m20:39:36.997938 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m20:39:36.990401 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m20:39:37.010440 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 20:39:36.964472 => 20:39:37.008022
[0m20:39:37.012845 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m20:39:37.193462 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m20:39:37.213906 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m20:39:37.215746 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:39:37.217493 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m20:39:37.219090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:39:37.220486 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:39:37.222158 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m20:39:37.223983 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:39:37.245742 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:39:37.248013 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:39:37.249646 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:39:37.251508 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY"'Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m20:39:37.253184 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:39:37.255828 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m20:39:37.259041 [debug] [Thread-2  ]: Postgres adapter: Postgres error: function rond(numeric, integer) does not exist
LINE 19:     ROND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae spe...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m20:39:37.260886 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: ROLLBACK
[0m20:39:37.264148 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 20:39:37.014468 => 20:39:37.263414
[0m20:39:37.265312 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m20:39:37.273691 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:39:37.298781 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:39:37.300930 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m20:39:37.305058 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:37.315585 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:39:37.316920 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m20:39:37.319176 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:39:37.358215 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:39:37.359968 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:39:37.361569 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:39:37.421678 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:39:37.439216 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m20:39:37.452895 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:39:37.455314 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m20:39:37.721277 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m20:39:37.726236 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 20:39:37.001282 => 20:39:37.725205
[0m20:39:37.728663 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m20:39:37.836916 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8df95c8f-0958-4960-8713-3ab4bb3c9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a073fb20>]}
[0m20:39:37.838546 [info ] [Thread-1  ]: 1 of 2 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.89s]
[0m20:39:37.840328 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m20:39:38.304627 [debug] [Thread-2  ]: Database Error in model vehicle_type (models/vehicle_type.sql)
  function rond(numeric, integer) does not exist
  LINE 19:     ROND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae spe...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:39:38.306002 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8df95c8f-0958-4960-8713-3ab4bb3c9849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a0741430>]}
[0m20:39:38.307515 [error] [Thread-2  ]: 2 of 2 ERROR creating sql table model traffic_schema.vehicle_type .............. [[31mERROR[0m in 1.36s]
[0m20:39:38.309207 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m20:39:38.312071 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:38.313909 [debug] [MainThread]: On master: BEGIN
[0m20:39:38.315749 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:39:38.337200 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:39:38.339126 [debug] [MainThread]: On master: COMMIT
[0m20:39:38.340692 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:38.342184 [debug] [MainThread]: On master: COMMIT
[0m20:39:38.343850 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:39:38.345824 [debug] [MainThread]: On master: Close
[0m20:39:38.350340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:38.355292 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m20:39:38.357822 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m20:39:38.360611 [info ] [MainThread]: 
[0m20:39:38.363172 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m20:39:38.368622 [debug] [MainThread]: Command end result
[0m20:39:38.389768 [info ] [MainThread]: 
[0m20:39:38.391036 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:39:38.392108 [info ] [MainThread]: 
[0m20:39:38.393221 [error] [MainThread]:   Database Error in model vehicle_type (models/vehicle_type.sql)
  function rond(numeric, integer) does not exist
  LINE 19:     ROND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae spe...
               ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:39:38.394262 [info ] [MainThread]: 
[0m20:39:38.396612 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:39:38.400218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.0944386, "process_user_time": 5.696086, "process_kernel_time": 0.266879, "process_mem_max_rss": "108128", "process_in_blocks": "1712", "process_out_blocks": "2368", "command_success": false}
[0m20:39:38.403355 [debug] [MainThread]: Command `dbt run` failed at 20:39:38.402364 after 3.10 seconds
[0m20:39:38.405411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a57ada60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a7021ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a23d7b80>]}
[0m20:39:38.407932 [debug] [MainThread]: Flushing usage events
[0m20:40:02.411972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc006f77be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00552e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00552eb20>]}


============================== 20:40:02.416859 | c58b9665-4cd7-47b1-b23f-fe02cc330235 ==============================
[0m20:40:02.416859 [info ] [MainThread]: Running with dbt=1.7.13
[0m20:40:02.418114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:40:03.773284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c58b9665-4cd7-47b1-b23f-fe02cc330235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0087ead60>]}
[0m20:40:04.301905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c58b9665-4cd7-47b1-b23f-fe02cc330235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc003cc63d0>]}
[0m20:40:04.303657 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m20:40:04.322243 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m20:40:04.376537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:40:05.907065 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_type.sql
[0m20:40:06.171588 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m20:40:06.181178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c58b9665-4cd7-47b1-b23f-fe02cc330235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc002fdc610>]}
[0m20:40:06.591352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c58b9665-4cd7-47b1-b23f-fe02cc330235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc003a2f0d0>]}
[0m20:40:06.592857 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:40:06.594505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c58b9665-4cd7-47b1-b23f-fe02cc330235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc003c91dc0>]}
[0m20:40:06.597437 [info ] [MainThread]: 
[0m20:40:06.599323 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:06.601613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m20:40:06.623353 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m20:40:06.624595 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m20:40:06.625691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:06.778793 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:40:06.781235 [debug] [ThreadPool]: On list_traffic: Close
[0m20:40:06.784610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m20:40:06.796130 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:40:06.797163 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m20:40:06.798072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:06.818914 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:40:06.820098 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:40:06.821102 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m20:40:06.826138 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:40:06.828811 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m20:40:06.829991 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m20:40:06.844314 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:06.845371 [debug] [MainThread]: On master: BEGIN
[0m20:40:06.846261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:06.862387 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:40:06.863584 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:06.864714 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:06.874864 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:40:06.877940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c58b9665-4cd7-47b1-b23f-fe02cc330235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc002fdc7f0>]}
[0m20:40:06.879114 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:06.880302 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:06.881335 [debug] [MainThread]: On master: BEGIN
[0m20:40:06.882833 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:40:06.883929 [debug] [MainThread]: On master: COMMIT
[0m20:40:06.884957 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:06.885964 [debug] [MainThread]: On master: COMMIT
[0m20:40:06.887107 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:40:06.888147 [debug] [MainThread]: On master: Close
[0m20:40:06.889808 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:40:06.891068 [info ] [MainThread]: 
[0m20:40:06.895990 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m20:40:06.897481 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m20:40:06.899217 [info ] [Thread-1  ]: 1 of 2 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m20:40:06.900856 [info ] [Thread-2  ]: 2 of 2 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m20:40:06.902758 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m20:40:06.904906 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m20:40:06.906462 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m20:40:06.907810 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m20:40:06.922013 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m20:40:06.930373 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m20:40:06.932844 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 20:40:06.908904 => 20:40:06.931877
[0m20:40:06.934527 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 20:40:06.922810 => 20:40:06.933742
[0m20:40:06.935883 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m20:40:06.937518 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m20:40:07.087614 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m20:40:07.109791 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m20:40:07.112388 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:40:07.113689 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m20:40:07.115111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:07.117077 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:40:07.119389 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m20:40:07.121436 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:40:07.135611 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:40:07.136898 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:40:07.138105 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m20:40:07.148217 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:40:07.149593 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:40:07.150861 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY"'Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m20:40:07.153267 [debug] [Thread-2  ]: Postgres adapter: Postgres error: column "'Vehicle count" does not exist
LINE 22:     ORDER BY"'Vehicle count" ASC
                     ^

[0m20:40:07.154517 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: ROLLBACK
[0m20:40:07.156266 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 20:40:06.949448 => 20:40:07.155654
[0m20:40:07.157435 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m20:40:07.162142 [debug] [Thread-2  ]: Database Error in model vehicle_type (models/vehicle_type.sql)
  column "'Vehicle count" does not exist
  LINE 22:     ORDER BY"'Vehicle count" ASC
                       ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:40:07.163736 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c58b9665-4cd7-47b1-b23f-fe02cc330235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc000777640>]}
[0m20:40:07.165422 [error] [Thread-2  ]: 2 of 2 ERROR creating sql table model traffic_schema.vehicle_type .............. [[31mERROR[0m in 0.26s]
[0m20:40:07.167393 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m20:40:07.275501 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:40:07.288028 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:40:07.289313 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m20:40:07.631237 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:07.639954 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:40:07.641514 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m20:40:07.643325 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:07.675584 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:40:07.676852 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:40:07.677972 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:40:07.956711 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:40:07.970309 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m20:40:07.980600 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:40:07.981899 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m20:40:08.211684 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m20:40:08.337377 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 20:40:06.939047 => 20:40:08.336795
[0m20:40:08.338676 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m20:40:08.341276 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c58b9665-4cd7-47b1-b23f-fe02cc330235', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc00279ec40>]}
[0m20:40:08.343058 [info ] [Thread-1  ]: 1 of 2 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 1.44s]
[0m20:40:08.344829 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m20:40:08.347425 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:08.348548 [debug] [MainThread]: On master: BEGIN
[0m20:40:08.349623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:08.369425 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:40:08.370611 [debug] [MainThread]: On master: COMMIT
[0m20:40:08.371695 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:08.372781 [debug] [MainThread]: On master: COMMIT
[0m20:40:08.374045 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:40:08.377032 [debug] [MainThread]: On master: Close
[0m20:40:08.381757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:08.383629 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m20:40:08.384778 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m20:40:08.385815 [info ] [MainThread]: 
[0m20:40:08.386979 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m20:40:08.389103 [debug] [MainThread]: Command end result
[0m20:40:08.724287 [info ] [MainThread]: 
[0m20:40:08.725662 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:40:08.727477 [info ] [MainThread]: 
[0m20:40:08.729476 [error] [MainThread]:   Database Error in model vehicle_type (models/vehicle_type.sql)
  column "'Vehicle count" does not exist
  LINE 22:     ORDER BY"'Vehicle count" ASC
                       ^
  compiled Code at target/run/traffic_data/models/vehicle_type.sql
[0m20:40:08.731569 [info ] [MainThread]: 
[0m20:40:08.733838 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m20:40:08.737196 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.417939, "process_user_time": 5.297175, "process_kernel_time": 0.259861, "process_mem_max_rss": "107776", "process_in_blocks": "192", "process_out_blocks": "2368", "command_success": false}
[0m20:40:08.739956 [debug] [MainThread]: Command `dbt run` failed at 20:40:08.739210 after 6.42 seconds
[0m20:40:08.742323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc006f77be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc003c9bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0087ead60>]}
[0m20:40:08.744720 [debug] [MainThread]: Flushing usage events
[0m20:40:30.950268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34050bfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3403677430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3403677b50>]}


============================== 20:40:30.955201 | bfab3158-3b43-436b-a5cf-c2ddf7e028c7 ==============================
[0m20:40:30.955201 [info ] [MainThread]: Running with dbt=1.7.13
[0m20:40:30.956486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:40:31.325488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfab3158-3b43-436b-a5cf-c2ddf7e028c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3406932d90>]}
[0m20:40:31.502017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfab3158-3b43-436b-a5cf-c2ddf7e028c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3405802d90>]}
[0m20:40:31.503603 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m20:40:31.524661 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m20:40:31.587683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:40:31.589025 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_type.sql
[0m20:40:31.836376 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m20:40:31.847095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfab3158-3b43-436b-a5cf-c2ddf7e028c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3401328640>]}
[0m20:40:31.870021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfab3158-3b43-436b-a5cf-c2ddf7e028c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3401b78280>]}
[0m20:40:31.871486 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:40:31.872548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfab3158-3b43-436b-a5cf-c2ddf7e028c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3401cad280>]}
[0m20:40:31.875110 [info ] [MainThread]: 
[0m20:40:31.876836 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:40:31.880063 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m20:40:31.902866 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m20:40:31.903901 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m20:40:31.904780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:31.930385 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m20:40:31.933634 [debug] [ThreadPool]: On list_traffic: Close
[0m20:40:31.937075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m20:40:31.955929 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:40:31.957656 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m20:40:31.958812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:31.981218 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:40:31.982938 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m20:40:31.984690 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m20:40:31.991288 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m20:40:31.994891 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m20:40:31.996700 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m20:40:32.007703 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:32.008733 [debug] [MainThread]: On master: BEGIN
[0m20:40:32.009605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:32.029002 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.030032 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:32.031071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:40:32.039823 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m20:40:32.042906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfab3158-3b43-436b-a5cf-c2ddf7e028c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340139dbb0>]}
[0m20:40:32.044036 [debug] [MainThread]: On master: ROLLBACK
[0m20:40:32.045272 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:32.046200 [debug] [MainThread]: On master: BEGIN
[0m20:40:32.047620 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.048568 [debug] [MainThread]: On master: COMMIT
[0m20:40:32.049474 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:32.050360 [debug] [MainThread]: On master: COMMIT
[0m20:40:32.051677 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:40:32.052665 [debug] [MainThread]: On master: Close
[0m20:40:32.054317 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m20:40:32.055510 [info ] [MainThread]: 
[0m20:40:32.060128 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m20:40:32.061885 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m20:40:32.064024 [info ] [Thread-1  ]: 1 of 2 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m20:40:32.066334 [info ] [Thread-2  ]: 2 of 2 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m20:40:32.069613 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m20:40:32.072709 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m20:40:32.075404 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m20:40:32.079917 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m20:40:32.109503 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m20:40:32.111932 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m20:40:32.114850 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 20:40:32.083684 => 20:40:32.113054
[0m20:40:32.116764 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m20:40:32.134744 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 20:40:32.098033 => 20:40:32.133063
[0m20:40:32.142008 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m20:40:32.262949 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m20:40:32.280505 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m20:40:32.282435 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:40:32.285154 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m20:40:32.287468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:40:32.290102 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:40:32.292129 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m20:40:32.293529 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m20:40:32.311855 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.313736 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:40:32.315332 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m20:40:32.317416 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m20:40:32.319462 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:40:32.321259 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:40:32.322954 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m20:40:32.339680 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:40:32.340954 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m20:40:32.342713 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:32.349503 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:40:32.350804 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m20:40:32.352500 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:32.384773 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:40:32.386037 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:40:32.387164 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m20:40:32.514499 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m20:40:32.528441 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m20:40:32.537994 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m20:40:32.539163 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m20:40:32.614241 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m20:40:32.633953 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 20:40:32.117512 => 20:40:32.633373
[0m20:40:32.635118 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m20:40:32.636957 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfab3158-3b43-436b-a5cf-c2ddf7e028c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3400258460>]}
[0m20:40:32.638543 [info ] [Thread-1  ]: 1 of 2 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.57s]
[0m20:40:32.640208 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m20:40:33.395209 [debug] [Thread-2  ]: SQL status: SELECT 6 in 1.0 seconds
[0m20:40:33.405555 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:40:33.406707 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m20:40:33.436494 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:40:33.447075 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m20:40:33.448241 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:40:33.449260 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m20:40:33.481632 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m20:40:33.492640 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m20:40:33.500901 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m20:40:33.502044 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m20:40:33.503654 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m20:40:33.506799 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 20:40:32.149791 => 20:40:33.506209
[0m20:40:33.507880 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m20:40:33.509641 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfab3158-3b43-436b-a5cf-c2ddf7e028c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3400293eb0>]}
[0m20:40:33.511731 [info ] [Thread-2  ]: 2 of 2 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 1.44s]
[0m20:40:33.514650 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m20:40:33.518548 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:33.520676 [debug] [MainThread]: On master: BEGIN
[0m20:40:33.522495 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:33.548252 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:40:33.549896 [debug] [MainThread]: On master: COMMIT
[0m20:40:33.552133 [debug] [MainThread]: Using postgres connection "master"
[0m20:40:33.553654 [debug] [MainThread]: On master: COMMIT
[0m20:40:33.555584 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:40:33.556751 [debug] [MainThread]: On master: Close
[0m20:40:33.558766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:33.560192 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m20:40:33.561432 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m20:40:33.562586 [info ] [MainThread]: 
[0m20:40:33.564026 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m20:40:33.566661 [debug] [MainThread]: Command end result
[0m20:40:33.581908 [info ] [MainThread]: 
[0m20:40:33.583490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:33.584505 [info ] [MainThread]: 
[0m20:40:33.585544 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:40:33.587258 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.732889, "process_user_time": 5.24634, "process_kernel_time": 0.187227, "process_mem_max_rss": "107948", "process_in_blocks": "272", "process_out_blocks": "2360"}
[0m20:40:33.588719 [debug] [MainThread]: Command `dbt run` succeeded at 20:40:33.588226 after 2.73 seconds
[0m20:40:33.589831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34050bfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3401de4d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3400223130>]}
[0m20:40:33.591195 [debug] [MainThread]: Flushing usage events
[0m06:22:36.612888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c53f98c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5254b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5254b910>]}


============================== 06:22:36.678254 | 3a911c28-e6b1-4449-a124-d8fec02ecc53 ==============================
[0m06:22:36.678254 [info ] [MainThread]: Running with dbt=1.7.13
[0m06:22:36.680228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:22:36.681553 [info ] [MainThread]: dbt version: 1.7.13
[0m06:22:36.682690 [info ] [MainThread]: python version: 3.8.10
[0m06:22:36.683769 [info ] [MainThread]: python path: /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/bin/python3
[0m06:22:36.684846 [info ] [MainThread]: os info: Linux-5.15.0-105-generic-x86_64-with-glibc2.29
[0m06:22:37.219368 [info ] [MainThread]: Using profiles dir at /home/yohanes/.dbt
[0m06:22:37.220708 [info ] [MainThread]: Using profiles.yml file at /home/yohanes/.dbt/profiles.yml
[0m06:22:37.221830 [info ] [MainThread]: Using dbt_project.yml file at /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/dbt_project.yml
[0m06:22:37.223458 [info ] [MainThread]: adapter type: postgres
[0m06:22:37.224590 [info ] [MainThread]: adapter version: 1.7.13
[0m06:22:37.411205 [info ] [MainThread]: Configuration:
[0m06:22:37.412560 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:22:37.414092 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:22:37.415439 [info ] [MainThread]: Required dependencies:
[0m06:22:37.416653 [debug] [MainThread]: Executing "git --help"
[0m06:22:37.425855 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:22:37.428482 [debug] [MainThread]: STDERR: "b''"
[0m06:22:37.430675 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:22:37.432673 [info ] [MainThread]: Connection:
[0m06:22:37.435162 [info ] [MainThread]:   host: localhost
[0m06:22:37.438115 [info ] [MainThread]:   port: 5432
[0m06:22:37.440244 [info ] [MainThread]:   user: postgres
[0m06:22:37.441446 [info ] [MainThread]:   database: traffic
[0m06:22:37.442499 [info ] [MainThread]:   schema: traffic_schema
[0m06:22:37.443619 [info ] [MainThread]:   connect_timeout: 10
[0m06:22:37.445087 [info ] [MainThread]:   role: None
[0m06:22:37.448040 [info ] [MainThread]:   search_path: None
[0m06:22:37.450099 [info ] [MainThread]:   keepalives_idle: 0
[0m06:22:37.453308 [info ] [MainThread]:   sslmode: None
[0m06:22:37.455577 [info ] [MainThread]:   sslcert: None
[0m06:22:37.457338 [info ] [MainThread]:   sslkey: None
[0m06:22:37.458535 [info ] [MainThread]:   sslrootcert: None
[0m06:22:37.459804 [info ] [MainThread]:   application_name: dbt
[0m06:22:37.461675 [info ] [MainThread]:   retries: 1
[0m06:22:37.465326 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m06:22:37.468914 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m06:22:37.471136 [debug] [MainThread]: Using postgres connection "debug"
[0m06:22:37.472745 [debug] [MainThread]: On debug: select 1 as id
[0m06:22:37.475015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:22:37.829256 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m06:22:37.832520 [debug] [MainThread]: On debug: Close
[0m06:22:37.833974 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:22:37.835956 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:22:37.852506 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.465934, "process_user_time": 4.441151, "process_kernel_time": 0.19605, "process_mem_max_rss": "95484", "process_in_blocks": "19272", "process_out_blocks": "16"}
[0m06:22:37.855658 [debug] [MainThread]: Command `dbt debug` succeeded at 06:22:37.854701 after 1.47 seconds
[0m06:22:37.857869 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:22:37.860385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c53f98c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c52552220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c50ceeeb0>]}
[0m06:22:37.861731 [debug] [MainThread]: Flushing usage events
[0m06:22:49.485724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d8775be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d6d27400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d6d27b20>]}


============================== 06:22:49.490716 | b472a3bc-c953-498a-80c6-5f5bfc637056 ==============================
[0m06:22:49.490716 [info ] [MainThread]: Running with dbt=1.7.13
[0m06:22:49.492394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'profiles_dir': '/home/yohanes/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:22:49.881360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b472a3bc-c953-498a-80c6-5f5bfc637056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d9fe8d60>]}
[0m06:22:50.066069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b472a3bc-c953-498a-80c6-5f5bfc637056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d54be3d0>]}
[0m06:22:50.067663 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m06:22:50.108043 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m06:22:50.247654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:22:50.248642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:22:50.249918 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m06:22:50.261656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b472a3bc-c953-498a-80c6-5f5bfc637056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d5170bb0>]}
[0m06:22:50.321082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b472a3bc-c953-498a-80c6-5f5bfc637056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d522d8e0>]}
[0m06:22:50.322381 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m06:22:50.323485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b472a3bc-c953-498a-80c6-5f5bfc637056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d54a6d90>]}
[0m06:22:50.326024 [info ] [MainThread]: 
[0m06:22:50.328530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:22:50.333005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m06:22:50.358085 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m06:22:50.359396 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m06:22:50.360462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:50.686733 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m06:22:50.691212 [debug] [ThreadPool]: On list_traffic: Close
[0m06:22:50.695788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m06:22:50.709825 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m06:22:50.711007 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m06:22:50.711962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:50.776274 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:22:50.778150 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m06:22:50.780371 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m06:22:51.209838 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m06:22:51.214455 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m06:22:51.216793 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m06:22:51.232100 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:51.233466 [debug] [MainThread]: On master: BEGIN
[0m06:22:51.234580 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:22:51.258368 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:22:51.259525 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:51.260639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:22:51.441360 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m06:22:51.446072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b472a3bc-c953-498a-80c6-5f5bfc637056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d5170be0>]}
[0m06:22:51.447997 [debug] [MainThread]: On master: ROLLBACK
[0m06:22:51.450704 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:51.452580 [debug] [MainThread]: On master: BEGIN
[0m06:22:51.454518 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:22:51.455785 [debug] [MainThread]: On master: COMMIT
[0m06:22:51.456971 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:51.458167 [debug] [MainThread]: On master: COMMIT
[0m06:22:51.459673 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:22:51.460907 [debug] [MainThread]: On master: Close
[0m06:22:51.463528 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m06:22:51.465348 [info ] [MainThread]: 
[0m06:22:51.481173 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m06:22:51.483694 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m06:22:51.487267 [info ] [Thread-1  ]: 1 of 2 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m06:22:51.491869 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m06:22:51.489793 [info ] [Thread-2  ]: 2 of 2 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m06:22:51.493597 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m06:22:51.496935 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m06:22:51.507184 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m06:22:51.523498 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m06:22:51.529643 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m06:22:51.533706 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 06:22:51.501078 => 06:22:51.531300
[0m06:22:51.539470 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 06:22:51.518918 => 06:22:51.537523
[0m06:22:51.541466 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m06:22:51.543226 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m06:22:51.728726 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m06:22:51.741112 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m06:22:51.743004 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m06:22:51.744353 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m06:22:51.745463 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m06:22:51.747432 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m06:22:51.749185 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m06:22:51.751249 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:22:51.765419 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m06:22:51.767070 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m06:22:51.769217 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m06:22:51.771821 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m06:22:51.773241 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m06:22:51.774385 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        -- MAX(time) AS total_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m06:22:52.257153 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m06:22:52.277626 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m06:22:52.278855 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m06:22:52.281011 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:52.290866 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m06:22:52.292239 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m06:22:52.294323 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:52.329721 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m06:22:52.330932 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m06:22:52.331987 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m06:22:52.348195 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m06:22:52.362523 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m06:22:52.373944 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m06:22:52.375157 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m06:22:52.444413 [debug] [Thread-2  ]: SQL status: SELECT 6 in 1.0 seconds
[0m06:22:52.454937 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m06:22:52.456521 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m06:22:52.458827 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:52.465691 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m06:22:52.466902 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m06:22:52.468880 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:52.482309 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m06:22:52.483575 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m06:22:52.484947 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m06:22:52.515156 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m06:22:52.524809 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m06:22:52.526545 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m06:22:52.534307 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m06:22:52.539486 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 06:22:51.544128 => 06:22:52.538362
[0m06:22:52.541464 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m06:22:52.543255 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m06:22:52.546099 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b472a3bc-c953-498a-80c6-5f5bfc637056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d54a6d90>]}
[0m06:22:52.548186 [info ] [Thread-1  ]: 1 of 2 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 1.05s]
[0m06:22:52.550107 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m06:22:52.559796 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m06:22:52.564166 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 06:22:51.551286 => 06:22:52.563422
[0m06:22:52.565775 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m06:22:52.569055 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b472a3bc-c953-498a-80c6-5f5bfc637056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d48fe760>]}
[0m06:22:52.572694 [info ] [Thread-2  ]: 2 of 2 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 1.07s]
[0m06:22:52.576069 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m06:22:52.579871 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:52.581751 [debug] [MainThread]: On master: BEGIN
[0m06:22:52.583193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:52.608865 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:22:52.610092 [debug] [MainThread]: On master: COMMIT
[0m06:22:52.611623 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:52.612966 [debug] [MainThread]: On master: COMMIT
[0m06:22:52.614788 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:22:52.616084 [debug] [MainThread]: On master: Close
[0m06:22:52.618907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:52.621987 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m06:22:52.624259 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m06:22:52.627822 [info ] [MainThread]: 
[0m06:22:52.629133 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m06:22:52.631275 [debug] [MainThread]: Command end result
[0m06:22:52.656329 [info ] [MainThread]: 
[0m06:22:52.658663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:22:52.661484 [info ] [MainThread]: 
[0m06:22:52.664605 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m06:22:52.667117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2799988, "process_user_time": 5.361298, "process_kernel_time": 0.155805, "process_mem_max_rss": "104640", "process_in_blocks": "1976", "process_out_blocks": "1600"}
[0m06:22:52.669267 [debug] [MainThread]: Command `dbt run` succeeded at 06:22:52.668535 after 3.28 seconds
[0m06:22:52.673158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d8775be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d547a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d53d4880>]}
[0m06:22:52.676157 [debug] [MainThread]: Flushing usage events
[0m06:24:44.703897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b0e2bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6af3e04c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6af3e0ca0>]}


============================== 06:24:44.709058 | 566cf1fa-05f0-40c3-abfe-2e121e20facb ==============================
[0m06:24:44.709058 [info ] [MainThread]: Running with dbt=1.7.13
[0m06:24:44.711174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'debug': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:24:45.055508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '566cf1fa-05f0-40c3-abfe-2e121e20facb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b269ed30>]}
[0m06:24:45.252286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '566cf1fa-05f0-40c3-abfe-2e121e20facb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6adb7be20>]}
[0m06:24:45.253815 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m06:24:45.280120 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m06:24:45.346617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:24:45.347925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:24:45.349237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m06:24:45.362970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '566cf1fa-05f0-40c3-abfe-2e121e20facb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ad823c70>]}
[0m06:24:45.366720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '566cf1fa-05f0-40c3-abfe-2e121e20facb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ad8e5a30>]}
[0m06:24:45.368999 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m06:24:45.371700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '566cf1fa-05f0-40c3-abfe-2e121e20facb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ad8e5bb0>]}
[0m06:24:45.376919 [info ] [MainThread]: 
[0m06:24:45.381337 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:24:45.387021 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic_traffic_schema'
[0m06:24:45.421035 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m06:24:45.422334 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m06:24:45.423465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:24:45.451150 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:24:45.452354 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m06:24:45.453371 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m06:24:45.460022 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m06:24:45.466746 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m06:24:45.468175 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m06:24:45.481460 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:45.482504 [debug] [MainThread]: On master: BEGIN
[0m06:24:45.483366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:24:45.504512 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:24:45.505575 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:45.506639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:24:45.517774 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m06:24:45.522431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '566cf1fa-05f0-40c3-abfe-2e121e20facb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ad886c70>]}
[0m06:24:45.524116 [debug] [MainThread]: On master: ROLLBACK
[0m06:24:45.525981 [debug] [MainThread]: On master: Close
[0m06:24:45.529054 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m06:24:45.531311 [info ] [MainThread]: 
[0m06:24:45.537884 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m06:24:45.539397 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m06:24:45.541019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m06:24:45.544880 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m06:24:45.542975 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m06:24:45.559577 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m06:24:45.571649 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m06:24:45.575637 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m06:24:45.578427 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 06:24:45.566024 => 06:24:45.577303
[0m06:24:45.582716 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 06:24:45.546693 => 06:24:45.581094
[0m06:24:45.584521 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m06:24:45.585776 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m06:24:45.587303 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 06:24:45.586656 => 06:24:45.586693
[0m06:24:45.589069 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 06:24:45.588276 => 06:24:45.588302
[0m06:24:45.591585 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m06:24:45.594555 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m06:24:45.600143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:24:45.601497 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m06:24:45.602690 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m06:24:45.604921 [debug] [MainThread]: Command end result
[0m06:24:45.674338 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m06:24:45.675322 [info ] [MainThread]: Building catalog
[0m06:24:45.678969 [debug] [ThreadPool]: Acquiring new postgres connection 'traffic.information_schema'
[0m06:24:45.704221 [debug] [ThreadPool]: Using postgres connection "traffic.information_schema"
[0m06:24:45.705272 [debug] [ThreadPool]: On traffic.information_schema: BEGIN
[0m06:24:45.706141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:24:45.728517 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:24:45.732774 [debug] [ThreadPool]: Using postgres connection "traffic.information_schema"
[0m06:24:45.735043 [debug] [ThreadPool]: On traffic.information_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "traffic.information_schema"} */

    
    

    select
        'traffic' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('vehicle_type')) or (upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('trajectory_summary')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m06:24:45.943539 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m06:24:45.954381 [debug] [ThreadPool]: On traffic.information_schema: ROLLBACK
[0m06:24:45.955803 [debug] [ThreadPool]: On traffic.information_schema: Close
[0m06:24:45.976268 [info ] [MainThread]: Catalog written to /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/target/catalog.json
[0m06:24:45.978396 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.3747038, "process_user_time": 4.885191, "process_kernel_time": 0.212051, "process_mem_max_rss": "103160", "process_in_blocks": "2944", "process_out_blocks": "4528"}
[0m06:24:45.980077 [debug] [MainThread]: Command `dbt docs generate` succeeded at 06:24:45.979588 after 1.38 seconds
[0m06:24:45.981543 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m06:24:45.983043 [debug] [MainThread]: Connection 'traffic.information_schema' was properly closed.
[0m06:24:45.985240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6b0e2bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6adb7be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6ad8e5af0>]}
[0m06:24:45.987259 [debug] [MainThread]: Flushing usage events
[0m06:25:18.945528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20636b8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2061c6b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2061c6bac0>]}


============================== 06:25:18.950377 | aabea030-3cf2-4695-b018-631009f8d8ca ==============================
[0m06:25:18.950377 [info ] [MainThread]: Running with dbt=1.7.13
[0m06:25:18.951789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:25:19.289819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aabea030-3cf2-4695-b018-631009f8d8ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2062f46430>]}
[0m06:25:19.472280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aabea030-3cf2-4695-b018-631009f8d8ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20624e3b20>]}
[0m06:26:03.309336 [error] [MainThread]: Encountered an error:

[0m06:26:03.355255 [error] [MainThread]: Traceback (most recent call last):
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.8/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m06:26:03.359295 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 44.522182, "process_user_time": 4.563684, "process_kernel_time": 0.144116, "process_mem_max_rss": "94404", "process_in_blocks": "160", "process_out_blocks": "2960", "command_success": false}
[0m06:26:03.361749 [debug] [MainThread]: Command `dbt docs serve` failed at 06:26:03.361299 after 44.52 seconds
[0m06:26:03.363908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20636b8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206034ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2060232250>]}
[0m06:26:03.365387 [debug] [MainThread]: Flushing usage events
[0m07:42:59.307394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd623c35c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6221e8310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6221e8d60>]}


============================== 07:42:59.315420 | 1bafe43e-3966-4c54-822a-ef9963ba5d08 ==============================
[0m07:42:59.315420 [info ] [MainThread]: Running with dbt=1.7.13
[0m07:42:59.317658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:42:59.319509 [info ] [MainThread]: dbt version: 1.7.13
[0m07:42:59.321652 [info ] [MainThread]: python version: 3.8.10
[0m07:42:59.324178 [info ] [MainThread]: python path: /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/bin/python3
[0m07:42:59.327054 [info ] [MainThread]: os info: Linux-5.15.0-105-generic-x86_64-with-glibc2.29
[0m07:42:59.530131 [info ] [MainThread]: Using profiles dir at /home/yohanes/.dbt
[0m07:42:59.531423 [info ] [MainThread]: Using profiles.yml file at /home/yohanes/.dbt/profiles.yml
[0m07:42:59.532531 [info ] [MainThread]: Using dbt_project.yml file at /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/dbt_project.yml
[0m07:42:59.533848 [info ] [MainThread]: adapter type: postgres
[0m07:42:59.534977 [info ] [MainThread]: adapter version: 1.7.13
[0m07:42:59.732053 [info ] [MainThread]: Configuration:
[0m07:42:59.733222 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:42:59.734223 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:42:59.735191 [info ] [MainThread]: Required dependencies:
[0m07:42:59.736187 [debug] [MainThread]: Executing "git --help"
[0m07:42:59.745793 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:42:59.748056 [debug] [MainThread]: STDERR: "b''"
[0m07:42:59.750103 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:42:59.751886 [info ] [MainThread]: Connection:
[0m07:42:59.753406 [info ] [MainThread]:   host: localhost
[0m07:42:59.754571 [info ] [MainThread]:   port: 5432
[0m07:42:59.756147 [info ] [MainThread]:   user: postgres
[0m07:42:59.759332 [info ] [MainThread]:   database: traffic
[0m07:42:59.761348 [info ] [MainThread]:   schema: traffic_schema
[0m07:42:59.763592 [info ] [MainThread]:   connect_timeout: 10
[0m07:42:59.765806 [info ] [MainThread]:   role: None
[0m07:42:59.768135 [info ] [MainThread]:   search_path: None
[0m07:42:59.769430 [info ] [MainThread]:   keepalives_idle: 0
[0m07:42:59.770489 [info ] [MainThread]:   sslmode: None
[0m07:42:59.771636 [info ] [MainThread]:   sslcert: None
[0m07:42:59.775113 [info ] [MainThread]:   sslkey: None
[0m07:42:59.778516 [info ] [MainThread]:   sslrootcert: None
[0m07:42:59.781320 [info ] [MainThread]:   application_name: dbt
[0m07:42:59.783854 [info ] [MainThread]:   retries: 1
[0m07:42:59.786304 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m07:42:59.789328 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m07:42:59.792023 [debug] [MainThread]: Using postgres connection "debug"
[0m07:42:59.794406 [debug] [MainThread]: On debug: select 1 as id
[0m07:42:59.796852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:42:59.826851 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m07:42:59.831490 [debug] [MainThread]: On debug: Close
[0m07:42:59.833611 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:42:59.835614 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:42:59.838756 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.65440637, "process_user_time": 4.574368, "process_kernel_time": 0.147431, "process_mem_max_rss": "95580", "process_in_blocks": "120", "process_out_blocks": "16"}
[0m07:42:59.844952 [debug] [MainThread]: Command `dbt debug` succeeded at 07:42:59.842880 after 0.66 seconds
[0m07:42:59.847639 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:42:59.851437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd623c35c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6254a7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd625e956a0>]}
[0m07:42:59.852918 [debug] [MainThread]: Flushing usage events
[0m07:43:09.970005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa894c2ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8931e3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8931e3b50>]}


============================== 07:43:09.975137 | 20ebcd40-a6e5-4cfe-8f9b-377fb2290813 ==============================
[0m07:43:09.975137 [info ] [MainThread]: Running with dbt=1.7.13
[0m07:43:09.976519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:10.339298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20ebcd40-a6e5-4cfe-8f9b-377fb2290813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8964a0d90>]}
[0m07:43:10.539862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20ebcd40-a6e5-4cfe-8f9b-377fb2290813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa895372d90>]}
[0m07:43:10.541718 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m07:43:10.569990 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m07:43:10.651443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m07:43:10.652758 [debug] [MainThread]: Partial parsing: added file: traffic_data://models/merged_id.sql
[0m07:43:10.654069 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/trajectory_summary.sql
[0m07:43:10.968005 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m07:43:10.980663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20ebcd40-a6e5-4cfe-8f9b-377fb2290813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa890efeaf0>]}
[0m07:43:11.008309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20ebcd40-a6e5-4cfe-8f9b-377fb2290813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8916e6b80>]}
[0m07:43:11.009932 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:43:11.011337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20ebcd40-a6e5-4cfe-8f9b-377fb2290813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa891952cd0>]}
[0m07:43:11.014321 [info ] [MainThread]: 
[0m07:43:11.018346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:11.023454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m07:43:11.059331 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m07:43:11.060427 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m07:43:11.061724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:11.091054 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m07:43:11.093988 [debug] [ThreadPool]: On list_traffic: Close
[0m07:43:11.100290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m07:43:11.118335 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:43:11.120092 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m07:43:11.121791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:11.156376 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:43:11.157959 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:43:11.159411 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m07:43:11.166678 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:43:11.171027 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m07:43:11.172974 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m07:43:11.188235 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.189450 [debug] [MainThread]: On master: BEGIN
[0m07:43:11.190449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:11.210963 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:43:11.212519 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.213971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:11.225301 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m07:43:11.229011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20ebcd40-a6e5-4cfe-8f9b-377fb2290813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8916e6d00>]}
[0m07:43:11.230417 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:11.231876 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.233803 [debug] [MainThread]: On master: BEGIN
[0m07:43:11.236003 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:43:11.237947 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.239634 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:11.241241 [debug] [MainThread]: On master: COMMIT
[0m07:43:11.243105 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:43:11.244134 [debug] [MainThread]: On master: Close
[0m07:43:11.245826 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:43:11.247232 [info ] [MainThread]: 
[0m07:43:11.260234 [debug] [Thread-1  ]: Began running node model.traffic_data.merged_id
[0m07:43:11.268191 [info ] [Thread-1  ]: 1 of 3 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m07:43:11.264165 [debug] [Thread-3  ]: Began running node model.traffic_data.vehicle_type
[0m07:43:11.262495 [debug] [Thread-2  ]: Began running node model.traffic_data.trajectory_summary
[0m07:43:11.271971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.merged_id)
[0m07:43:11.275278 [info ] [Thread-3  ]: 3 of 3 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m07:43:11.277760 [info ] [Thread-2  ]: 2 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m07:43:11.280828 [debug] [Thread-1  ]: Began compiling node model.traffic_data.merged_id
[0m07:43:11.284939 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m07:43:11.289836 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.trajectory_summary'
[0m07:43:11.308434 [debug] [Thread-3  ]: Began compiling node model.traffic_data.vehicle_type
[0m07:43:11.319922 [debug] [Thread-2  ]: Began compiling node model.traffic_data.trajectory_summary
[0m07:43:11.329857 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m07:43:11.331705 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m07:43:11.339550 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m07:43:11.342304 [debug] [Thread-1  ]: Timing info for model.traffic_data.merged_id (compile): 07:43:11.291672 => 07:43:11.341007
[0m07:43:11.344540 [debug] [Thread-3  ]: Timing info for model.traffic_data.vehicle_type (compile): 07:43:11.321464 => 07:43:11.343755
[0m07:43:11.345871 [debug] [Thread-1  ]: Began executing node model.traffic_data.merged_id
[0m07:43:11.347584 [debug] [Thread-3  ]: Began executing node model.traffic_data.vehicle_type
[0m07:43:11.355040 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (compile): 07:43:11.332891 => 07:43:11.353883
[0m07:43:11.389422 [debug] [Thread-2  ]: Began executing node model.traffic_data.trajectory_summary
[0m07:43:11.648484 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m07:43:11.650776 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m07:43:11.658751 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m07:43:11.661969 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:43:11.663706 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:43:11.665119 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:43:11.666949 [debug] [Thread-1  ]: On model.traffic_data.merged_id: BEGIN
[0m07:43:11.669314 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: BEGIN
[0m07:43:11.671209 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m07:43:11.672765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:43:11.674761 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:43:11.676933 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:43:11.707181 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m07:43:11.708858 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:43:11.710240 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:43:11.711589 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m07:43:11.712943 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:43:11.714663 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc
        AVERAGE(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m07:43:11.716192 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:43:11.718045 [debug] [Thread-1  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT * FROM vehicles AS v
    JOIN trajectory AS t
    ON v.track_id = t.tracfk_id
)

SELECT * FROM merged_data
  );
  
[0m07:43:11.721344 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m07:43:11.743844 [debug] [Thread-2  ]: Postgres adapter: Postgres error: syntax error at or near "AVERAGE"
LINE 13:         AVERAGE(time) AS average_time
                 ^

[0m07:43:11.745186 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: ROLLBACK
[0m07:43:11.746966 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (execute): 07:43:11.396018 => 07:43:11.746350
[0m07:43:11.748131 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: Close
[0m07:43:11.766037 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column t.tracfk_id does not exist
LINE 17:     ON v.track_id = t.tracfk_id
                             ^
HINT:  Perhaps you meant to reference the column "t.track_id".

[0m07:43:11.768325 [debug] [Thread-1  ]: On model.traffic_data.merged_id: ROLLBACK
[0m07:43:11.771295 [debug] [Thread-1  ]: Timing info for model.traffic_data.merged_id (execute): 07:43:11.348598 => 07:43:11.770079
[0m07:43:11.773962 [debug] [Thread-1  ]: On model.traffic_data.merged_id: Close
[0m07:43:11.846744 [debug] [Thread-3  ]: SQL status: SELECT 6 in 0.0 seconds
[0m07:43:11.861157 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:43:11.862704 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m07:43:11.864932 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:43:11.873221 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:43:11.874553 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m07:43:11.876905 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:43:11.926875 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:43:11.928686 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:43:11.929879 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:43:11.983085 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m07:43:12.001358 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m07:43:12.013269 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:43:12.014729 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m07:43:12.016323 [debug] [Thread-1  ]: Database Error in model merged_id (models/merged_id.sql)
  column t.tracfk_id does not exist
  LINE 17:     ON v.track_id = t.tracfk_id
                               ^
  HINT:  Perhaps you meant to reference the column "t.track_id".
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:43:12.018906 [debug] [Thread-2  ]: Database Error in model trajectory_summary (models/trajectory_summary.sql)
  syntax error at or near "AVERAGE"
  LINE 13:         AVERAGE(time) AS average_time
                   ^
  compiled Code at target/run/traffic_data/models/trajectory_summary.sql
[0m07:43:12.021717 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20ebcd40-a6e5-4cfe-8f9b-377fb2290813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8905bb340>]}
[0m07:43:12.024195 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20ebcd40-a6e5-4cfe-8f9b-377fb2290813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8905ffb80>]}
[0m07:43:12.026558 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model traffic_schema.merged_id ................. [[31mERROR[0m in 0.75s]
[0m07:43:12.028949 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model traffic_schema.trajectory_summary ......... [[31mERROR[0m in 0.74s]
[0m07:43:12.031140 [debug] [Thread-1  ]: Finished running node model.traffic_data.merged_id
[0m07:43:12.032772 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m07:43:12.035626 [debug] [Thread-2  ]: Finished running node model.traffic_data.trajectory_summary
[0m07:43:12.042739 [debug] [Thread-3  ]: Timing info for model.traffic_data.vehicle_type (execute): 07:43:11.362127 => 07:43:12.041683
[0m07:43:12.045845 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: Close
[0m07:43:12.049085 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20ebcd40-a6e5-4cfe-8f9b-377fb2290813', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8905bbbe0>]}
[0m07:43:12.051486 [info ] [Thread-3  ]: 3 of 3 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 0.77s]
[0m07:43:12.055588 [debug] [Thread-3  ]: Finished running node model.traffic_data.vehicle_type
[0m07:43:12.061111 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:12.063290 [debug] [MainThread]: On master: BEGIN
[0m07:43:12.065442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:12.099371 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:43:12.100821 [debug] [MainThread]: On master: COMMIT
[0m07:43:12.109056 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:12.113765 [debug] [MainThread]: On master: COMMIT
[0m07:43:12.115876 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:43:12.117324 [debug] [MainThread]: On master: Close
[0m07:43:12.121629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:12.124113 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m07:43:12.127344 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m07:43:12.130278 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m07:43:12.131862 [info ] [MainThread]: 
[0m07:43:12.133533 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m07:43:12.137473 [debug] [MainThread]: Command end result
[0m07:43:12.160312 [info ] [MainThread]: 
[0m07:43:12.162150 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:43:12.163931 [info ] [MainThread]: 
[0m07:43:12.165118 [error] [MainThread]:   Database Error in model merged_id (models/merged_id.sql)
  column t.tracfk_id does not exist
  LINE 17:     ON v.track_id = t.tracfk_id
                               ^
  HINT:  Perhaps you meant to reference the column "t.track_id".
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:43:12.166261 [info ] [MainThread]: 
[0m07:43:12.167590 [error] [MainThread]:   Database Error in model trajectory_summary (models/trajectory_summary.sql)
  syntax error at or near "AVERAGE"
  LINE 13:         AVERAGE(time) AS average_time
                   ^
  compiled Code at target/run/traffic_data/models/trajectory_summary.sql
[0m07:43:12.169301 [info ] [MainThread]: 
[0m07:43:12.172872 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m07:43:12.176632 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.318937, "process_user_time": 6.056198, "process_kernel_time": 0.238903, "process_mem_max_rss": "108656", "process_in_blocks": "928", "process_out_blocks": "2416", "command_success": false}
[0m07:43:12.179066 [debug] [MainThread]: Command `dbt run` failed at 07:43:12.178500 after 2.32 seconds
[0m07:43:12.180478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa894c2ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa891791160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8916417f0>]}
[0m07:43:12.182893 [debug] [MainThread]: Flushing usage events
[0m07:43:32.173327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac1be6b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac01983d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac0198af0>]}


============================== 07:43:32.179788 | 5339d597-f685-4061-aeb8-f8fcf0a2b28f ==============================
[0m07:43:32.179788 [info ] [MainThread]: Running with dbt=1.7.13
[0m07:43:32.181960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:43:32.597983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5339d597-f685-4061-aeb8-f8fcf0a2b28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac01983a0>]}
[0m07:43:32.836867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5339d597-f685-4061-aeb8-f8fcf0a2b28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac012b550>]}
[0m07:43:32.838767 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m07:43:32.867757 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m07:43:32.954670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:43:32.957231 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/trajectory_summary.sql
[0m07:43:33.264493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m07:43:33.281357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5339d597-f685-4061-aeb8-f8fcf0a2b28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabdcb6a60>]}
[0m07:43:33.312165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5339d597-f685-4061-aeb8-f8fcf0a2b28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabe6be940>]}
[0m07:43:33.313422 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:43:33.314661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5339d597-f685-4061-aeb8-f8fcf0a2b28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabe5cf100>]}
[0m07:43:33.320995 [info ] [MainThread]: 
[0m07:43:33.324138 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:33.327279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m07:43:33.362293 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m07:43:33.363747 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m07:43:33.365282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:33.392789 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m07:43:33.395458 [debug] [ThreadPool]: On list_traffic: Close
[0m07:43:33.400525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m07:43:33.413871 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:43:33.415241 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m07:43:33.416316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:33.436218 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:43:33.438045 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:43:33.439736 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m07:43:33.447296 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:43:33.452151 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m07:43:33.454270 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m07:43:33.468527 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:33.469995 [debug] [MainThread]: On master: BEGIN
[0m07:43:33.471892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:33.489541 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:43:33.490610 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:33.491620 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:33.501367 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m07:43:33.506931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5339d597-f685-4061-aeb8-f8fcf0a2b28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabdcb2190>]}
[0m07:43:33.508239 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:33.509559 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:33.510791 [debug] [MainThread]: On master: BEGIN
[0m07:43:33.512304 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:43:33.513469 [debug] [MainThread]: On master: COMMIT
[0m07:43:33.514609 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:33.515732 [debug] [MainThread]: On master: COMMIT
[0m07:43:33.517921 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:43:33.519100 [debug] [MainThread]: On master: Close
[0m07:43:33.520930 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:43:33.522436 [info ] [MainThread]: 
[0m07:43:33.526593 [debug] [Thread-1  ]: Began running node model.traffic_data.merged_id
[0m07:43:33.528390 [debug] [Thread-2  ]: Began running node model.traffic_data.trajectory_summary
[0m07:43:33.530132 [debug] [Thread-3  ]: Began running node model.traffic_data.vehicle_type
[0m07:43:33.532100 [info ] [Thread-1  ]: 1 of 3 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m07:43:33.534418 [info ] [Thread-2  ]: 2 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m07:43:33.540693 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.merged_id)
[0m07:43:33.536620 [info ] [Thread-3  ]: 3 of 3 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m07:43:33.545248 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.trajectory_summary'
[0m07:43:33.547891 [debug] [Thread-1  ]: Began compiling node model.traffic_data.merged_id
[0m07:43:33.556628 [debug] [Thread-2  ]: Began compiling node model.traffic_data.trajectory_summary
[0m07:43:33.553620 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m07:43:33.578845 [debug] [Thread-3  ]: Began compiling node model.traffic_data.vehicle_type
[0m07:43:33.596471 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m07:43:33.593281 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m07:43:33.606521 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (compile): 07:43:33.571903 => 07:43:33.605074
[0m07:43:33.611109 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m07:43:33.612673 [debug] [Thread-2  ]: Began executing node model.traffic_data.trajectory_summary
[0m07:43:33.614954 [debug] [Thread-1  ]: Timing info for model.traffic_data.merged_id (compile): 07:43:33.557854 => 07:43:33.613916
[0m07:43:33.625955 [debug] [Thread-1  ]: Began executing node model.traffic_data.merged_id
[0m07:43:33.643573 [debug] [Thread-3  ]: Timing info for model.traffic_data.vehicle_type (compile): 07:43:33.597813 => 07:43:33.642501
[0m07:43:33.668228 [debug] [Thread-3  ]: Began executing node model.traffic_data.vehicle_type
[0m07:43:33.893433 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m07:43:33.896153 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:43:33.898096 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m07:43:33.900175 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:43:33.994569 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m07:43:34.006509 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m07:43:34.008712 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:43:34.011140 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m07:43:34.014115 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVERAGE(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m07:43:34.022785 [debug] [Thread-2  ]: Postgres adapter: Postgres error: function average(double precision) does not exist
LINE 13:         AVERAGE(time) AS average_time
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m07:43:34.025082 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: ROLLBACK
[0m07:43:34.029186 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (execute): 07:43:33.616309 => 07:43:34.028011
[0m07:43:34.031290 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: Close
[0m07:43:34.017062 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:43:34.045574 [debug] [Thread-1  ]: On model.traffic_data.merged_id: BEGIN
[0m07:43:34.047548 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:43:34.036752 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:43:34.055587 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: BEGIN
[0m07:43:34.057574 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:43:34.071804 [debug] [Thread-2  ]: Database Error in model trajectory_summary (models/trajectory_summary.sql)
  function average(double precision) does not exist
  LINE 13:         AVERAGE(time) AS average_time
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/traffic_data/models/trajectory_summary.sql
[0m07:43:34.079746 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5339d597-f685-4061-aeb8-f8fcf0a2b28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabc3c1f10>]}
[0m07:43:34.086154 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model traffic_schema.trajectory_summary ......... [[31mERROR[0m in 0.54s]
[0m07:43:34.096219 [debug] [Thread-2  ]: Finished running node model.traffic_data.trajectory_summary
[0m07:43:34.101399 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:43:34.105262 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:43:34.110106 [debug] [Thread-1  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT * FROM vehicles AS v
    JOIN trajectory AS t
    ON v.track_id = t.tracfk_id
)

SELECT * FROM merged_data
  );
  
[0m07:43:34.112264 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m07:43:34.115665 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:43:34.117871 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m07:43:34.127164 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column t.tracfk_id does not exist
LINE 17:     ON v.track_id = t.tracfk_id
                             ^
HINT:  Perhaps you meant to reference the column "t.track_id".

[0m07:43:34.130231 [debug] [Thread-1  ]: On model.traffic_data.merged_id: ROLLBACK
[0m07:43:34.134566 [debug] [Thread-1  ]: Timing info for model.traffic_data.merged_id (execute): 07:43:33.632117 => 07:43:34.132587
[0m07:43:34.137203 [debug] [Thread-1  ]: On model.traffic_data.merged_id: Close
[0m07:43:34.143384 [debug] [Thread-1  ]: Database Error in model merged_id (models/merged_id.sql)
  column t.tracfk_id does not exist
  LINE 17:     ON v.track_id = t.tracfk_id
                               ^
  HINT:  Perhaps you meant to reference the column "t.track_id".
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:43:34.155110 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5339d597-f685-4061-aeb8-f8fcf0a2b28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabc3cdcd0>]}
[0m07:43:34.164125 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model traffic_schema.merged_id ................. [[31mERROR[0m in 0.62s]
[0m07:43:34.168083 [debug] [Thread-1  ]: Finished running node model.traffic_data.merged_id
[0m07:43:34.307756 [debug] [Thread-3  ]: SQL status: SELECT 6 in 0.0 seconds
[0m07:43:34.325175 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:43:34.326491 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m07:43:34.328086 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:43:34.334587 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:43:34.335921 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m07:43:34.338564 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:43:34.383742 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:43:34.385098 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:43:34.386288 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:43:34.534142 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m07:43:34.566620 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m07:43:34.597279 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:43:34.599005 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m07:43:34.633830 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m07:43:34.637181 [debug] [Thread-3  ]: Timing info for model.traffic_data.vehicle_type (execute): 07:43:33.674598 => 07:43:34.636544
[0m07:43:34.639036 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: Close
[0m07:43:34.641512 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5339d597-f685-4061-aeb8-f8fcf0a2b28f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabd42b400>]}
[0m07:43:34.643631 [info ] [Thread-3  ]: 3 of 3 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 1.09s]
[0m07:43:34.645212 [debug] [Thread-3  ]: Finished running node model.traffic_data.vehicle_type
[0m07:43:34.647844 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.648860 [debug] [MainThread]: On master: BEGIN
[0m07:43:34.649943 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:34.668070 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:43:34.669246 [debug] [MainThread]: On master: COMMIT
[0m07:43:34.670299 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:34.671333 [debug] [MainThread]: On master: COMMIT
[0m07:43:34.672463 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:43:34.673501 [debug] [MainThread]: On master: Close
[0m07:43:34.675197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:34.676891 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m07:43:34.678300 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m07:43:34.679415 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m07:43:34.680856 [info ] [MainThread]: 
[0m07:43:34.682120 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m07:43:34.684787 [debug] [MainThread]: Command end result
[0m07:43:34.699232 [info ] [MainThread]: 
[0m07:43:34.700551 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:43:34.701662 [info ] [MainThread]: 
[0m07:43:34.703120 [error] [MainThread]:   Database Error in model trajectory_summary (models/trajectory_summary.sql)
  function average(double precision) does not exist
  LINE 13:         AVERAGE(time) AS average_time
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/traffic_data/models/trajectory_summary.sql
[0m07:43:34.704226 [info ] [MainThread]: 
[0m07:43:34.705314 [error] [MainThread]:   Database Error in model merged_id (models/merged_id.sql)
  column t.tracfk_id does not exist
  LINE 17:     ON v.track_id = t.tracfk_id
                               ^
  HINT:  Perhaps you meant to reference the column "t.track_id".
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:43:34.706840 [info ] [MainThread]: 
[0m07:43:34.708027 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m07:43:34.709826 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6498806, "process_user_time": 6.695985, "process_kernel_time": 0.251698, "process_mem_max_rss": "108360", "process_out_blocks": "2416", "command_success": false, "process_in_blocks": "0"}
[0m07:43:34.711926 [debug] [MainThread]: Command `dbt run` failed at 07:43:34.711312 after 2.65 seconds
[0m07:43:34.713119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac1be6b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabe757100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabe7e1910>]}
[0m07:43:34.714264 [debug] [MainThread]: Flushing usage events
[0m07:47:02.949657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe472fcdc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe471582bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe471582b50>]}


============================== 07:47:02.955526 | b3d558e6-026b-4a99-b727-4344fa062227 ==============================
[0m07:47:02.955526 [info ] [MainThread]: Running with dbt=1.7.13
[0m07:47:02.956896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:47:03.328076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3d558e6-026b-4a99-b727-4344fa062227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe471582670>]}
[0m07:47:03.567385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3d558e6-026b-4a99-b727-4344fa062227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe473710d90>]}
[0m07:47:03.568953 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m07:47:03.589644 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m07:47:03.666130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:47:03.667560 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/merged_id.sql
[0m07:47:03.954341 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m07:47:03.966076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3d558e6-026b-4a99-b727-4344fa062227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46f29db20>]}
[0m07:47:03.991440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3d558e6-026b-4a99-b727-4344fa062227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46fa80190>]}
[0m07:47:03.994831 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:47:03.997435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d558e6-026b-4a99-b727-4344fa062227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46fc86ac0>]}
[0m07:47:04.003164 [info ] [MainThread]: 
[0m07:47:04.006578 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:47:04.012434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m07:47:04.050483 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m07:47:04.052026 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m07:47:04.052932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:47:04.083375 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m07:47:04.086598 [debug] [ThreadPool]: On list_traffic: Close
[0m07:47:04.093346 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m07:47:04.112519 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:47:04.114360 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m07:47:04.115299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:47:04.133078 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:47:04.134536 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:47:04.135689 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m07:47:04.141778 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:47:04.144741 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m07:47:04.146123 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m07:47:04.160723 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:04.161952 [debug] [MainThread]: On master: BEGIN
[0m07:47:04.163244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:47:04.186529 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:47:04.187706 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:04.188860 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:47:04.197795 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m07:47:04.202326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d558e6-026b-4a99-b727-4344fa062227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46f23c6a0>]}
[0m07:47:04.204092 [debug] [MainThread]: On master: ROLLBACK
[0m07:47:04.205890 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:04.207246 [debug] [MainThread]: On master: BEGIN
[0m07:47:04.209638 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:47:04.211666 [debug] [MainThread]: On master: COMMIT
[0m07:47:04.213478 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:04.215467 [debug] [MainThread]: On master: COMMIT
[0m07:47:04.217366 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:47:04.218700 [debug] [MainThread]: On master: Close
[0m07:47:04.220464 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:47:04.221654 [info ] [MainThread]: 
[0m07:47:04.227653 [debug] [Thread-1  ]: Began running node model.traffic_data.merged_id
[0m07:47:04.229869 [debug] [Thread-2  ]: Began running node model.traffic_data.trajectory_summary
[0m07:47:04.231927 [debug] [Thread-3  ]: Began running node model.traffic_data.vehicle_type
[0m07:47:04.234135 [info ] [Thread-1  ]: 1 of 3 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m07:47:04.236702 [info ] [Thread-2  ]: 2 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m07:47:04.248670 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.trajectory_summary'
[0m07:47:04.244928 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.merged_id)
[0m07:47:04.251227 [debug] [Thread-2  ]: Began compiling node model.traffic_data.trajectory_summary
[0m07:47:04.238536 [info ] [Thread-3  ]: 3 of 3 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m07:47:04.253671 [debug] [Thread-1  ]: Began compiling node model.traffic_data.merged_id
[0m07:47:04.272357 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m07:47:04.286429 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m07:47:04.299017 [debug] [Thread-3  ]: Began compiling node model.traffic_data.vehicle_type
[0m07:47:04.302990 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m07:47:04.313177 [debug] [Thread-1  ]: Timing info for model.traffic_data.merged_id (compile): 07:47:04.287252 => 07:47:04.311433
[0m07:47:04.320248 [debug] [Thread-1  ]: Began executing node model.traffic_data.merged_id
[0m07:47:04.318696 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m07:47:04.345048 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (compile): 07:47:04.254626 => 07:47:04.344092
[0m07:47:04.351555 [debug] [Thread-2  ]: Began executing node model.traffic_data.trajectory_summary
[0m07:47:04.363831 [debug] [Thread-3  ]: Timing info for model.traffic_data.vehicle_type (compile): 07:47:04.304286 => 07:47:04.363061
[0m07:47:04.375835 [debug] [Thread-3  ]: Began executing node model.traffic_data.vehicle_type
[0m07:47:04.542326 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m07:47:04.571339 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m07:47:04.573175 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:47:04.576447 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m07:47:04.579345 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m07:47:04.581394 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:47:04.583573 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:47:04.585928 [debug] [Thread-1  ]: On model.traffic_data.merged_id: BEGIN
[0m07:47:04.588180 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:47:04.590222 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:47:04.593058 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: BEGIN
[0m07:47:04.595697 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:47:04.610794 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m07:47:04.612241 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:47:04.613515 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVERAGE(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m07:47:04.616178 [debug] [Thread-2  ]: Postgres adapter: Postgres error: function average(double precision) does not exist
LINE 13:         AVERAGE(time) AS average_time
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m07:47:04.617556 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: ROLLBACK
[0m07:47:04.619440 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (execute): 07:47:04.357840 => 07:47:04.618790
[0m07:47:04.621390 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: Close
[0m07:47:04.625106 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:47:04.627742 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m07:47:04.629472 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:47:04.631096 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:47:04.632819 [debug] [Thread-1  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT * FROM vehicles AS v
    JOIN trajectory AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m07:47:04.634536 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m07:47:04.638919 [debug] [Thread-2  ]: Database Error in model trajectory_summary (models/trajectory_summary.sql)
  function average(double precision) does not exist
  LINE 13:         AVERAGE(time) AS average_time
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/traffic_data/models/trajectory_summary.sql
[0m07:47:04.640697 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d558e6-026b-4a99-b727-4344fa062227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46c154bb0>]}
[0m07:47:04.644075 [error] [Thread-2  ]: 2 of 3 ERROR creating sql view model traffic_schema.trajectory_summary ......... [[31mERROR[0m in 0.39s]
[0m07:47:04.646616 [debug] [Thread-2  ]: Finished running node model.traffic_data.trajectory_summary
[0m07:47:04.655468 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "track_id" specified more than once

[0m07:47:04.657294 [debug] [Thread-1  ]: On model.traffic_data.merged_id: ROLLBACK
[0m07:47:04.661758 [debug] [Thread-1  ]: Timing info for model.traffic_data.merged_id (execute): 07:47:04.321300 => 07:47:04.660491
[0m07:47:04.664618 [debug] [Thread-1  ]: On model.traffic_data.merged_id: Close
[0m07:47:04.669550 [debug] [Thread-1  ]: Database Error in model merged_id (models/merged_id.sql)
  column "track_id" specified more than once
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:47:04.671020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d558e6-026b-4a99-b727-4344fa062227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46c1abd30>]}
[0m07:47:04.672477 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model traffic_schema.merged_id ................. [[31mERROR[0m in 0.43s]
[0m07:47:04.674617 [debug] [Thread-1  ]: Finished running node model.traffic_data.merged_id
[0m07:47:04.751392 [debug] [Thread-3  ]: SQL status: SELECT 6 in 0.0 seconds
[0m07:47:04.772795 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:47:04.774209 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m07:47:04.776934 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:47:04.783610 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:47:04.784859 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m07:47:04.786566 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:47:04.833556 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:47:04.834770 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:47:04.835771 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:47:04.849520 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m07:47:04.867704 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m07:47:04.878232 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:47:04.879619 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m07:47:04.894874 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m07:47:04.898542 [debug] [Thread-3  ]: Timing info for model.traffic_data.vehicle_type (execute): 07:47:04.377607 => 07:47:04.897905
[0m07:47:04.899890 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: Close
[0m07:47:04.901989 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d558e6-026b-4a99-b727-4344fa062227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46e9f8e80>]}
[0m07:47:04.903898 [info ] [Thread-3  ]: 3 of 3 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 0.63s]
[0m07:47:04.905702 [debug] [Thread-3  ]: Finished running node model.traffic_data.vehicle_type
[0m07:47:04.910417 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:04.912461 [debug] [MainThread]: On master: BEGIN
[0m07:47:04.914572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:47:04.938483 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:47:04.939814 [debug] [MainThread]: On master: COMMIT
[0m07:47:04.941008 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:04.942525 [debug] [MainThread]: On master: COMMIT
[0m07:47:04.946034 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:47:04.948204 [debug] [MainThread]: On master: Close
[0m07:47:04.951725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:47:04.953337 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m07:47:04.954844 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m07:47:04.955906 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m07:47:04.957318 [info ] [MainThread]: 
[0m07:47:04.959524 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m07:47:04.963854 [debug] [MainThread]: Command end result
[0m07:47:04.989546 [info ] [MainThread]: 
[0m07:47:04.990707 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:47:04.991834 [info ] [MainThread]: 
[0m07:47:04.994280 [error] [MainThread]:   Database Error in model trajectory_summary (models/trajectory_summary.sql)
  function average(double precision) does not exist
  LINE 13:         AVERAGE(time) AS average_time
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/traffic_data/models/trajectory_summary.sql
[0m07:47:04.996881 [info ] [MainThread]: 
[0m07:47:04.999562 [error] [MainThread]:   Database Error in model merged_id (models/merged_id.sql)
  column "track_id" specified more than once
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:47:05.001455 [info ] [MainThread]: 
[0m07:47:05.004822 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m07:47:05.007104 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1657648, "process_user_time": 6.143475, "process_kernel_time": 0.215141, "process_mem_max_rss": "108500", "process_out_blocks": "2416", "command_success": false, "process_in_blocks": "0"}
[0m07:47:05.008655 [debug] [MainThread]: Command `dbt run` failed at 07:47:05.008180 after 2.17 seconds
[0m07:47:05.011396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe472fcdc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe46fc86ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe471582670>]}
[0m07:47:05.013538 [debug] [MainThread]: Flushing usage events
[0m07:47:46.349940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61893fab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61879a83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61879a8af0>]}


============================== 07:47:46.355611 | 0244fdc1-6a3c-447b-841c-319f783c838b ==============================
[0m07:47:46.355611 [info ] [MainThread]: Running with dbt=1.7.13
[0m07:47:46.357141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'version_check': 'True', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:47:46.712918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0244fdc1-6a3c-447b-841c-319f783c838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61879a83a0>]}
[0m07:47:46.912841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0244fdc1-6a3c-447b-841c-319f783c838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61879414c0>]}
[0m07:47:46.914498 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m07:47:46.942730 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m07:47:47.014660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:47:47.016094 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/trajectory_summary.sql
[0m07:47:47.296567 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m07:47:47.310701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0244fdc1-6a3c-447b-841c-319f783c838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61856cba60>]}
[0m07:47:47.334382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0244fdc1-6a3c-447b-841c-319f783c838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6185ed2940>]}
[0m07:47:47.337552 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:47:47.339864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0244fdc1-6a3c-447b-841c-319f783c838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6185de3100>]}
[0m07:47:47.345766 [info ] [MainThread]: 
[0m07:47:47.347829 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:47:47.352120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m07:47:47.394225 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m07:47:47.395462 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m07:47:47.396622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:47:47.427762 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m07:47:47.431053 [debug] [ThreadPool]: On list_traffic: Close
[0m07:47:47.438167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m07:47:47.461147 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:47:47.462633 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m07:47:47.463997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:47:47.489009 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:47:47.490896 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:47:47.493088 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m07:47:47.499954 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:47:47.504821 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m07:47:47.506920 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m07:47:47.524826 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:47.526081 [debug] [MainThread]: On master: BEGIN
[0m07:47:47.527285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:47:47.551733 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:47:47.553792 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:47.555996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:47:47.567392 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m07:47:47.573280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0244fdc1-6a3c-447b-841c-319f783c838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61856cba90>]}
[0m07:47:47.575190 [debug] [MainThread]: On master: ROLLBACK
[0m07:47:47.577103 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:47.578551 [debug] [MainThread]: On master: BEGIN
[0m07:47:47.580284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:47:47.581313 [debug] [MainThread]: On master: COMMIT
[0m07:47:47.582245 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:47.583155 [debug] [MainThread]: On master: COMMIT
[0m07:47:47.584378 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:47:47.585500 [debug] [MainThread]: On master: Close
[0m07:47:47.588379 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:47:47.590143 [info ] [MainThread]: 
[0m07:47:47.594779 [debug] [Thread-1  ]: Began running node model.traffic_data.merged_id
[0m07:47:47.596696 [debug] [Thread-2  ]: Began running node model.traffic_data.trajectory_summary
[0m07:47:47.598826 [debug] [Thread-3  ]: Began running node model.traffic_data.vehicle_type
[0m07:47:47.600665 [info ] [Thread-1  ]: 1 of 3 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m07:47:47.603241 [info ] [Thread-2  ]: 2 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m07:47:47.606068 [info ] [Thread-3  ]: 3 of 3 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m07:47:47.611497 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.merged_id)
[0m07:47:47.616144 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.trajectory_summary'
[0m07:47:47.618824 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m07:47:47.623008 [debug] [Thread-1  ]: Began compiling node model.traffic_data.merged_id
[0m07:47:47.626424 [debug] [Thread-2  ]: Began compiling node model.traffic_data.trajectory_summary
[0m07:47:47.628002 [debug] [Thread-3  ]: Began compiling node model.traffic_data.vehicle_type
[0m07:47:47.666983 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m07:47:47.667923 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m07:47:47.672727 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m07:47:47.677287 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (compile): 07:47:47.641853 => 07:47:47.675912
[0m07:47:47.679217 [debug] [Thread-2  ]: Began executing node model.traffic_data.trajectory_summary
[0m07:47:47.688818 [debug] [Thread-3  ]: Timing info for model.traffic_data.vehicle_type (compile): 07:47:47.642669 => 07:47:47.686587
[0m07:47:47.700899 [debug] [Thread-3  ]: Began executing node model.traffic_data.vehicle_type
[0m07:47:47.703015 [debug] [Thread-1  ]: Timing info for model.traffic_data.merged_id (compile): 07:47:47.629171 => 07:47:47.702066
[0m07:47:47.741142 [debug] [Thread-1  ]: Began executing node model.traffic_data.merged_id
[0m07:47:47.931314 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m07:47:47.935626 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m07:47:47.944397 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m07:47:47.946730 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:47:47.948143 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:47:47.949498 [debug] [Thread-1  ]: On model.traffic_data.merged_id: BEGIN
[0m07:47:47.951321 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:47:47.952970 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: BEGIN
[0m07:47:47.955538 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:47:47.957632 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m07:47:47.959394 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:47:47.961539 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:47:47.984477 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:47:47.985847 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:47:47.989784 [debug] [Thread-1  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT * FROM vehicles AS v
    JOIN trajectory AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m07:47:47.991936 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m07:47:47.993266 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m07:47:47.994578 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "track_id" specified more than once

[0m07:47:47.995936 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:47:47.997486 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:47:47.999080 [debug] [Thread-1  ]: On model.traffic_data.merged_id: ROLLBACK
[0m07:47:48.000615 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVG(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m07:47:48.002770 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m07:47:48.007468 [debug] [Thread-1  ]: Timing info for model.traffic_data.merged_id (execute): 07:47:47.748182 => 07:47:48.005816
[0m07:47:48.010535 [debug] [Thread-1  ]: On model.traffic_data.merged_id: Close
[0m07:47:48.016737 [debug] [Thread-1  ]: Database Error in model merged_id (models/merged_id.sql)
  column "track_id" specified more than once
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:47:48.017964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0244fdc1-6a3c-447b-841c-319f783c838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6185692370>]}
[0m07:47:48.019373 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model traffic_schema.merged_id ................. [[31mERROR[0m in 0.41s]
[0m07:47:48.021785 [debug] [Thread-1  ]: Finished running node model.traffic_data.merged_id
[0m07:47:48.081024 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:47:48.098264 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:47:48.099414 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m07:47:48.101051 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:47:48.108563 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:47:48.109920 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m07:47:48.111951 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:47:48.132824 [debug] [Thread-3  ]: SQL status: SELECT 6 in 0.0 seconds
[0m07:47:48.166843 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:47:48.173798 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m07:47:48.171962 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m07:47:48.175823 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:47:48.177370 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:47:48.178806 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m07:47:48.187465 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:47:48.189902 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m07:47:48.192721 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:47:48.207410 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:47:48.208952 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m07:47:48.210662 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:47:48.222681 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:47:48.228759 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m07:47:48.240203 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:47:48.241484 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m07:47:48.242852 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m07:47:48.252082 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m07:47:48.253641 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
[0m07:47:48.263417 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:47:48.268414 [debug] [Thread-2  ]: Timing info for model.traffic_data.trajectory_summary (execute): 07:47:47.681369 => 07:47:48.267571
[0m07:47:48.270335 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m07:47:48.273825 [debug] [Thread-2  ]: On model.traffic_data.trajectory_summary: Close
[0m07:47:48.277547 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0244fdc1-6a3c-447b-841c-319f783c838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61856912e0>]}
[0m07:47:48.280760 [info ] [Thread-2  ]: 2 of 3 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.66s]
[0m07:47:48.283101 [debug] [Thread-2  ]: Finished running node model.traffic_data.trajectory_summary
[0m07:47:48.286841 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m07:47:48.293604 [debug] [Thread-3  ]: Timing info for model.traffic_data.vehicle_type (execute): 07:47:47.712322 => 07:47:48.292547
[0m07:47:48.295638 [debug] [Thread-3  ]: On model.traffic_data.vehicle_type: Close
[0m07:47:48.298541 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0244fdc1-6a3c-447b-841c-319f783c838b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61845da9d0>]}
[0m07:47:48.301013 [info ] [Thread-3  ]: 3 of 3 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 0.68s]
[0m07:47:48.303566 [debug] [Thread-3  ]: Finished running node model.traffic_data.vehicle_type
[0m07:47:48.311367 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:48.313526 [debug] [MainThread]: On master: BEGIN
[0m07:47:48.315970 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:47:48.343982 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:47:48.346285 [debug] [MainThread]: On master: COMMIT
[0m07:47:48.348075 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:48.349702 [debug] [MainThread]: On master: COMMIT
[0m07:47:48.351551 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:47:48.352812 [debug] [MainThread]: On master: Close
[0m07:47:48.357615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:47:48.361028 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m07:47:48.363490 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m07:47:48.365264 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m07:47:48.367108 [info ] [MainThread]: 
[0m07:47:48.368332 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m07:47:48.370822 [debug] [MainThread]: Command end result
[0m07:47:48.400345 [info ] [MainThread]: 
[0m07:47:48.401673 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:47:48.402803 [info ] [MainThread]: 
[0m07:47:48.403883 [error] [MainThread]:   Database Error in model merged_id (models/merged_id.sql)
  column "track_id" specified more than once
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:47:48.405074 [info ] [MainThread]: 
[0m07:47:48.407651 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:47:48.410862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1619868, "process_user_time": 5.928654, "process_kernel_time": 0.227871, "process_mem_max_rss": "109036", "process_out_blocks": "2416", "command_success": false, "process_in_blocks": "0"}
[0m07:47:48.413831 [debug] [MainThread]: Command `dbt run` failed at 07:47:48.413070 after 2.16 seconds
[0m07:47:48.416394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61893fab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61879414c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6185ff7820>]}
[0m07:47:48.418549 [debug] [MainThread]: Flushing usage events
[0m07:50:07.016330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ce16cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cc724460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cc724b80>]}


============================== 07:50:07.021335 | fee05f34-e58b-4e77-9ab0-c4754cefe455 ==============================
[0m07:50:07.021335 [info ] [MainThread]: Running with dbt=1.7.13
[0m07:50:07.022669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:50:07.382646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fee05f34-e58b-4e77-9ab0-c4754cefe455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cf9dfdc0>]}
[0m07:50:07.571509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fee05f34-e58b-4e77-9ab0-c4754cefe455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07caebc490>]}
[0m07:50:07.573083 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m07:50:07.595584 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m07:50:07.666407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:50:07.668088 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/merged_id.sql
[0m07:50:07.946589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m07:50:07.958921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fee05f34-e58b-4e77-9ab0-c4754cefe455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ca23cb50>]}
[0m07:50:07.985680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fee05f34-e58b-4e77-9ab0-c4754cefe455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cab55070>]}
[0m07:50:07.987014 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:50:07.988153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fee05f34-e58b-4e77-9ab0-c4754cefe455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07cad40c10>]}
[0m07:50:07.992573 [info ] [MainThread]: 
[0m07:50:07.995156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:50:08.003024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m07:50:08.040434 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m07:50:08.041932 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m07:50:08.043549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:50:08.073861 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m07:50:08.076848 [debug] [ThreadPool]: On list_traffic: Close
[0m07:50:08.084760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m07:50:08.099065 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:50:08.100234 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m07:50:08.101231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:50:08.123474 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:50:08.124813 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:50:08.126042 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m07:50:08.134269 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:50:08.137189 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m07:50:08.138690 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m07:50:08.154482 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:08.155537 [debug] [MainThread]: On master: BEGIN
[0m07:50:08.156423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:50:08.181043 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:50:08.183232 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:08.184879 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:50:08.194330 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m07:50:08.198270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fee05f34-e58b-4e77-9ab0-c4754cefe455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ca23cd00>]}
[0m07:50:08.199625 [debug] [MainThread]: On master: ROLLBACK
[0m07:50:08.201148 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:08.202986 [debug] [MainThread]: On master: BEGIN
[0m07:50:08.205032 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:50:08.206291 [debug] [MainThread]: On master: COMMIT
[0m07:50:08.207660 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:08.209119 [debug] [MainThread]: On master: COMMIT
[0m07:50:08.210895 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:50:08.212014 [debug] [MainThread]: On master: Close
[0m07:50:08.215358 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:50:08.217772 [info ] [MainThread]: 
[0m07:50:08.223520 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m07:50:08.225551 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m07:50:08.227639 [info ] [Thread-1  ]: 1 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m07:50:08.234128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m07:50:08.237208 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m07:50:08.230517 [info ] [Thread-2  ]: 2 of 3 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m07:50:08.250036 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m07:50:08.253618 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m07:50:08.276884 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m07:50:08.280766 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m07:50:08.288454 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 07:50:08.238920 => 07:50:08.286488
[0m07:50:08.290127 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 07:50:08.259800 => 07:50:08.289439
[0m07:50:08.291418 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m07:50:08.292692 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m07:50:08.482368 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m07:50:08.494031 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m07:50:08.496501 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:50:08.499048 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m07:50:08.500725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:50:08.503418 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:50:08.505051 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m07:50:08.506256 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:50:08.526863 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:50:08.528871 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:50:08.530573 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVG(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m07:50:08.533682 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m07:50:08.535127 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:50:08.536658 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:50:08.538443 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m07:50:08.554562 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:50:08.556173 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m07:50:08.558132 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:50:08.566742 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:50:08.567967 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m07:50:08.569777 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:50:08.604907 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m07:50:08.606073 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:50:08.607121 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m07:50:08.626031 [debug] [Thread-2  ]: SQL status: SELECT 6 in 0.0 seconds
[0m07:50:08.635984 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m07:50:08.639143 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:50:08.651162 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m07:50:08.660857 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m07:50:08.662604 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:50:08.689542 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:50:08.684873 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:50:08.691593 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m07:50:08.693311 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m07:50:08.695649 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:50:08.713239 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m07:50:08.714788 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:50:08.719079 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 07:50:08.293622 => 07:50:08.718310
[0m07:50:08.721012 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:50:08.722909 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m07:50:08.724807 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:50:08.728327 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fee05f34-e58b-4e77-9ab0-c4754cefe455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ca23cc10>]}
[0m07:50:08.730693 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m07:50:08.733338 [info ] [Thread-1  ]: 1 of 3 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.49s]
[0m07:50:08.742961 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m07:50:08.745805 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m07:50:08.758929 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:50:08.760979 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m07:50:08.763105 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m07:50:08.766150 [info ] [Thread-3  ]: 3 of 3 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m07:50:08.773749 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m07:50:08.775575 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m07:50:08.778108 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m07:50:08.791311 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 07:50:08.300343 => 07:50:08.790568
[0m07:50:08.798045 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m07:50:08.805543 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fee05f34-e58b-4e77-9ab0-c4754cefe455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07caaff790>]}
[0m07:50:08.796856 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m07:50:08.809660 [info ] [Thread-2  ]: 2 of 3 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 0.56s]
[0m07:50:08.812782 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m07:50:08.815584 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 07:50:08.779037 => 07:50:08.814423
[0m07:50:08.823270 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m07:50:08.842342 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m07:50:08.844509 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:50:08.845729 [debug] [Thread-3  ]: On model.traffic_data.merged_id: BEGIN
[0m07:50:08.846792 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:50:08.872661 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m07:50:08.875003 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:50:08.876240 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT * FROM vehicles AS v
    JOIN "traffic"."traffic_schema"."trajectory_summary" AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m07:50:08.880523 [debug] [Thread-3  ]: Postgres adapter: Postgres error: column "track_id" specified more than once

[0m07:50:08.882010 [debug] [Thread-3  ]: On model.traffic_data.merged_id: ROLLBACK
[0m07:50:08.886566 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 07:50:08.824268 => 07:50:08.884985
[0m07:50:08.890236 [debug] [Thread-3  ]: On model.traffic_data.merged_id: Close
[0m07:50:08.895892 [debug] [Thread-3  ]: Database Error in model merged_id (models/merged_id.sql)
  column "track_id" specified more than once
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:50:08.897212 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fee05f34-e58b-4e77-9ab0-c4754cefe455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07c80e7be0>]}
[0m07:50:08.899330 [error] [Thread-3  ]: 3 of 3 ERROR creating sql table model traffic_schema.merged_id ................. [[31mERROR[0m in 0.12s]
[0m07:50:08.903126 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m07:50:08.906668 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:08.907967 [debug] [MainThread]: On master: BEGIN
[0m07:50:08.909986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:50:08.942321 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:50:08.944610 [debug] [MainThread]: On master: COMMIT
[0m07:50:08.946958 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:08.948862 [debug] [MainThread]: On master: COMMIT
[0m07:50:08.953085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:50:08.956053 [debug] [MainThread]: On master: Close
[0m07:50:08.961875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:50:08.963130 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m07:50:08.964196 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m07:50:08.965856 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m07:50:08.969101 [info ] [MainThread]: 
[0m07:50:08.972081 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m07:50:08.976592 [debug] [MainThread]: Command end result
[0m07:50:09.000027 [info ] [MainThread]: 
[0m07:50:09.003180 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:50:09.007074 [info ] [MainThread]: 
[0m07:50:09.009772 [error] [MainThread]:   Database Error in model merged_id (models/merged_id.sql)
  column "track_id" specified more than once
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:50:09.012382 [info ] [MainThread]: 
[0m07:50:09.019468 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:50:09.026380 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.120028, "process_user_time": 5.995846, "process_kernel_time": 0.227842, "process_mem_max_rss": "109108", "process_out_blocks": "2416", "command_success": false, "process_in_blocks": "0"}
[0m07:50:09.029538 [debug] [MainThread]: Command `dbt run` failed at 07:50:09.028792 after 2.12 seconds
[0m07:50:09.031946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ce16cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07caebc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ca236550>]}
[0m07:50:09.035127 [debug] [MainThread]: Flushing usage events
[0m07:51:24.956560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc01ccc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbe783430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbe783b50>]}


============================== 07:51:24.961442 | 1a4e0fa5-90a6-44a3-a6a3-115c4a84699d ==============================
[0m07:51:24.961442 [info ] [MainThread]: Running with dbt=1.7.13
[0m07:51:24.962732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:51:25.335638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a4e0fa5-90a6-44a3-a6a3-115c4a84699d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc1a3fd90>]}
[0m07:51:25.532147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a4e0fa5-90a6-44a3-a6a3-115c4a84699d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc0910d90>]}
[0m07:51:25.533720 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m07:51:25.559263 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m07:51:25.624999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:51:25.626315 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:51:25.627845 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m07:51:25.641801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a4e0fa5-90a6-44a3-a6a3-115c4a84699d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbcbce160>]}
[0m07:51:25.669139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a4e0fa5-90a6-44a3-a6a3-115c4a84699d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbcc7f190>]}
[0m07:51:25.671645 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:51:25.674706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a4e0fa5-90a6-44a3-a6a3-115c4a84699d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbcc2ce20>]}
[0m07:51:25.681919 [info ] [MainThread]: 
[0m07:51:25.684541 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:51:25.690820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m07:51:25.724123 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m07:51:25.727112 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m07:51:25.729470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:25.771018 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m07:51:25.775952 [debug] [ThreadPool]: On list_traffic: Close
[0m07:51:25.780977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m07:51:25.796983 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:51:25.798051 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m07:51:25.798997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:51:25.836076 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:51:25.837305 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:51:25.838948 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m07:51:25.845267 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:51:25.848601 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m07:51:25.850293 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m07:51:25.865464 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:25.866745 [debug] [MainThread]: On master: BEGIN
[0m07:51:25.867839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:51:25.889585 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:51:25.891300 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:25.892830 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:51:25.903399 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m07:51:25.908254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a4e0fa5-90a6-44a3-a6a3-115c4a84699d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbcb9a1f0>]}
[0m07:51:25.910432 [debug] [MainThread]: On master: ROLLBACK
[0m07:51:25.912924 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:25.914742 [debug] [MainThread]: On master: BEGIN
[0m07:51:25.917510 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:51:25.918929 [debug] [MainThread]: On master: COMMIT
[0m07:51:25.920524 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:25.922346 [debug] [MainThread]: On master: COMMIT
[0m07:51:25.924776 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:51:25.926224 [debug] [MainThread]: On master: Close
[0m07:51:25.929638 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:51:25.931582 [info ] [MainThread]: 
[0m07:51:25.935850 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m07:51:25.937950 [info ] [Thread-1  ]: 1 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m07:51:25.941378 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m07:51:25.943770 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m07:51:25.947398 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m07:51:25.951521 [info ] [Thread-2  ]: 2 of 3 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m07:51:25.967805 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m07:51:25.975418 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m07:51:25.999226 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m07:51:26.003391 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m07:51:26.011245 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 07:51:25.952900 => 07:51:26.005934
[0m07:51:26.015406 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m07:51:26.026620 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 07:51:25.982230 => 07:51:26.022432
[0m07:51:26.041673 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m07:51:26.210750 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m07:51:26.223948 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:51:26.226589 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m07:51:26.228306 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m07:51:26.230085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:51:26.232292 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:51:26.233773 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m07:51:26.235046 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:51:26.249936 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:51:26.251136 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:51:26.252234 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVG(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m07:51:26.253964 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m07:51:26.255177 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:51:26.257389 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:51:26.259427 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m07:51:26.278235 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:51:26.279587 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m07:51:26.281732 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:26.288249 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:51:26.289360 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m07:51:26.291843 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:26.328301 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m07:51:26.329826 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:51:26.331161 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m07:51:26.393322 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m07:51:26.412756 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m07:51:26.422679 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:51:26.424681 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m07:51:26.493169 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m07:51:26.496661 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 07:51:26.016595 => 07:51:26.496070
[0m07:51:26.497983 [debug] [Thread-2  ]: SQL status: SELECT 6 in 0.0 seconds
[0m07:51:26.499883 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m07:51:26.507585 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:51:26.509366 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m07:51:26.511543 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a4e0fa5-90a6-44a3-a6a3-115c4a84699d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbc2ff190>]}
[0m07:51:26.513379 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:26.515120 [info ] [Thread-1  ]: 1 of 3 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.57s]
[0m07:51:26.523360 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:51:26.526672 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m07:51:26.528405 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m07:51:26.531210 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m07:51:26.533519 [info ] [Thread-3  ]: 3 of 3 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m07:51:26.535223 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:51:26.537458 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m07:51:26.546621 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m07:51:26.569280 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:51:26.576425 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:51:26.580145 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:51:26.582514 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m07:51:26.584699 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 07:51:26.560043 => 07:51:26.583918
[0m07:51:26.586045 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m07:51:26.601437 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m07:51:26.603601 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:51:26.604760 [debug] [Thread-3  ]: On model.traffic_data.merged_id: BEGIN
[0m07:51:26.606118 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:51:26.626924 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m07:51:26.628237 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:51:26.629446 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT * FROM vehicles AS v
    JOIN "traffic"."traffic_schema"."trajectory_summary" AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m07:51:26.634067 [debug] [Thread-3  ]: Postgres adapter: Postgres error: column "track_id" specified more than once

[0m07:51:26.635315 [debug] [Thread-3  ]: On model.traffic_data.merged_id: ROLLBACK
[0m07:51:26.636994 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 07:51:26.586896 => 07:51:26.636373
[0m07:51:26.638072 [debug] [Thread-3  ]: On model.traffic_data.merged_id: Close
[0m07:51:26.644643 [debug] [Thread-3  ]: Database Error in model merged_id (models/merged_id.sql)
  column "track_id" specified more than once
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:51:26.646001 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a4e0fa5-90a6-44a3-a6a3-115c4a84699d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbc23e790>]}
[0m07:51:26.647600 [error] [Thread-3  ]: 3 of 3 ERROR creating sql table model traffic_schema.merged_id ................. [[31mERROR[0m in 0.11s]
[0m07:51:26.649461 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m07:51:26.685258 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m07:51:26.699894 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m07:51:26.706435 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:51:26.708361 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m07:51:26.727339 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m07:51:26.734151 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 07:51:26.043356 => 07:51:26.733116
[0m07:51:26.735508 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m07:51:26.737381 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a4e0fa5-90a6-44a3-a6a3-115c4a84699d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbc2f6af0>]}
[0m07:51:26.739138 [info ] [Thread-2  ]: 2 of 3 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 0.77s]
[0m07:51:26.741897 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m07:51:26.745402 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:26.747432 [debug] [MainThread]: On master: BEGIN
[0m07:51:26.749128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:51:26.772883 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:51:26.775125 [debug] [MainThread]: On master: COMMIT
[0m07:51:26.777982 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:26.780329 [debug] [MainThread]: On master: COMMIT
[0m07:51:26.783194 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:51:26.785145 [debug] [MainThread]: On master: Close
[0m07:51:26.788471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:51:26.790524 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m07:51:26.793880 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m07:51:26.795694 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m07:51:26.796902 [info ] [MainThread]: 
[0m07:51:26.798017 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m07:51:26.800294 [debug] [MainThread]: Command end result
[0m07:51:26.818793 [info ] [MainThread]: 
[0m07:51:26.819906 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:51:26.820840 [info ] [MainThread]: 
[0m07:51:26.821773 [error] [MainThread]:   Database Error in model merged_id (models/merged_id.sql)
  column "track_id" specified more than once
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:51:26.822734 [info ] [MainThread]: 
[0m07:51:26.824044 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:51:26.828233 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9797403, "process_user_time": 5.744239, "process_kernel_time": 0.21511, "process_mem_max_rss": "105796", "process_out_blocks": "1640", "command_success": false, "process_in_blocks": "0"}
[0m07:51:26.832454 [debug] [MainThread]: Command `dbt run` failed at 07:51:26.831325 after 1.98 seconds
[0m07:51:26.835449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cc01ccc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbc297190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cbcd2f160>]}
[0m07:51:26.837121 [debug] [MainThread]: Flushing usage events
[0m07:54:09.259239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bc0dec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ba693460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ba693b80>]}


============================== 07:54:09.264125 | 5e27712a-5ab5-4757-a6a3-4aacc2a200e0 ==============================
[0m07:54:09.264125 [info ] [MainThread]: Running with dbt=1.7.13
[0m07:54:09.265549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'debug': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:54:09.637493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e27712a-5ab5-4757-a6a3-4aacc2a200e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bd950dc0>]}
[0m07:54:09.846628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e27712a-5ab5-4757-a6a3-4aacc2a200e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b8e2d490>]}
[0m07:54:09.848282 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m07:54:09.872226 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m07:54:09.946174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:54:09.947626 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/merged_id.sql
[0m07:54:10.218526 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m07:54:10.230491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e27712a-5ab5-4757-a6a3-4aacc2a200e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b83b0b50>]}
[0m07:54:10.254246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e27712a-5ab5-4757-a6a3-4aacc2a200e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b8b910d0>]}
[0m07:54:10.258034 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:54:10.260278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e27712a-5ab5-4757-a6a3-4aacc2a200e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b8c43190>]}
[0m07:54:10.265507 [info ] [MainThread]: 
[0m07:54:10.268424 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:54:10.273802 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m07:54:10.313782 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m07:54:10.315332 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m07:54:10.316494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:54:10.347583 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m07:54:10.350309 [debug] [ThreadPool]: On list_traffic: Close
[0m07:54:10.354788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m07:54:10.374318 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:54:10.375922 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m07:54:10.377657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:54:10.403487 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:54:10.405695 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m07:54:10.407645 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m07:54:10.416201 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:54:10.419495 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m07:54:10.422279 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m07:54:10.433886 [debug] [MainThread]: Using postgres connection "master"
[0m07:54:10.435124 [debug] [MainThread]: On master: BEGIN
[0m07:54:10.436128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:54:10.458316 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:54:10.459708 [debug] [MainThread]: Using postgres connection "master"
[0m07:54:10.461074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:54:10.471574 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m07:54:10.477787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e27712a-5ab5-4757-a6a3-4aacc2a200e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b83b0d00>]}
[0m07:54:10.480094 [debug] [MainThread]: On master: ROLLBACK
[0m07:54:10.482257 [debug] [MainThread]: Using postgres connection "master"
[0m07:54:10.483433 [debug] [MainThread]: On master: BEGIN
[0m07:54:10.485109 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:54:10.486319 [debug] [MainThread]: On master: COMMIT
[0m07:54:10.487465 [debug] [MainThread]: Using postgres connection "master"
[0m07:54:10.488902 [debug] [MainThread]: On master: COMMIT
[0m07:54:10.490642 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:54:10.491995 [debug] [MainThread]: On master: Close
[0m07:54:10.493970 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m07:54:10.495693 [info ] [MainThread]: 
[0m07:54:10.501518 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m07:54:10.503742 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m07:54:10.506863 [info ] [Thread-1  ]: 1 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m07:54:10.509033 [info ] [Thread-2  ]: 2 of 3 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m07:54:10.511711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m07:54:10.515439 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m07:54:10.518773 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m07:54:10.520548 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m07:54:10.546645 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m07:54:10.556391 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m07:54:10.562422 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 07:54:10.534104 => 07:54:10.561167
[0m07:54:10.565060 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 07:54:10.521628 => 07:54:10.564022
[0m07:54:10.566419 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m07:54:10.567723 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m07:54:10.782887 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m07:54:10.784859 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m07:54:10.786798 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:54:10.788056 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m07:54:10.790315 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:54:10.792867 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m07:54:10.795056 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m07:54:10.797594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:54:10.818933 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m07:54:10.821179 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:54:10.822691 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:54:10.824427 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m07:54:10.826063 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:54:10.828276 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVG(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m07:54:10.834069 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m07:54:10.848618 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:54:10.849874 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m07:54:10.851768 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:54:10.859420 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:54:10.860695 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m07:54:10.862662 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:54:10.900825 [debug] [Thread-2  ]: SQL status: SELECT 6 in 0.0 seconds
[0m07:54:10.899493 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m07:54:10.913390 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:54:10.914956 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:54:10.916357 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m07:54:10.917904 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m07:54:10.920201 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:54:10.930580 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:54:10.932070 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m07:54:10.934010 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:54:10.944326 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m07:54:10.948540 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:54:10.960818 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:54:10.967994 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m07:54:10.972747 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m07:54:10.988652 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m07:54:10.991583 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m07:54:11.000314 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m07:54:11.002090 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m07:54:11.009663 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m07:54:11.011601 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m07:54:11.016754 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m07:54:11.022279 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 07:54:10.579957 => 07:54:11.021212
[0m07:54:11.023884 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m07:54:11.026718 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e27712a-5ab5-4757-a6a3-4aacc2a200e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b8365d90>]}
[0m07:54:11.028731 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m07:54:11.030853 [info ] [Thread-1  ]: 1 of 3 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.52s]
[0m07:54:11.035289 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 07:54:10.568715 => 07:54:11.034498
[0m07:54:11.037892 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m07:54:11.040391 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m07:54:11.044310 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m07:54:11.053080 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e27712a-5ab5-4757-a6a3-4aacc2a200e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b8395910>]}
[0m07:54:11.051494 [info ] [Thread-3  ]: 3 of 3 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m07:54:11.059970 [info ] [Thread-2  ]: 2 of 3 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 0.54s]
[0m07:54:11.066603 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m07:54:11.068886 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m07:54:11.071287 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m07:54:11.085678 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m07:54:11.089294 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 07:54:11.073056 => 07:54:11.088060
[0m07:54:11.092071 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m07:54:11.104705 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m07:54:11.106460 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:54:11.109793 [debug] [Thread-3  ]: On model.traffic_data.merged_id: BEGIN
[0m07:54:11.111933 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m07:54:11.136637 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m07:54:11.137786 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m07:54:11.139027 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT * FROM vehicles AS v
    RIGHT JOIN "traffic"."traffic_schema"."trajectory_summary" AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m07:54:11.144235 [debug] [Thread-3  ]: Postgres adapter: Postgres error: column "track_id" specified more than once

[0m07:54:11.146408 [debug] [Thread-3  ]: On model.traffic_data.merged_id: ROLLBACK
[0m07:54:11.149010 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 07:54:11.093697 => 07:54:11.148328
[0m07:54:11.150080 [debug] [Thread-3  ]: On model.traffic_data.merged_id: Close
[0m07:54:11.154440 [debug] [Thread-3  ]: Database Error in model merged_id (models/merged_id.sql)
  column "track_id" specified more than once
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:54:11.155711 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e27712a-5ab5-4757-a6a3-4aacc2a200e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b8315250>]}
[0m07:54:11.158411 [error] [Thread-3  ]: 3 of 3 ERROR creating sql table model traffic_schema.merged_id ................. [[31mERROR[0m in 0.09s]
[0m07:54:11.160738 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m07:54:11.164994 [debug] [MainThread]: Using postgres connection "master"
[0m07:54:11.167038 [debug] [MainThread]: On master: BEGIN
[0m07:54:11.168585 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:54:11.193920 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:54:11.196502 [debug] [MainThread]: On master: COMMIT
[0m07:54:11.198810 [debug] [MainThread]: Using postgres connection "master"
[0m07:54:11.200339 [debug] [MainThread]: On master: COMMIT
[0m07:54:11.202036 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:54:11.203837 [debug] [MainThread]: On master: Close
[0m07:54:11.206402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:54:11.208701 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m07:54:11.212359 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m07:54:11.215226 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m07:54:11.217471 [info ] [MainThread]: 
[0m07:54:11.218878 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m07:54:11.221603 [debug] [MainThread]: Command end result
[0m07:54:11.246658 [info ] [MainThread]: 
[0m07:54:11.249665 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:54:11.251633 [info ] [MainThread]: 
[0m07:54:11.252917 [error] [MainThread]:   Database Error in model merged_id (models/merged_id.sql)
  column "track_id" specified more than once
  compiled Code at target/run/traffic_data/models/merged_id.sql
[0m07:54:11.255041 [info ] [MainThread]: 
[0m07:54:11.257415 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:54:11.261438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.103044, "process_user_time": 5.990265, "process_kernel_time": 0.228238, "process_mem_max_rss": "109212", "process_out_blocks": "2416", "command_success": false, "process_in_blocks": "0"}
[0m07:54:11.263952 [debug] [MainThread]: Command `dbt run` failed at 07:54:11.263198 after 2.11 seconds
[0m07:54:11.265562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6bc0dec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b8de1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b8e2d490>]}
[0m07:54:11.266936 [debug] [MainThread]: Flushing usage events
[0m08:01:32.639773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe281b49c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2800ff430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2800ffb50>]}


============================== 08:01:32.648094 | 6cc20afa-e565-4c54-893d-c14f354b3122 ==============================
[0m08:01:32.648094 [info ] [MainThread]: Running with dbt=1.7.13
[0m08:01:32.650087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:01:33.114030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cc20afa-e565-4c54-893d-c14f354b3122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2833bcd90>]}
[0m08:01:33.308941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cc20afa-e565-4c54-893d-c14f354b3122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe28228cd90>]}
[0m08:01:33.310653 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m08:01:33.337497 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m08:01:33.407799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:01:33.409995 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/merged_id.sql
[0m08:01:33.687813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m08:01:33.699300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cc20afa-e565-4c54-893d-c14f354b3122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe27de1ab20>]}
[0m08:01:33.732159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cc20afa-e565-4c54-893d-c14f354b3122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe27e5fc100>]}
[0m08:01:33.734168 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:01:33.735379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cc20afa-e565-4c54-893d-c14f354b3122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe27e746a90>]}
[0m08:01:33.740084 [info ] [MainThread]: 
[0m08:01:33.744351 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:01:33.749819 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m08:01:33.779643 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m08:01:33.780858 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m08:01:33.781811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:33.838534 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m08:01:33.843313 [debug] [ThreadPool]: On list_traffic: Close
[0m08:01:33.851914 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic_traffic_schema'
[0m08:01:33.870380 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m08:01:33.871729 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m08:01:33.872802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:33.894735 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:01:33.896089 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m08:01:33.897244 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m08:01:33.904034 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m08:01:33.907374 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m08:01:33.909858 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m08:01:33.924459 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:33.925650 [debug] [MainThread]: On master: BEGIN
[0m08:01:33.927240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:01:33.948075 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:01:33.949672 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:33.951427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:01:33.962722 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m08:01:33.967025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cc20afa-e565-4c54-893d-c14f354b3122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe27de1acd0>]}
[0m08:01:33.968553 [debug] [MainThread]: On master: ROLLBACK
[0m08:01:33.970176 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:33.971186 [debug] [MainThread]: On master: BEGIN
[0m08:01:33.972650 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:01:33.973606 [debug] [MainThread]: On master: COMMIT
[0m08:01:33.974736 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:33.976569 [debug] [MainThread]: On master: COMMIT
[0m08:01:33.978459 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:01:33.980143 [debug] [MainThread]: On master: Close
[0m08:01:33.982653 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m08:01:33.984034 [info ] [MainThread]: 
[0m08:01:33.989038 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m08:01:33.991145 [info ] [Thread-1  ]: 1 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m08:01:33.993944 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m08:01:33.996128 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m08:01:33.997622 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m08:01:34.000204 [info ] [Thread-2  ]: 2 of 3 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m08:01:34.023702 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_traffic, now model.traffic_data.vehicle_type)
[0m08:01:34.027353 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m08:01:34.044181 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m08:01:34.047910 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 08:01:34.002077 => 08:01:34.046637
[0m08:01:34.052872 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m08:01:34.054655 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m08:01:34.064955 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 08:01:34.034411 => 08:01:34.063549
[0m08:01:34.073074 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m08:01:34.252619 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m08:01:34.266689 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m08:01:34.268532 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m08:01:34.269983 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m08:01:34.271517 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m08:01:34.272922 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m08:01:34.274370 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m08:01:34.275682 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:01:34.297149 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m08:01:34.298377 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:01:34.299656 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m08:01:34.300824 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m08:01:34.302063 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m08:01:34.303746 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVG(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m08:01:34.309122 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:01:34.325539 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m08:01:34.326829 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m08:01:34.329727 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:34.338287 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m08:01:34.340420 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m08:01:34.342595 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:34.352658 [debug] [Thread-2  ]: SQL status: SELECT 6 in 0.0 seconds
[0m08:01:34.372858 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m08:01:34.380229 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m08:01:34.393772 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:34.400259 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m08:01:34.412705 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m08:01:34.414787 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m08:01:34.416079 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m08:01:34.417278 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m08:01:34.419509 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:34.434726 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:01:34.436794 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m08:01:34.448817 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m08:01:34.455984 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m08:01:34.459261 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m08:01:34.471893 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m08:01:34.473295 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m08:01:34.474591 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m08:01:34.483854 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m08:01:34.485439 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m08:01:34.492732 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m08:01:34.498578 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 08:01:34.055903 => 08:01:34.497475
[0m08:01:34.500106 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m08:01:34.501470 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m08:01:34.504450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cc20afa-e565-4c54-893d-c14f354b3122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe27ddb8e20>]}
[0m08:01:34.506798 [info ] [Thread-1  ]: 1 of 3 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.51s]
[0m08:01:34.509344 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:01:34.512166 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m08:01:34.519628 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 08:01:34.080930 => 08:01:34.518442
[0m08:01:34.522179 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m08:01:34.524283 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m08:01:34.526741 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cc20afa-e565-4c54-893d-c14f354b3122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe27e708520>]}
[0m08:01:34.530897 [info ] [Thread-3  ]: 3 of 3 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m08:01:34.537217 [info ] [Thread-2  ]: 2 of 3 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 0.50s]
[0m08:01:34.540667 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m08:01:34.543671 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m08:01:34.556010 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m08:01:34.573828 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m08:01:34.576305 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 08:01:34.558717 => 08:01:34.575210
[0m08:01:34.579307 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m08:01:34.605511 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m08:01:34.610094 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m08:01:34.614454 [debug] [Thread-3  ]: On model.traffic_data.merged_id: BEGIN
[0m08:01:34.617716 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:01:34.645782 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:01:34.647465 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m08:01:34.649281 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT 
    v.track_id,
    v.car_type,
    v.traveled_d,
    v.avg_speed,
    t.max_speed,
    t.max_lat_acc,
    t.max_lon_acc,
    t.average_time
    
    FROM vehicles AS v
    JOIN "traffic"."traffic_schema"."trajectory_summary" AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m08:01:36.137119 [debug] [Thread-3  ]: SQL status: SELECT 607 in 1.0 seconds
[0m08:01:36.149229 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m08:01:36.151750 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id__dbt_tmp" rename to "merged_id"
[0m08:01:36.154626 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:01:36.162463 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m08:01:36.164562 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m08:01:36.166491 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m08:01:36.185829 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:01:36.192740 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."merged_id__dbt_backup"
[0m08:01:36.195411 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m08:01:36.196731 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
drop table if exists "traffic"."traffic_schema"."merged_id__dbt_backup" cascade
[0m08:01:36.198370 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:01:36.203004 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 08:01:34.586665 => 08:01:36.201927
[0m08:01:36.204650 [debug] [Thread-3  ]: On model.traffic_data.merged_id: Close
[0m08:01:36.208022 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cc20afa-e565-4c54-893d-c14f354b3122', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe27ddcf3d0>]}
[0m08:01:36.210029 [info ] [Thread-3  ]: 3 of 3 OK created sql table model traffic_schema.merged_id ..................... [[32mSELECT 607[0m in 1.67s]
[0m08:01:36.211985 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m08:01:36.215414 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:36.218720 [debug] [MainThread]: On master: BEGIN
[0m08:01:36.220808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:01:36.259123 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:01:36.260185 [debug] [MainThread]: On master: COMMIT
[0m08:01:36.261122 [debug] [MainThread]: Using postgres connection "master"
[0m08:01:36.262039 [debug] [MainThread]: On master: COMMIT
[0m08:01:36.263354 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:01:36.264328 [debug] [MainThread]: On master: Close
[0m08:01:36.268345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:01:36.270054 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m08:01:36.271365 [debug] [MainThread]: Connection 'model.traffic_data.trajectory_summary' was properly closed.
[0m08:01:36.273088 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m08:01:36.274994 [info ] [MainThread]: 
[0m08:01:36.276640 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m08:01:36.280221 [debug] [MainThread]: Command end result
[0m08:01:36.410313 [info ] [MainThread]: 
[0m08:01:36.412194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:01:36.413878 [info ] [MainThread]: 
[0m08:01:36.415662 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:01:36.457160 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9622557, "process_user_time": 6.122218, "process_kernel_time": 0.258909, "process_mem_max_rss": "107848", "process_in_blocks": "4920", "process_out_blocks": "2424"}
[0m08:01:36.460520 [debug] [MainThread]: Command `dbt run` succeeded at 08:01:36.459721 after 3.97 seconds
[0m08:01:36.462517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe281b49c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe27e7a8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe27e746970>]}
[0m08:01:36.464690 [debug] [MainThread]: Flushing usage events
[0m09:42:12.647030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a1d5e4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a1bb96250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a1bb969d0>]}


============================== 09:42:12.652283 | 46f45ef9-2c46-4c0f-aa32-06b80db48c90 ==============================
[0m09:42:12.652283 [info ] [MainThread]: Running with dbt=1.7.13
[0m09:42:12.653606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:42:12.654746 [info ] [MainThread]: dbt version: 1.7.13
[0m09:42:12.655706 [info ] [MainThread]: python version: 3.8.10
[0m09:42:12.656779 [info ] [MainThread]: python path: /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/bin/python3
[0m09:42:12.658234 [info ] [MainThread]: os info: Linux-5.15.0-105-generic-x86_64-with-glibc2.29
[0m09:42:12.869704 [info ] [MainThread]: Using profiles dir at /home/yohanes/.dbt
[0m09:42:12.870924 [info ] [MainThread]: Using profiles.yml file at /home/yohanes/.dbt/profiles.yml
[0m09:42:12.871898 [info ] [MainThread]: Using dbt_project.yml file at /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/dbt_project.yml
[0m09:42:12.873134 [info ] [MainThread]: adapter type: postgres
[0m09:42:12.874101 [info ] [MainThread]: adapter version: 1.7.13
[0m09:42:13.054416 [info ] [MainThread]: Configuration:
[0m09:42:13.055540 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:42:13.056916 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:42:13.058490 [info ] [MainThread]: Required dependencies:
[0m09:42:13.059477 [debug] [MainThread]: Executing "git --help"
[0m09:42:13.070211 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:42:13.072777 [debug] [MainThread]: STDERR: "b''"
[0m09:42:13.074617 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:42:13.076362 [info ] [MainThread]: Connection:
[0m09:42:13.078017 [info ] [MainThread]:   host: localhost
[0m09:42:13.080490 [info ] [MainThread]:   port: 5432
[0m09:42:13.084092 [info ] [MainThread]:   user: postgres
[0m09:42:13.085945 [info ] [MainThread]:   database: traffic
[0m09:42:13.088623 [info ] [MainThread]:   schema: traffic_schema
[0m09:42:13.091082 [info ] [MainThread]:   connect_timeout: 10
[0m09:42:13.092643 [info ] [MainThread]:   role: None
[0m09:42:13.094001 [info ] [MainThread]:   search_path: None
[0m09:42:13.095808 [info ] [MainThread]:   keepalives_idle: 0
[0m09:42:13.098762 [info ] [MainThread]:   sslmode: None
[0m09:42:13.100792 [info ] [MainThread]:   sslcert: None
[0m09:42:13.102972 [info ] [MainThread]:   sslkey: None
[0m09:42:13.104943 [info ] [MainThread]:   sslrootcert: None
[0m09:42:13.106931 [info ] [MainThread]:   application_name: dbt
[0m09:42:13.108933 [info ] [MainThread]:   retries: 1
[0m09:42:13.111465 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m09:42:13.115101 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:42:13.117590 [debug] [MainThread]: Using postgres connection "debug"
[0m09:42:13.120041 [debug] [MainThread]: On debug: select 1 as id
[0m09:42:13.122182 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:13.156890 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m09:42:13.160982 [debug] [MainThread]: On debug: Close
[0m09:42:13.162687 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:42:13.165967 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:42:13.169734 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6446687, "process_user_time": 4.654733, "process_kernel_time": 0.163393, "process_mem_max_rss": "95572", "process_in_blocks": "104", "process_out_blocks": "16"}
[0m09:42:13.173282 [debug] [MainThread]: Command `dbt debug` succeeded at 09:42:13.172083 after 0.65 seconds
[0m09:42:13.175202 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:42:13.176707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a1d5e4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a1a206730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a1a321070>]}
[0m09:42:13.178140 [debug] [MainThread]: Flushing usage events
[0m09:42:21.377633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550de71c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550c429430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550c429b50>]}


============================== 09:42:21.383075 | 036929da-3361-4e5c-b653-d95b42f30264 ==============================
[0m09:42:21.383075 [info ] [MainThread]: Running with dbt=1.7.13
[0m09:42:21.384335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:42:21.751149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '036929da-3361-4e5c-b653-d95b42f30264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550f6e4d90>]}
[0m09:42:21.953405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '036929da-3361-4e5c-b653-d95b42f30264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550e5b4d90>]}
[0m09:42:21.955033 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m09:42:21.982794 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m09:42:22.057672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m09:42:22.059029 [debug] [MainThread]: Partial parsing: added file: traffic_data://models/vehicle_info.sql
[0m09:42:22.354024 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m09:42:22.367487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '036929da-3361-4e5c-b653-d95b42f30264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550a141ee0>]}
[0m09:42:22.394617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '036929da-3361-4e5c-b653-d95b42f30264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550a8d0e80>]}
[0m09:42:22.396603 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:42:22.400058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036929da-3361-4e5c-b653-d95b42f30264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550aa6e2b0>]}
[0m09:42:22.407773 [info ] [MainThread]: 
[0m09:42:22.409753 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:42:22.412571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m09:42:22.453770 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m09:42:22.455761 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m09:42:22.457766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:22.485506 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:42:22.488636 [debug] [ThreadPool]: On list_traffic: Close
[0m09:42:22.493946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m09:42:22.510614 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:42:22.511645 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m09:42:22.512506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:22.560264 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:42:22.561797 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:42:22.563413 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m09:42:22.570255 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:42:22.573043 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m09:42:22.574433 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m09:42:22.590067 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:22.591214 [debug] [MainThread]: On master: BEGIN
[0m09:42:22.592101 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:22.612370 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:42:22.613672 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:22.616408 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:42:22.627115 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m09:42:22.631151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036929da-3361-4e5c-b653-d95b42f30264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550a0e7970>]}
[0m09:42:22.634417 [debug] [MainThread]: On master: ROLLBACK
[0m09:42:22.636485 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:22.637536 [debug] [MainThread]: On master: BEGIN
[0m09:42:22.639112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:42:22.640210 [debug] [MainThread]: On master: COMMIT
[0m09:42:22.641255 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:22.642293 [debug] [MainThread]: On master: COMMIT
[0m09:42:22.643503 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:42:22.644633 [debug] [MainThread]: On master: Close
[0m09:42:22.646441 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:42:22.647934 [info ] [MainThread]: 
[0m09:42:22.654357 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m09:42:22.657581 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m09:42:22.660063 [info ] [Thread-1  ]: 1 of 4 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m09:42:22.662113 [info ] [Thread-2  ]: 2 of 4 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m09:42:22.667793 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m09:42:22.669125 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m09:42:22.664406 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m09:42:22.681085 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m09:42:22.691846 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m09:42:22.687059 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m09:42:22.694029 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 09:42:22.682479 => 09:42:22.693323
[0m09:42:22.695369 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 09:42:22.669876 => 09:42:22.694773
[0m09:42:22.696439 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m09:42:22.698858 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m09:42:22.912138 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m09:42:22.926161 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m09:42:22.928738 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:42:22.930354 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m09:42:22.931825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:42:22.934699 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:42:22.937269 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m09:42:22.939489 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:42:22.957262 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:42:22.959515 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:42:22.961262 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVG(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m09:42:22.963692 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m09:42:22.965896 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:42:22.967773 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m09:42:22.970122 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:42:22.989155 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:42:22.990364 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m09:42:22.992257 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:22.998669 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:42:23.000573 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m09:42:23.002579 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:23.040102 [debug] [Thread-2  ]: SQL status: SELECT 6 in 0.0 seconds
[0m09:42:23.053553 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m09:42:23.058077 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:42:23.059465 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:42:23.060919 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m09:42:23.062268 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m09:42:23.064803 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:23.073642 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:42:23.075104 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:42:23.091990 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m09:42:23.096189 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m09:42:23.103988 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:23.110131 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:42:23.122116 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m09:42:23.128012 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m09:42:23.130267 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:42:23.131641 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m09:42:23.135770 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:42:23.140338 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 09:42:22.700228 => 09:42:23.139717
[0m09:42:23.141462 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m09:42:23.143279 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036929da-3361-4e5c-b653-d95b42f30264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5508069fd0>]}
[0m09:42:23.145023 [info ] [Thread-1  ]: 1 of 4 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.48s]
[0m09:42:23.146941 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m09:42:23.148932 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m09:42:23.159910 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m09:42:23.175783 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:42:23.177399 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m09:42:23.178628 [debug] [Thread-1  ]: Began running node model.traffic_data.vehicle_info
[0m09:42:23.179857 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m09:42:23.183453 [info ] [Thread-3  ]: 3 of 4 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m09:42:23.190131 [info ] [Thread-1  ]: 4 of 4 START sql table model traffic_schema.vehicle_info ....................... [RUN]
[0m09:42:23.195580 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m09:42:23.204632 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m09:42:23.207560 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:42:23.199642 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.traffic_data.trajectory_summary, now model.traffic_data.vehicle_info)
[0m09:42:23.222947 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m09:42:23.229756 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 09:42:22.713132 => 09:42:23.228847
[0m09:42:23.231600 [debug] [Thread-1  ]: Began compiling node model.traffic_data.vehicle_info
[0m09:42:23.233941 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m09:42:23.245263 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.vehicle_info"
[0m09:42:23.248763 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036929da-3361-4e5c-b653-d95b42f30264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550a8d0df0>]}
[0m09:42:23.255596 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 09:42:23.209308 => 09:42:23.254814
[0m09:42:23.253911 [info ] [Thread-2  ]: 2 of 4 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 0.58s]
[0m09:42:23.258305 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m09:42:23.260584 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m09:42:23.281046 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m09:42:23.282981 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (compile): 09:42:23.236377 => 09:42:23.282090
[0m09:42:23.286153 [debug] [Thread-1  ]: Began executing node model.traffic_data.vehicle_info
[0m09:42:23.300114 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.vehicle_info"
[0m09:42:23.304096 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:42:23.306215 [debug] [Thread-3  ]: On model.traffic_data.merged_id: BEGIN
[0m09:42:23.307558 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:42:23.309849 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:42:23.312719 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: BEGIN
[0m09:42:23.314079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:42:23.333583 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m09:42:23.336434 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:42:23.338974 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT 
    v.track_id,
    v.car_type,
    v.traveled_d,
    v.avg_speed,
    t.max_speed,
    t.max_lat_acc,
    t.max_lon_acc,
    t.average_time
    
    FROM vehicles AS v
    JOIN "traffic"."traffic_schema"."trajectory_summary" AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m09:42:23.343299 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:42:23.345134 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:42:23.347510 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_info__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_info AS(
    SELECT
    car_type,
    COUNT(car_type) AS 
    AVG(speed) AS average_speed,
    AVG(traveled_d) AS average_disance_traveled,
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"

    FROM "traffic"."traffic_schema"."trajectory_summary"
)

SELECT * FROM vehicle_info
  );
  
[0m09:42:23.351610 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 18:     AVG(speed) AS average_speed,
                ^

[0m09:42:23.354269 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: ROLLBACK
[0m09:42:23.358149 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (execute): 09:42:23.287836 => 09:42:23.356835
[0m09:42:23.360924 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: Close
[0m09:42:23.441035 [debug] [Thread-1  ]: Database Error in model vehicle_info (models/vehicle_info.sql)
  syntax error at or near "("
  LINE 18:     AVG(speed) AS average_speed,
                  ^
  compiled Code at target/run/traffic_data/models/vehicle_info.sql
[0m09:42:23.443500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036929da-3361-4e5c-b653-d95b42f30264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5502d6bdc0>]}
[0m09:42:23.446033 [error] [Thread-1  ]: 4 of 4 ERROR creating sql table model traffic_schema.vehicle_info .............. [[31mERROR[0m in 0.25s]
[0m09:42:23.448807 [debug] [Thread-1  ]: Finished running node model.traffic_data.vehicle_info
[0m09:42:23.717460 [debug] [Thread-3  ]: SQL status: SELECT 607 in 0.0 seconds
[0m09:42:23.726623 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:42:23.727791 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id" rename to "merged_id__dbt_backup"
[0m09:42:23.729565 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:23.739248 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:42:23.740485 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id__dbt_tmp" rename to "merged_id"
[0m09:42:23.742407 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:42:23.747929 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m09:42:23.749125 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:42:23.750172 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m09:42:23.781577 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m09:42:23.852577 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."merged_id__dbt_backup"
[0m09:42:23.855806 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:42:23.857268 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
drop table if exists "traffic"."traffic_schema"."merged_id__dbt_backup" cascade
[0m09:42:23.871481 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:42:23.875850 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 09:42:23.261660 => 09:42:23.875247
[0m09:42:23.877140 [debug] [Thread-3  ]: On model.traffic_data.merged_id: Close
[0m09:42:23.879000 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036929da-3361-4e5c-b653-d95b42f30264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550a0fb280>]}
[0m09:42:23.880884 [info ] [Thread-3  ]: 3 of 4 OK created sql table model traffic_schema.merged_id ..................... [[32mSELECT 607[0m in 0.68s]
[0m09:42:23.883292 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m09:42:23.887562 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:23.889704 [debug] [MainThread]: On master: BEGIN
[0m09:42:23.891482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:42:23.915862 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:42:23.917393 [debug] [MainThread]: On master: COMMIT
[0m09:42:23.919847 [debug] [MainThread]: Using postgres connection "master"
[0m09:42:23.922279 [debug] [MainThread]: On master: COMMIT
[0m09:42:23.925494 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:42:23.927177 [debug] [MainThread]: On master: Close
[0m09:42:23.929217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:23.930753 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_info' was properly closed.
[0m09:42:23.932559 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m09:42:23.933667 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m09:42:23.934807 [info ] [MainThread]: 
[0m09:42:23.936256 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m09:42:23.942095 [debug] [MainThread]: Command end result
[0m09:42:23.965722 [info ] [MainThread]: 
[0m09:42:23.967045 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:42:23.968176 [info ] [MainThread]: 
[0m09:42:23.969531 [error] [MainThread]:   Database Error in model vehicle_info (models/vehicle_info.sql)
  syntax error at or near "("
  LINE 18:     AVG(speed) AS average_speed,
                  ^
  compiled Code at target/run/traffic_data/models/vehicle_info.sql
[0m09:42:23.972841 [info ] [MainThread]: 
[0m09:42:23.975149 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m09:42:23.978995 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7053216, "process_user_time": 6.232762, "process_kernel_time": 0.192146, "process_mem_max_rss": "108564", "process_in_blocks": "208", "process_out_blocks": "2456", "command_success": false}
[0m09:42:23.982167 [debug] [MainThread]: Command `dbt run` failed at 09:42:23.981567 after 2.71 seconds
[0m09:42:23.983881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550de71c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550a141f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f550a9d4160>]}
[0m09:42:23.985164 [debug] [MainThread]: Flushing usage events
[0m09:43:53.635922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f74e9bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f73450430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f73450b50>]}


============================== 09:43:53.640929 | 94a2b852-2c63-4093-85fd-36f5db2f6e12 ==============================
[0m09:43:53.640929 [info ] [MainThread]: Running with dbt=1.7.13
[0m09:43:53.642227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:43:54.001411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94a2b852-2c63-4093-85fd-36f5db2f6e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f7670dd90>]}
[0m09:43:54.193556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94a2b852-2c63-4093-85fd-36f5db2f6e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f755dfd90>]}
[0m09:43:54.195144 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m09:43:54.219904 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m09:43:54.293980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:43:54.295365 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_info.sql
[0m09:43:54.592933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m09:43:54.603923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94a2b852-2c63-4093-85fd-36f5db2f6e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f70f6dee0>]}
[0m09:43:54.631219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94a2b852-2c63-4093-85fd-36f5db2f6e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f7195d460>]}
[0m09:43:54.632633 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:43:54.633819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94a2b852-2c63-4093-85fd-36f5db2f6e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f7195d280>]}
[0m09:43:54.638036 [info ] [MainThread]: 
[0m09:43:54.642472 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:43:54.646516 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m09:43:54.679711 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m09:43:54.682434 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m09:43:54.684979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:43:54.715941 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:43:54.718623 [debug] [ThreadPool]: On list_traffic: Close
[0m09:43:54.724664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m09:43:54.739733 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:43:54.741686 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m09:43:54.743483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:43:54.765901 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:43:54.766992 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:43:54.767943 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m09:43:54.775192 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:43:54.778489 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m09:43:54.779996 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m09:43:54.798356 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:54.799672 [debug] [MainThread]: On master: BEGIN
[0m09:43:54.800813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:43:54.824680 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:43:54.826261 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:54.827779 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:43:54.838773 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m09:43:54.844162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94a2b852-2c63-4093-85fd-36f5db2f6e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f71aa7490>]}
[0m09:43:54.845938 [debug] [MainThread]: On master: ROLLBACK
[0m09:43:54.847822 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:54.849625 [debug] [MainThread]: On master: BEGIN
[0m09:43:54.851955 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:43:54.853515 [debug] [MainThread]: On master: COMMIT
[0m09:43:54.854850 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:54.855910 [debug] [MainThread]: On master: COMMIT
[0m09:43:54.858380 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:43:54.859732 [debug] [MainThread]: On master: Close
[0m09:43:54.861725 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:43:54.863291 [info ] [MainThread]: 
[0m09:43:54.867933 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m09:43:54.869761 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m09:43:54.871894 [info ] [Thread-1  ]: 1 of 4 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m09:43:54.875260 [info ] [Thread-2  ]: 2 of 4 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m09:43:54.878153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m09:43:54.882591 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m09:43:54.886671 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m09:43:54.888455 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m09:43:54.916895 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m09:43:54.922861 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m09:43:54.929250 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 09:43:54.902260 => 09:43:54.927681
[0m09:43:54.932224 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m09:43:54.946442 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 09:43:54.890542 => 09:43:54.944992
[0m09:43:54.959997 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m09:43:55.122635 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m09:43:55.125713 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:43:55.133012 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m09:43:55.139890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:43:55.138333 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m09:43:55.144048 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:43:55.145717 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m09:43:55.147048 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:43:55.164423 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:43:55.166626 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:43:55.167903 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVG(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m09:43:55.171818 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m09:43:55.173181 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:43:55.175325 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:43:55.187390 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m09:43:55.192657 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:43:55.194813 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m09:43:55.198149 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:43:55.205654 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:43:55.207358 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m09:43:55.211097 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:43:55.247633 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m09:43:55.248932 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:43:55.250055 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m09:43:55.251577 [debug] [Thread-2  ]: SQL status: SELECT 6 in 0.0 seconds
[0m09:43:55.261646 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:43:55.262964 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m09:43:55.264727 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:43:55.271440 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:43:55.273089 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:43:55.274834 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m09:43:55.293806 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:43:55.296996 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m09:43:55.317192 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m09:43:55.323835 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:43:55.330951 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m09:43:55.330015 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:43:55.333038 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m09:43:55.339665 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m09:43:55.349321 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m09:43:55.351081 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:43:55.362660 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 09:43:54.967176 => 09:43:55.361703
[0m09:43:55.364439 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:43:55.365969 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m09:43:55.367696 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m09:43:55.370763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94a2b852-2c63-4093-85fd-36f5db2f6e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f70636c10>]}
[0m09:43:55.373094 [info ] [Thread-1  ]: 1 of 4 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.49s]
[0m09:43:55.375085 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m09:43:55.377721 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m09:43:55.379892 [debug] [Thread-1  ]: Began running node model.traffic_data.vehicle_info
[0m09:43:55.382739 [info ] [Thread-3  ]: 3 of 4 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m09:43:55.386403 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:43:55.384495 [info ] [Thread-1  ]: 4 of 4 START sql table model traffic_schema.vehicle_info ....................... [RUN]
[0m09:43:55.388798 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m09:43:55.396693 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 09:43:54.934341 => 09:43:55.395643
[0m09:43:55.399912 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.traffic_data.trajectory_summary, now model.traffic_data.vehicle_info)
[0m09:43:55.401357 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m09:43:55.402505 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m09:43:55.403772 [debug] [Thread-1  ]: Began compiling node model.traffic_data.vehicle_info
[0m09:43:55.412737 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94a2b852-2c63-4093-85fd-36f5db2f6e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f70696fd0>]}
[0m09:43:55.435805 [info ] [Thread-2  ]: 2 of 4 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 0.53s]
[0m09:43:55.433701 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.vehicle_info"
[0m09:43:55.428948 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m09:43:55.439055 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m09:43:55.441468 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (compile): 09:43:55.414951 => 09:43:55.440364
[0m09:43:55.449057 [debug] [Thread-1  ]: Began executing node model.traffic_data.vehicle_info
[0m09:43:55.465893 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 09:43:55.404788 => 09:43:55.464153
[0m09:43:55.468268 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m09:43:55.481408 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.vehicle_info"
[0m09:43:55.500051 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m09:43:55.503282 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:43:55.504702 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: BEGIN
[0m09:43:55.506361 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:43:55.507708 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:43:55.512657 [debug] [Thread-3  ]: On model.traffic_data.merged_id: BEGIN
[0m09:43:55.516315 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:43:55.543171 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:43:55.546039 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:43:55.547916 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_info__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_info AS(
    SELECT
    car_type AS "vehicle_type",
    COUNT(car_type) AS "vehicle_count",
    AVG(speed) AS "average_speed",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"

    FROM "traffic"."traffic_schema"."trajectory_summary"
)

SELECT * FROM vehicle_info
  );
  
[0m09:43:55.549359 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m09:43:55.550968 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:43:55.552725 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "car_type" does not exist
LINE 16:     car_type AS "vehicle_type",
             ^

[0m09:43:55.554172 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT 
    v.track_id,
    v.car_type,
    v.traveled_d,
    v.avg_speed,
    t.max_speed,
    t.max_lat_acc,
    t.max_lon_acc,
    t.average_time
    
    FROM vehicles AS v
    JOIN "traffic"."traffic_schema"."trajectory_summary" AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m09:43:55.557602 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: ROLLBACK
[0m09:43:55.565667 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (execute): 09:43:55.451768 => 09:43:55.564180
[0m09:43:55.568177 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: Close
[0m09:43:55.579932 [debug] [Thread-1  ]: Database Error in model vehicle_info (models/vehicle_info.sql)
  column "car_type" does not exist
  LINE 16:     car_type AS "vehicle_type",
               ^
  compiled Code at target/run/traffic_data/models/vehicle_info.sql
[0m09:43:55.582645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94a2b852-2c63-4093-85fd-36f5db2f6e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f70f2c9a0>]}
[0m09:43:55.585809 [error] [Thread-1  ]: 4 of 4 ERROR creating sql table model traffic_schema.vehicle_info .............. [[31mERROR[0m in 0.18s]
[0m09:43:55.589124 [debug] [Thread-1  ]: Finished running node model.traffic_data.vehicle_info
[0m09:43:55.842372 [debug] [Thread-3  ]: SQL status: SELECT 607 in 0.0 seconds
[0m09:43:55.849993 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:43:55.851361 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id" rename to "merged_id__dbt_backup"
[0m09:43:55.853607 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:43:55.864648 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:43:55.865992 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id__dbt_tmp" rename to "merged_id"
[0m09:43:55.868008 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:43:55.874631 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m09:43:55.876616 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:43:55.878726 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m09:43:55.971728 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m09:43:55.978094 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."merged_id__dbt_backup"
[0m09:43:55.980957 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:43:55.982490 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
drop table if exists "traffic"."traffic_schema"."merged_id__dbt_backup" cascade
[0m09:43:55.996182 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:43:56.002294 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 09:43:55.475018 => 09:43:56.001222
[0m09:43:56.003539 [debug] [Thread-3  ]: On model.traffic_data.merged_id: Close
[0m09:43:56.005451 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94a2b852-2c63-4093-85fd-36f5db2f6e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f705d5190>]}
[0m09:43:56.008441 [info ] [Thread-3  ]: 3 of 4 OK created sql table model traffic_schema.merged_id ..................... [[32mSELECT 607[0m in 0.62s]
[0m09:43:56.010800 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m09:43:56.014569 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:56.017005 [debug] [MainThread]: On master: BEGIN
[0m09:43:56.019269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:43:56.041548 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:43:56.042812 [debug] [MainThread]: On master: COMMIT
[0m09:43:56.046273 [debug] [MainThread]: Using postgres connection "master"
[0m09:43:56.048393 [debug] [MainThread]: On master: COMMIT
[0m09:43:56.050873 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:43:56.052187 [debug] [MainThread]: On master: Close
[0m09:43:56.054809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:43:56.056330 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_info' was properly closed.
[0m09:43:56.057765 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m09:43:56.059386 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m09:43:56.061758 [info ] [MainThread]: 
[0m09:43:56.064982 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m09:43:56.068491 [debug] [MainThread]: Command end result
[0m09:43:56.087138 [info ] [MainThread]: 
[0m09:43:56.088849 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:43:56.090807 [info ] [MainThread]: 
[0m09:43:56.092273 [error] [MainThread]:   Database Error in model vehicle_info (models/vehicle_info.sql)
  column "car_type" does not exist
  LINE 16:     car_type AS "vehicle_type",
               ^
  compiled Code at target/run/traffic_data/models/vehicle_info.sql
[0m09:43:56.095037 [info ] [MainThread]: 
[0m09:43:56.097729 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m09:43:56.102247 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5718799, "process_user_time": 6.194536, "process_kernel_time": 0.215948, "process_mem_max_rss": "108936", "process_out_blocks": "2464", "command_success": false, "process_in_blocks": "0"}
[0m09:43:56.104218 [debug] [MainThread]: Command `dbt run` failed at 09:43:56.103780 after 2.57 seconds
[0m09:43:56.105420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f74e9bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f705ccfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f705d7460>]}
[0m09:43:56.107035 [debug] [MainThread]: Flushing usage events
[0m09:44:57.334930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb920b1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb90666460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb90666b80>]}


============================== 09:44:57.341505 | e265865a-4cec-437b-84f7-60d66c86c69a ==============================
[0m09:44:57.341505 [info ] [MainThread]: Running with dbt=1.7.13
[0m09:44:57.342936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'debug': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:44:57.702863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e265865a-4cec-437b-84f7-60d66c86c69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb93923dc0>]}
[0m09:44:57.899828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e265865a-4cec-437b-84f7-60d66c86c69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8ee07490>]}
[0m09:44:57.901429 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m09:44:57.931536 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m09:44:58.052861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:44:58.055095 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_info.sql
[0m09:44:58.390666 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m09:44:58.402997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e265865a-4cec-437b-84f7-60d66c86c69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8e381f10>]}
[0m09:44:58.428126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e265865a-4cec-437b-84f7-60d66c86c69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8eb72490>]}
[0m09:44:58.430598 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:44:58.432737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e265865a-4cec-437b-84f7-60d66c86c69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8eb722b0>]}
[0m09:44:58.437214 [info ] [MainThread]: 
[0m09:44:58.439755 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:44:58.444977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m09:44:58.483969 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m09:44:58.485954 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m09:44:58.487290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:58.521361 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:44:58.524559 [debug] [ThreadPool]: On list_traffic: Close
[0m09:44:58.532611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic_traffic_schema'
[0m09:44:58.548203 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:44:58.549271 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m09:44:58.550164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:58.570046 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:44:58.571251 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:44:58.572284 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m09:44:58.581377 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:44:58.584635 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m09:44:58.586108 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m09:44:58.603072 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:58.604249 [debug] [MainThread]: On master: BEGIN
[0m09:44:58.605264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:58.627121 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:58.629499 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:58.631794 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:44:58.642737 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m09:44:58.648630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e265865a-4cec-437b-84f7-60d66c86c69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8ea9aa30>]}
[0m09:44:58.650675 [debug] [MainThread]: On master: ROLLBACK
[0m09:44:58.652031 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:58.653006 [debug] [MainThread]: On master: BEGIN
[0m09:44:58.654471 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:58.655446 [debug] [MainThread]: On master: COMMIT
[0m09:44:58.656612 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:58.658408 [debug] [MainThread]: On master: COMMIT
[0m09:44:58.660919 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:58.662729 [debug] [MainThread]: On master: Close
[0m09:44:58.665263 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:44:58.667047 [info ] [MainThread]: 
[0m09:44:58.673381 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m09:44:58.678496 [info ] [Thread-1  ]: 1 of 4 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m09:44:58.681629 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m09:44:58.676071 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m09:44:58.686967 [info ] [Thread-2  ]: 2 of 4 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m09:44:58.683952 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m09:44:58.690667 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_traffic, now model.traffic_data.vehicle_type)
[0m09:44:58.710487 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m09:44:58.731296 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m09:44:58.734726 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m09:44:58.737428 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 09:44:58.692700 => 09:44:58.736380
[0m09:44:58.739463 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 09:44:58.712116 => 09:44:58.738505
[0m09:44:58.741002 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m09:44:58.742652 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m09:44:58.960884 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m09:44:58.973628 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m09:44:58.976255 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:44:58.978515 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:44:58.980413 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m09:44:58.981907 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m09:44:58.983536 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:44:58.985220 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m09:44:59.018571 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:44:59.020050 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m09:44:59.021339 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:44:59.022676 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:44:59.024030 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVG(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m09:44:59.025412 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m09:44:59.031776 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:44:59.047170 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:44:59.048453 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m09:44:59.050606 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:59.057369 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:44:59.058625 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m09:44:59.060516 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:59.097471 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m09:44:59.098751 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:44:59.099875 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m09:44:59.142516 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:44:59.152337 [debug] [Thread-2  ]: SQL status: SELECT 6 in 0.0 seconds
[0m09:44:59.173296 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:44:59.175715 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m09:44:59.176967 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m09:44:59.191423 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:44:59.192962 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:59.194653 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m09:44:59.205284 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:44:59.206990 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m09:44:59.209309 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:59.222098 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m09:44:59.223874 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:44:59.225455 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:44:59.230880 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 09:44:58.743987 => 09:44:59.229787
[0m09:44:59.233069 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m09:44:59.235057 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m09:44:59.237849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e265865a-4cec-437b-84f7-60d66c86c69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8c2abfd0>]}
[0m09:44:59.239867 [info ] [Thread-1  ]: 1 of 4 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.56s]
[0m09:44:59.241813 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m09:44:59.243206 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m09:44:59.256352 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m09:44:59.264993 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m09:44:59.272433 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:44:59.268534 [info ] [Thread-3  ]: 3 of 4 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m09:44:59.274021 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m09:44:59.276755 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m09:44:59.284290 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m09:44:59.295190 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m09:44:59.299923 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 09:44:59.286335 => 09:44:59.298505
[0m09:44:59.302737 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:59.304432 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m09:44:59.308501 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 09:44:58.755127 => 09:44:59.307720
[0m09:44:59.327046 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m09:44:59.326013 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m09:44:59.336225 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e265865a-4cec-437b-84f7-60d66c86c69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8e3104f0>]}
[0m09:44:59.338394 [info ] [Thread-2  ]: 2 of 4 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 0.65s]
[0m09:44:59.341498 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m09:44:59.343235 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:44:59.344659 [debug] [Thread-3  ]: On model.traffic_data.merged_id: BEGIN
[0m09:44:59.348064 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:44:59.370963 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m09:44:59.372629 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:44:59.374144 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT 
    v.track_id,
    v.car_type,
    v.traveled_d,
    v.avg_speed,
    t.max_speed,
    t.max_lat_acc,
    t.max_lon_acc,
    t.average_time
    
    FROM vehicles AS v
    JOIN "traffic"."traffic_schema"."trajectory_summary" AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m09:44:59.659917 [debug] [Thread-3  ]: SQL status: SELECT 607 in 0.0 seconds
[0m09:44:59.668239 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:44:59.669686 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id" rename to "merged_id__dbt_backup"
[0m09:44:59.671660 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:59.678608 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:44:59.680616 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id__dbt_tmp" rename to "merged_id"
[0m09:44:59.683099 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:44:59.688571 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m09:44:59.689861 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:44:59.691078 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m09:44:59.720946 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m09:44:59.728940 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."merged_id__dbt_backup"
[0m09:44:59.732970 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:44:59.734308 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
drop table if exists "traffic"."traffic_schema"."merged_id__dbt_backup" cascade
[0m09:44:59.743436 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:44:59.747018 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 09:44:59.309534 => 09:44:59.746090
[0m09:44:59.749146 [debug] [Thread-3  ]: On model.traffic_data.merged_id: Close
[0m09:44:59.753022 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e265865a-4cec-437b-84f7-60d66c86c69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8c1b9460>]}
[0m09:44:59.755738 [info ] [Thread-3  ]: 3 of 4 OK created sql table model traffic_schema.merged_id ..................... [[32mSELECT 607[0m in 0.48s]
[0m09:44:59.757545 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m09:44:59.759864 [debug] [Thread-1  ]: Began running node model.traffic_data.vehicle_info
[0m09:44:59.761563 [info ] [Thread-1  ]: 4 of 4 START sql table model traffic_schema.vehicle_info ....................... [RUN]
[0m09:44:59.764865 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.traffic_data.trajectory_summary, now model.traffic_data.vehicle_info)
[0m09:44:59.767246 [debug] [Thread-1  ]: Began compiling node model.traffic_data.vehicle_info
[0m09:44:59.780305 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.vehicle_info"
[0m09:44:59.784443 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (compile): 09:44:59.768829 => 09:44:59.783042
[0m09:44:59.787217 [debug] [Thread-1  ]: Began executing node model.traffic_data.vehicle_info
[0m09:44:59.883949 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.vehicle_info"
[0m09:44:59.885736 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:44:59.887098 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: BEGIN
[0m09:44:59.888164 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:44:59.908622 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:44:59.910010 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:44:59.911273 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_info__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_info AS(
    SELECT
    car_type AS "vehicle_type",
    COUNT(car_type) AS "vehicle_count",
    AVG(speed) AS "average_speed",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"

    FROM "traffic"."traffic_schema"."merged_id"
)

SELECT * FROM vehicle_info
  );
  
[0m09:44:59.913588 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "speed" does not exist
LINE 18:     AVG(speed) AS "average_speed",
                 ^

[0m09:44:59.916399 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: ROLLBACK
[0m09:44:59.918829 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (execute): 09:44:59.788178 => 09:44:59.918059
[0m09:44:59.920050 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: Close
[0m09:44:59.925410 [debug] [Thread-1  ]: Database Error in model vehicle_info (models/vehicle_info.sql)
  column "speed" does not exist
  LINE 18:     AVG(speed) AS "average_speed",
                   ^
  compiled Code at target/run/traffic_data/models/vehicle_info.sql
[0m09:44:59.926759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e265865a-4cec-437b-84f7-60d66c86c69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8c200fd0>]}
[0m09:44:59.928220 [error] [Thread-1  ]: 4 of 4 ERROR creating sql table model traffic_schema.vehicle_info .............. [[31mERROR[0m in 0.16s]
[0m09:44:59.929976 [debug] [Thread-1  ]: Finished running node model.traffic_data.vehicle_info
[0m09:44:59.933829 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:59.936626 [debug] [MainThread]: On master: BEGIN
[0m09:44:59.939577 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:59.963319 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:44:59.966699 [debug] [MainThread]: On master: COMMIT
[0m09:44:59.969732 [debug] [MainThread]: Using postgres connection "master"
[0m09:44:59.973013 [debug] [MainThread]: On master: COMMIT
[0m09:44:59.974936 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:44:59.975983 [debug] [MainThread]: On master: Close
[0m09:44:59.977864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:59.979198 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m09:44:59.981155 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_info' was properly closed.
[0m09:44:59.983957 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m09:44:59.986079 [info ] [MainThread]: 
[0m09:44:59.987593 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m09:44:59.990570 [debug] [MainThread]: Command end result
[0m09:45:00.016677 [info ] [MainThread]: 
[0m09:45:00.020336 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:45:00.022621 [info ] [MainThread]: 
[0m09:45:00.025453 [error] [MainThread]:   Database Error in model vehicle_info (models/vehicle_info.sql)
  column "speed" does not exist
  LINE 18:     AVG(speed) AS "average_speed",
                   ^
  compiled Code at target/run/traffic_data/models/vehicle_info.sql
[0m09:45:00.027380 [info ] [MainThread]: 
[0m09:45:00.028753 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m09:45:00.031377 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7988687, "process_user_time": 6.247194, "process_kernel_time": 0.207309, "process_mem_max_rss": "108508", "process_out_blocks": "2472", "command_success": false, "process_in_blocks": "0"}
[0m09:45:00.035108 [debug] [MainThread]: Command `dbt run` failed at 09:45:00.034321 after 2.80 seconds
[0m09:45:00.037321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb920b1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8c1b9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb8c20a160>]}
[0m09:45:00.040326 [debug] [MainThread]: Flushing usage events
[0m09:46:00.807359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb54070ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb52621760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb52621ac0>]}


============================== 09:46:00.813164 | 69804388-a16d-4947-9b3a-659042a4d117 ==============================
[0m09:46:00.813164 [info ] [MainThread]: Running with dbt=1.7.13
[0m09:46:00.814487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/yohanes/.dbt', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:46:01.184996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69804388-a16d-4947-9b3a-659042a4d117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb537a9520>]}
[0m09:46:01.381305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69804388-a16d-4947-9b3a-659042a4d117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5262f820>]}
[0m09:46:01.382968 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m09:46:01.409355 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m09:46:01.485866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:46:01.487598 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_info.sql
[0m09:46:01.767605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m09:46:01.782564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69804388-a16d-4947-9b3a-659042a4d117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5013eee0>]}
[0m09:46:01.811379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69804388-a16d-4947-9b3a-659042a4d117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb50b2b400>]}
[0m09:46:01.814710 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:46:01.816755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69804388-a16d-4947-9b3a-659042a4d117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb50b2b2b0>]}
[0m09:46:01.825884 [info ] [MainThread]: 
[0m09:46:01.831199 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:46:01.836585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m09:46:01.876756 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m09:46:01.880166 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m09:46:01.882341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:01.920142 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:46:01.923787 [debug] [ThreadPool]: On list_traffic: Close
[0m09:46:01.930566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m09:46:01.948366 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:46:01.950203 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m09:46:01.951813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:01.973839 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:46:01.974933 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:46:01.975886 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m09:46:01.983540 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:46:01.986568 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m09:46:01.988005 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m09:46:02.004587 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:02.005651 [debug] [MainThread]: On master: BEGIN
[0m09:46:02.006601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:46:02.027161 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:46:02.029420 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:02.031695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:46:02.041692 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m09:46:02.047514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69804388-a16d-4947-9b3a-659042a4d117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb50d76880>]}
[0m09:46:02.049004 [debug] [MainThread]: On master: ROLLBACK
[0m09:46:02.050510 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:02.051436 [debug] [MainThread]: On master: BEGIN
[0m09:46:02.052773 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:46:02.053684 [debug] [MainThread]: On master: COMMIT
[0m09:46:02.054609 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:02.055484 [debug] [MainThread]: On master: COMMIT
[0m09:46:02.056672 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:46:02.057748 [debug] [MainThread]: On master: Close
[0m09:46:02.060025 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:46:02.061837 [info ] [MainThread]: 
[0m09:46:02.068526 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m09:46:02.070588 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m09:46:02.072486 [info ] [Thread-1  ]: 1 of 4 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m09:46:02.074848 [info ] [Thread-2  ]: 2 of 4 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m09:46:02.077334 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m09:46:02.081874 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m09:46:02.084736 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m09:46:02.086788 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m09:46:02.110449 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m09:46:02.125790 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m09:46:02.128977 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 09:46:02.099494 => 09:46:02.127643
[0m09:46:02.133055 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 09:46:02.088708 => 09:46:02.130775
[0m09:46:02.135564 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m09:46:02.137537 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m09:46:02.329248 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m09:46:02.350285 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m09:46:02.352459 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:46:02.354328 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:46:02.355820 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m09:46:02.357856 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m09:46:02.359976 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:46:02.361741 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:46:02.388998 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:46:02.390361 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m09:46:02.391633 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:46:02.392930 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:46:02.394266 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVG(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m09:46:02.395636 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m09:46:02.403123 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:46:02.420079 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:46:02.421240 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m09:46:02.423312 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:02.430391 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:46:02.432363 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m09:46:02.434378 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:02.470776 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m09:46:02.472060 [debug] [Thread-2  ]: SQL status: SELECT 6 in 0.0 seconds
[0m09:46:02.473142 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:46:02.481576 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:46:02.483851 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m09:46:02.485849 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m09:46:02.489021 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:02.498802 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:46:02.500117 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m09:46:02.502236 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:02.508842 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:46:02.523293 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m09:46:02.530928 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:46:02.538740 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m09:46:02.542340 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m09:46:02.554414 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:46:02.555948 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m09:46:02.557196 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m09:46:02.567444 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m09:46:02.574694 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:46:02.576070 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m09:46:02.580926 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:46:02.584984 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 09:46:02.149443 => 09:46:02.584373
[0m09:46:02.586365 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m09:46:02.588828 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69804388-a16d-4947-9b3a-659042a4d117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb50b2b4f0>]}
[0m09:46:02.591164 [info ] [Thread-1  ]: 1 of 4 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.51s]
[0m09:46:02.593146 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:46:02.595338 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m09:46:02.602228 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 09:46:02.138428 => 09:46:02.600830
[0m09:46:02.603979 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m09:46:02.605913 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m09:46:02.608655 [info ] [Thread-3  ]: 3 of 4 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m09:46:02.613196 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m09:46:02.618769 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69804388-a16d-4947-9b3a-659042a4d117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb50bd4760>]}
[0m09:46:02.620882 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m09:46:02.623686 [info ] [Thread-2  ]: 2 of 4 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 0.54s]
[0m09:46:02.637540 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m09:46:02.640194 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m09:46:02.644205 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 09:46:02.624869 => 09:46:02.642678
[0m09:46:02.648615 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m09:46:02.668046 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m09:46:02.671638 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:46:02.673802 [debug] [Thread-3  ]: On model.traffic_data.merged_id: BEGIN
[0m09:46:02.675958 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:46:02.700806 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m09:46:02.703080 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:46:02.704626 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT 
    v.track_id,
    v.car_type,
    v.traveled_d,
    v.avg_speed,
    t.max_speed,
    t.max_lat_acc,
    t.max_lon_acc,
    t.average_time
    
    FROM vehicles AS v
    JOIN "traffic"."traffic_schema"."trajectory_summary" AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m09:46:02.980662 [debug] [Thread-3  ]: SQL status: SELECT 607 in 0.0 seconds
[0m09:46:02.991218 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:46:02.992978 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id" rename to "merged_id__dbt_backup"
[0m09:46:02.995275 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:03.004042 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:46:03.005246 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id__dbt_tmp" rename to "merged_id"
[0m09:46:03.007467 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:03.012791 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m09:46:03.013908 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:46:03.015709 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m09:46:03.039312 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m09:46:03.047827 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."merged_id__dbt_backup"
[0m09:46:03.051362 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:46:03.052463 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
drop table if exists "traffic"."traffic_schema"."merged_id__dbt_backup" cascade
[0m09:46:03.061720 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:46:03.065282 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 09:46:02.650726 => 09:46:03.064612
[0m09:46:03.067361 [debug] [Thread-3  ]: On model.traffic_data.merged_id: Close
[0m09:46:03.069474 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69804388-a16d-4947-9b3a-659042a4d117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5006f910>]}
[0m09:46:03.071465 [info ] [Thread-3  ]: 3 of 4 OK created sql table model traffic_schema.merged_id ..................... [[32mSELECT 607[0m in 0.46s]
[0m09:46:03.073247 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m09:46:03.075511 [debug] [Thread-1  ]: Began running node model.traffic_data.vehicle_info
[0m09:46:03.077151 [info ] [Thread-1  ]: 4 of 4 START sql table model traffic_schema.vehicle_info ....................... [RUN]
[0m09:46:03.079601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.traffic_data.trajectory_summary, now model.traffic_data.vehicle_info)
[0m09:46:03.081211 [debug] [Thread-1  ]: Began compiling node model.traffic_data.vehicle_info
[0m09:46:03.096056 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.vehicle_info"
[0m09:46:03.098519 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (compile): 09:46:03.082658 => 09:46:03.097258
[0m09:46:03.101851 [debug] [Thread-1  ]: Began executing node model.traffic_data.vehicle_info
[0m09:46:03.203398 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.vehicle_info"
[0m09:46:03.205038 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:46:03.206065 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: BEGIN
[0m09:46:03.207207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:46:03.227787 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:46:03.229355 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:46:03.230935 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_info__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_info AS(
    SELECT
    car_type AS "vehicle_type",
    COUNT(car_type) AS "vehicle_count",
    -- AVG(speed) AS "average_speed",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"

    FROM "traffic"."traffic_schema"."merged_id"
)

SELECT * FROM vehicle_info
  );
  
[0m09:46:03.289557 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "merged_id.car_type" must appear in the GROUP BY clause or be used in an aggregate function
LINE 16:     car_type AS "vehicle_type",
             ^

[0m09:46:03.291578 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: ROLLBACK
[0m09:46:03.293995 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (execute): 09:46:03.104300 => 09:46:03.293254
[0m09:46:03.295284 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: Close
[0m09:46:03.328331 [debug] [Thread-1  ]: Database Error in model vehicle_info (models/vehicle_info.sql)
  column "merged_id.car_type" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 16:     car_type AS "vehicle_type",
               ^
  compiled Code at target/run/traffic_data/models/vehicle_info.sql
[0m09:46:03.329608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69804388-a16d-4947-9b3a-659042a4d117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb50c70700>]}
[0m09:46:03.331060 [error] [Thread-1  ]: 4 of 4 ERROR creating sql table model traffic_schema.vehicle_info .............. [[31mERROR[0m in 0.25s]
[0m09:46:03.333094 [debug] [Thread-1  ]: Finished running node model.traffic_data.vehicle_info
[0m09:46:03.337626 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:03.339872 [debug] [MainThread]: On master: BEGIN
[0m09:46:03.341811 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:46:03.373409 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:46:03.375515 [debug] [MainThread]: On master: COMMIT
[0m09:46:03.376885 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:03.378096 [debug] [MainThread]: On master: COMMIT
[0m09:46:03.379657 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:46:03.380866 [debug] [MainThread]: On master: Close
[0m09:46:03.385899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:03.387720 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_info' was properly closed.
[0m09:46:03.389071 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m09:46:03.390173 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m09:46:03.391649 [info ] [MainThread]: 
[0m09:46:03.393172 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m09:46:03.396045 [debug] [MainThread]: Command end result
[0m09:46:03.420710 [info ] [MainThread]: 
[0m09:46:03.422809 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:46:03.425486 [info ] [MainThread]: 
[0m09:46:03.427478 [error] [MainThread]:   Database Error in model vehicle_info (models/vehicle_info.sql)
  column "merged_id.car_type" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 16:     car_type AS "vehicle_type",
               ^
  compiled Code at target/run/traffic_data/models/vehicle_info.sql
[0m09:46:03.430063 [info ] [MainThread]: 
[0m09:46:03.432355 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m09:46:03.438431 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.7349477, "process_user_time": 6.175633, "process_kernel_time": 0.259816, "process_mem_max_rss": "108408", "process_in_blocks": "88", "process_out_blocks": "2464", "command_success": false}
[0m09:46:03.440197 [debug] [MainThread]: Command `dbt run` failed at 09:46:03.439687 after 2.74 seconds
[0m09:46:03.441912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb54070ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb50a27af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb50be00d0>]}
[0m09:46:03.443322 [debug] [MainThread]: Flushing usage events
[0m09:46:29.589335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ca735b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c8ce13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c8ce1af0>]}


============================== 09:46:29.594369 | 0626259a-c1fb-4a50-9174-6cb701310c88 ==============================
[0m09:46:29.594369 [info ] [MainThread]: Running with dbt=1.7.13
[0m09:46:29.596985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:46:29.967810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0626259a-c1fb-4a50-9174-6cb701310c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c8ce13a0>]}
[0m09:46:30.171515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0626259a-c1fb-4a50-9174-6cb701310c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c8c7a550>]}
[0m09:46:30.173432 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m09:46:30.195185 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m09:46:30.269850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:46:30.272080 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_info.sql
[0m09:46:30.562583 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m09:46:30.577455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0626259a-c1fb-4a50-9174-6cb701310c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c6a07f10>]}
[0m09:46:30.605874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0626259a-c1fb-4a50-9174-6cb701310c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c71f1430>]}
[0m09:46:30.608856 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:46:30.610949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0626259a-c1fb-4a50-9174-6cb701310c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c71f12e0>]}
[0m09:46:30.615658 [info ] [MainThread]: 
[0m09:46:30.620006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:46:30.624643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m09:46:30.672126 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m09:46:30.674470 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m09:46:30.676134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:30.705887 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:46:30.710776 [debug] [ThreadPool]: On list_traffic: Close
[0m09:46:30.715561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m09:46:30.731511 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:46:30.732680 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m09:46:30.733791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:30.759389 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:46:30.760874 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:46:30.762031 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m09:46:30.768991 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:46:30.773732 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m09:46:30.775632 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m09:46:30.792809 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:30.794121 [debug] [MainThread]: On master: BEGIN
[0m09:46:30.795110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:46:30.819149 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:46:30.820320 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:30.821356 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:46:30.831774 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m09:46:30.839286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0626259a-c1fb-4a50-9174-6cb701310c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c733b520>]}
[0m09:46:30.841713 [debug] [MainThread]: On master: ROLLBACK
[0m09:46:30.843572 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:30.844602 [debug] [MainThread]: On master: BEGIN
[0m09:46:30.846160 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:46:30.847207 [debug] [MainThread]: On master: COMMIT
[0m09:46:30.848170 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:30.849113 [debug] [MainThread]: On master: COMMIT
[0m09:46:30.850456 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:46:30.851767 [debug] [MainThread]: On master: Close
[0m09:46:30.854045 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:46:30.855481 [info ] [MainThread]: 
[0m09:46:30.861347 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m09:46:30.863821 [debug] [Thread-2  ]: Began running node model.traffic_data.vehicle_type
[0m09:46:30.866664 [info ] [Thread-1  ]: 1 of 4 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m09:46:30.869809 [info ] [Thread-2  ]: 2 of 4 START sql table model traffic_schema.vehicle_type ....................... [RUN]
[0m09:46:30.873276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m09:46:30.876983 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.traffic_data.vehicle_type'
[0m09:46:30.878994 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m09:46:30.883700 [debug] [Thread-2  ]: Began compiling node model.traffic_data.vehicle_type
[0m09:46:30.918418 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m09:46:30.923749 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 09:46:30.886751 => 09:46:30.921761
[0m09:46:30.926483 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m09:46:30.933717 [debug] [Thread-2  ]: Writing injected SQL for node "model.traffic_data.vehicle_type"
[0m09:46:30.968784 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (compile): 09:46:30.901089 => 09:46:30.967975
[0m09:46:30.975937 [debug] [Thread-2  ]: Began executing node model.traffic_data.vehicle_type
[0m09:46:31.084358 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m09:46:31.095629 [debug] [Thread-2  ]: Writing runtime sql for node "model.traffic_data.vehicle_type"
[0m09:46:31.097997 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:46:31.099806 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m09:46:31.101489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:46:31.104195 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:46:31.107511 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: BEGIN
[0m09:46:31.109401 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m09:46:31.126478 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:46:31.127926 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:46:31.129940 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVG(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m09:46:31.132286 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m09:46:31.134459 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:46:31.136911 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:46:31.139310 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_type__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_summary AS (
    SELECT
    car_type AS "Vehicle type",
    COUNT(car_type) AS "Vehicle count",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"
    FROM Vehicles
    GROUP BY car_type 
    ORDER BY "Vehicle count" ASC
)

SELECT * FROM vehicle_summary
  );
  
[0m09:46:31.158289 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:46:31.159545 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m09:46:31.161386 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:31.168984 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:46:31.170625 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m09:46:31.173032 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:31.208683 [debug] [Thread-2  ]: SQL status: SELECT 6 in 0.0 seconds
[0m09:46:31.210535 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m09:46:31.220950 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:46:31.222853 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:46:31.224218 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type" rename to "vehicle_type__dbt_backup"
[0m09:46:31.225505 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m09:46:31.227793 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:31.235318 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:46:31.236716 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
alter table "traffic"."traffic_schema"."vehicle_type__dbt_tmp" rename to "vehicle_type"
[0m09:46:31.239095 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:31.253039 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m09:46:31.255461 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:46:31.257180 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:46:31.271268 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: COMMIT
[0m09:46:31.282096 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m09:46:31.289851 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
[0m09:46:31.301750 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:46:31.306275 [debug] [Thread-2  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_type__dbt_backup"
[0m09:46:31.308403 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m09:46:31.315447 [debug] [Thread-2  ]: Using postgres connection "model.traffic_data.vehicle_type"
[0m09:46:31.317109 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_type"} */
drop table if exists "traffic"."traffic_schema"."vehicle_type__dbt_backup" cascade
[0m09:46:31.329278 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:46:31.334072 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 09:46:30.927815 => 09:46:31.333234
[0m09:46:31.335634 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m09:46:31.338777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0626259a-c1fb-4a50-9174-6cb701310c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c6165dc0>]}
[0m09:46:31.343563 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:46:31.341958 [info ] [Thread-1  ]: 1 of 4 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.47s]
[0m09:46:31.347759 [debug] [Thread-2  ]: Timing info for model.traffic_data.vehicle_type (execute): 09:46:30.981971 => 09:46:31.347164
[0m09:46:31.350173 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m09:46:31.352501 [debug] [Thread-2  ]: On model.traffic_data.vehicle_type: Close
[0m09:46:31.356528 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m09:46:31.359417 [info ] [Thread-3  ]: 3 of 4 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m09:46:31.363519 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m09:46:31.366364 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m09:46:31.376992 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0626259a-c1fb-4a50-9174-6cb701310c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c69a09d0>]}
[0m09:46:31.379833 [info ] [Thread-2  ]: 2 of 4 OK created sql table model traffic_schema.vehicle_type .................. [[32mSELECT 6[0m in 0.50s]
[0m09:46:31.385277 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m09:46:31.395376 [debug] [Thread-2  ]: Finished running node model.traffic_data.vehicle_type
[0m09:46:31.398076 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 09:46:31.368211 => 09:46:31.396999
[0m09:46:31.400770 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m09:46:31.426832 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m09:46:31.430818 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:46:31.432960 [debug] [Thread-3  ]: On model.traffic_data.merged_id: BEGIN
[0m09:46:31.434379 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:46:31.463987 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m09:46:31.465745 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:46:31.467806 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT 
    v.track_id,
    v.car_type,
    v.traveled_d,
    v.avg_speed,
    t.max_speed,
    t.max_lat_acc,
    t.max_lon_acc,
    t.average_time
    
    FROM vehicles AS v
    JOIN "traffic"."traffic_schema"."trajectory_summary" AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m09:46:31.743566 [debug] [Thread-3  ]: SQL status: SELECT 607 in 0.0 seconds
[0m09:46:31.751591 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:46:31.752775 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id" rename to "merged_id__dbt_backup"
[0m09:46:31.754683 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:31.764910 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:46:31.766500 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id__dbt_tmp" rename to "merged_id"
[0m09:46:31.769131 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:31.778373 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m09:46:31.779643 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:46:31.780705 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m09:46:31.796578 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m09:46:31.806016 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."merged_id__dbt_backup"
[0m09:46:31.811015 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:46:31.812721 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
drop table if exists "traffic"."traffic_schema"."merged_id__dbt_backup" cascade
[0m09:46:31.818947 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:46:31.822266 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 09:46:31.401714 => 09:46:31.821634
[0m09:46:31.824909 [debug] [Thread-3  ]: On model.traffic_data.merged_id: Close
[0m09:46:31.828547 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0626259a-c1fb-4a50-9174-6cb701310c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c40ead90>]}
[0m09:46:31.831266 [info ] [Thread-3  ]: 3 of 4 OK created sql table model traffic_schema.merged_id ..................... [[32mSELECT 607[0m in 0.47s]
[0m09:46:31.832875 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m09:46:31.834416 [debug] [Thread-1  ]: Began running node model.traffic_data.vehicle_info
[0m09:46:31.835831 [info ] [Thread-1  ]: 4 of 4 START sql table model traffic_schema.vehicle_info ....................... [RUN]
[0m09:46:31.837882 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.traffic_data.trajectory_summary, now model.traffic_data.vehicle_info)
[0m09:46:31.840463 [debug] [Thread-1  ]: Began compiling node model.traffic_data.vehicle_info
[0m09:46:31.849413 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.vehicle_info"
[0m09:46:31.851730 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (compile): 09:46:31.841469 => 09:46:31.850852
[0m09:46:31.853012 [debug] [Thread-1  ]: Began executing node model.traffic_data.vehicle_info
[0m09:46:31.953422 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.vehicle_info"
[0m09:46:31.954993 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:46:31.956544 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: BEGIN
[0m09:46:31.958464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:46:31.980666 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:46:31.982577 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:46:31.984218 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_info__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_info AS(
    SELECT
    car_type AS "vehicle_type",
    COUNT(car_type) AS "vehicle_count",
    -- AVG(speed) AS "average_speed",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle"

    FROM "traffic"."traffic_schema"."merged_id"
    GROUP BY car_type
)

SELECT * FROM vehicle_info
  );
  
[0m09:46:32.028244 [debug] [Thread-1  ]: SQL status: SELECT 6 in 0.0 seconds
[0m09:46:32.037715 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:46:32.039151 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */
alter table "traffic"."traffic_schema"."vehicle_info__dbt_tmp" rename to "vehicle_info"
[0m09:46:32.041634 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:46:32.046527 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: COMMIT
[0m09:46:32.047863 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:46:32.049031 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: COMMIT
[0m09:46:32.074598 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:46:32.081281 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_info__dbt_backup"
[0m09:46:32.083674 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:46:32.084734 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */
drop table if exists "traffic"."traffic_schema"."vehicle_info__dbt_backup" cascade
[0m09:46:32.086361 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:46:32.089593 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (execute): 09:46:31.853750 => 09:46:32.088969
[0m09:46:32.091388 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: Close
[0m09:46:32.093202 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0626259a-c1fb-4a50-9174-6cb701310c88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c40893a0>]}
[0m09:46:32.094949 [info ] [Thread-1  ]: 4 of 4 OK created sql table model traffic_schema.vehicle_info .................. [[32mSELECT 6[0m in 0.26s]
[0m09:46:32.096700 [debug] [Thread-1  ]: Finished running node model.traffic_data.vehicle_info
[0m09:46:32.100552 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:32.102434 [debug] [MainThread]: On master: BEGIN
[0m09:46:32.104130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:46:32.131121 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:46:32.132508 [debug] [MainThread]: On master: COMMIT
[0m09:46:32.133496 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:32.134575 [debug] [MainThread]: On master: COMMIT
[0m09:46:32.136204 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:46:32.137418 [debug] [MainThread]: On master: Close
[0m09:46:32.139858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:32.142410 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_info' was properly closed.
[0m09:46:32.144369 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_type' was properly closed.
[0m09:46:32.146068 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m09:46:32.147503 [info ] [MainThread]: 
[0m09:46:32.148940 [info ] [MainThread]: Finished running 1 view model, 3 table models in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m09:46:32.152856 [debug] [MainThread]: Command end result
[0m09:46:32.179171 [info ] [MainThread]: 
[0m09:46:32.181620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:46:32.183600 [info ] [MainThread]: 
[0m09:46:32.185030 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:46:32.187704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.702346, "process_user_time": 6.171194, "process_kernel_time": 0.22397, "process_mem_max_rss": "108260", "process_in_blocks": "16", "process_out_blocks": "2456"}
[0m09:46:32.189369 [debug] [MainThread]: Command `dbt run` succeeded at 09:46:32.188959 after 2.70 seconds
[0m09:46:32.192178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ca735b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c8c7a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c69cedf0>]}
[0m09:46:32.194446 [debug] [MainThread]: Flushing usage events
[0m09:50:01.461570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b040b4b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b02669490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b02669c40>]}


============================== 09:50:01.466519 | e6bec7f4-16e0-4619-86a9-d51a767121e8 ==============================
[0m09:50:01.466519 [info ] [MainThread]: Running with dbt=1.7.13
[0m09:50:01.467807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'profiles_dir': '/home/yohanes/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:50:01.827931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6bec7f4-16e0-4619-86a9-d51a767121e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b05927d30>]}
[0m09:50:02.021665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6bec7f4-16e0-4619-86a9-d51a767121e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b00e04e20>]}
[0m09:50:02.024041 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m09:50:02.046961 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m09:50:02.121529 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m09:50:02.122993 [debug] [MainThread]: Partial parsing: deleted file: traffic_data://models/vehicle_type.sql
[0m09:50:02.132405 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m09:50:02.146500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6bec7f4-16e0-4619-86a9-d51a767121e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b00abc340>]}
[0m09:50:02.149885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6bec7f4-16e0-4619-86a9-d51a767121e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b00b74340>]}
[0m09:50:02.152399 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:50:02.157395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6bec7f4-16e0-4619-86a9-d51a767121e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b00b74400>]}
[0m09:50:02.165254 [info ] [MainThread]: 
[0m09:50:02.168141 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:50:02.175803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic_traffic_schema'
[0m09:50:02.218092 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:50:02.219266 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m09:50:02.220194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:02.252499 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:50:02.253844 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:50:02.256677 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m09:50:02.264809 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m09:50:02.267912 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m09:50:02.269346 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m09:50:02.283734 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:02.284859 [debug] [MainThread]: On master: BEGIN
[0m09:50:02.285818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:02.309111 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:50:02.310201 [debug] [MainThread]: Using postgres connection "master"
[0m09:50:02.311272 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:50:02.321138 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m09:50:02.325905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6bec7f4-16e0-4619-86a9-d51a767121e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b00b740d0>]}
[0m09:50:02.327849 [debug] [MainThread]: On master: ROLLBACK
[0m09:50:02.329890 [debug] [MainThread]: On master: Close
[0m09:50:02.332165 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:50:02.333677 [info ] [MainThread]: 
[0m09:50:02.342080 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m09:50:02.344519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m09:50:02.345859 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m09:50:02.367318 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m09:50:02.369125 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 09:50:02.346673 => 09:50:02.368466
[0m09:50:02.370344 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m09:50:02.372857 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 09:50:02.371525 => 09:50:02.371571
[0m09:50:02.378819 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m09:50:02.381904 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m09:50:02.384433 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m09:50:02.385726 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m09:50:02.395054 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m09:50:02.397460 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 09:50:02.386477 => 09:50:02.396436
[0m09:50:02.398746 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m09:50:02.400102 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 09:50:02.399422 => 09:50:02.399446
[0m09:50:02.402246 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m09:50:02.403996 [debug] [Thread-1  ]: Began running node model.traffic_data.vehicle_info
[0m09:50:02.406515 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.traffic_data.trajectory_summary, now model.traffic_data.vehicle_info)
[0m09:50:02.408719 [debug] [Thread-1  ]: Began compiling node model.traffic_data.vehicle_info
[0m09:50:02.414949 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.vehicle_info"
[0m09:50:02.416615 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (compile): 09:50:02.409516 => 09:50:02.415986
[0m09:50:02.417671 [debug] [Thread-1  ]: Began executing node model.traffic_data.vehicle_info
[0m09:50:02.418920 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (execute): 09:50:02.418349 => 09:50:02.418365
[0m09:50:02.420863 [debug] [Thread-1  ]: Finished running node model.traffic_data.vehicle_info
[0m09:50:02.423245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:02.425554 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_info' was properly closed.
[0m09:50:02.427518 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m09:50:02.431197 [debug] [MainThread]: Command end result
[0m09:50:02.497163 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m09:50:02.498130 [info ] [MainThread]: Building catalog
[0m09:50:02.502114 [debug] [ThreadPool]: Acquiring new postgres connection 'traffic.information_schema'
[0m09:50:02.523109 [debug] [ThreadPool]: Using postgres connection "traffic.information_schema"
[0m09:50:02.525350 [debug] [ThreadPool]: On traffic.information_schema: BEGIN
[0m09:50:02.528149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:02.550617 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:50:02.552289 [debug] [ThreadPool]: Using postgres connection "traffic.information_schema"
[0m09:50:02.553913 [debug] [ThreadPool]: On traffic.information_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "traffic.information_schema"} */

    
    

    select
        'traffic' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('trajectory_summary')) or (upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('merged_id')) or (upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('vehicle_info')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m09:50:02.565630 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m09:50:02.577950 [debug] [ThreadPool]: On traffic.information_schema: ROLLBACK
[0m09:50:02.579373 [debug] [ThreadPool]: On traffic.information_schema: Close
[0m09:50:02.603838 [info ] [MainThread]: Catalog written to /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/target/catalog.json
[0m09:50:02.606779 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.2683086, "process_user_time": 5.16746, "process_kernel_time": 0.202879, "process_mem_max_rss": "103580", "process_in_blocks": "480", "process_out_blocks": "5320"}
[0m09:50:02.609814 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:50:02.609052 after 1.27 seconds
[0m09:50:02.613268 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:50:02.614861 [debug] [MainThread]: Connection 'traffic.information_schema' was properly closed.
[0m09:50:02.616116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b040b4b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b00c2b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b00a9a8b0>]}
[0m09:50:02.617442 [debug] [MainThread]: Flushing usage events
[0m09:50:23.159185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28cc1d2b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ca77f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28ca77fac0>]}


============================== 09:50:23.164722 | c65b58dd-7fd2-43f1-8f9c-1b72c8dc9165 ==============================
[0m09:50:23.164722 [info ] [MainThread]: Running with dbt=1.7.13
[0m09:50:23.166139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:50:23.517596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c65b58dd-7fd2-43f1-8f9c-1b72c8dc9165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28cba58430>]}
[0m09:50:23.713077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c65b58dd-7fd2-43f1-8f9c-1b72c8dc9165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28caffeb20>]}
[0m09:53:28.307993 [error] [MainThread]: Encountered an error:

[0m09:53:28.360515 [error] [MainThread]: Traceback (most recent call last):
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.8/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m09:53:28.364318 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 185.30804, "process_user_time": 4.773027, "process_kernel_time": 0.184503, "process_mem_max_rss": "94352", "process_in_blocks": "480", "process_out_blocks": "2960", "command_success": false}
[0m09:53:28.366688 [debug] [MainThread]: Command `dbt docs serve` failed at 09:53:28.366127 after 185.31 seconds
[0m09:53:28.368046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28cc1d2b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c8e65dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c8d47400>]}
[0m09:53:28.370034 [debug] [MainThread]: Flushing usage events
[0m09:53:38.218129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4310505b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430eab6280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430eab6d30>]}


============================== 09:53:38.223296 | ce765d4e-1aca-4e34-918b-d733c5b05afb ==============================
[0m09:53:38.223296 [info ] [MainThread]: Running with dbt=1.7.13
[0m09:53:38.224676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'profiles_dir': '/home/yohanes/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:53:38.225771 [info ] [MainThread]: dbt version: 1.7.13
[0m09:53:38.226886 [info ] [MainThread]: python version: 3.8.10
[0m09:53:38.228172 [info ] [MainThread]: python path: /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/bin/python3
[0m09:53:38.230038 [info ] [MainThread]: os info: Linux-5.15.0-105-generic-x86_64-with-glibc2.29
[0m09:53:38.417296 [info ] [MainThread]: Using profiles dir at /home/yohanes/.dbt
[0m09:53:38.418555 [info ] [MainThread]: Using profiles.yml file at /home/yohanes/.dbt/profiles.yml
[0m09:53:38.419619 [info ] [MainThread]: Using dbt_project.yml file at /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/dbt_project.yml
[0m09:53:38.420972 [info ] [MainThread]: adapter type: postgres
[0m09:53:38.422049 [info ] [MainThread]: adapter version: 1.7.13
[0m09:53:38.622707 [info ] [MainThread]: Configuration:
[0m09:53:38.623862 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:53:38.624879 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:53:38.625869 [info ] [MainThread]: Required dependencies:
[0m09:53:38.626915 [debug] [MainThread]: Executing "git --help"
[0m09:53:38.637967 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:53:38.640798 [debug] [MainThread]: STDERR: "b''"
[0m09:53:38.643206 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:53:38.645431 [info ] [MainThread]: Connection:
[0m09:53:38.648794 [info ] [MainThread]:   host: localhost
[0m09:53:38.652071 [info ] [MainThread]:   port: 5432
[0m09:53:38.654745 [info ] [MainThread]:   user: postgres
[0m09:53:38.657249 [info ] [MainThread]:   database: traffic
[0m09:53:38.660137 [info ] [MainThread]:   schema: traffic_schema
[0m09:53:38.663193 [info ] [MainThread]:   connect_timeout: 10
[0m09:53:38.665963 [info ] [MainThread]:   role: None
[0m09:53:38.669526 [info ] [MainThread]:   search_path: None
[0m09:53:38.671979 [info ] [MainThread]:   keepalives_idle: 0
[0m09:53:38.674319 [info ] [MainThread]:   sslmode: None
[0m09:53:38.676270 [info ] [MainThread]:   sslcert: None
[0m09:53:38.678497 [info ] [MainThread]:   sslkey: None
[0m09:53:38.682120 [info ] [MainThread]:   sslrootcert: None
[0m09:53:38.684487 [info ] [MainThread]:   application_name: dbt
[0m09:53:38.686870 [info ] [MainThread]:   retries: 1
[0m09:53:38.690120 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m09:53:38.693911 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:53:38.696481 [debug] [MainThread]: Using postgres connection "debug"
[0m09:53:38.699457 [debug] [MainThread]: On debug: select 1 as id
[0m09:53:38.702946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:38.739364 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m09:53:38.744817 [debug] [MainThread]: On debug: Close
[0m09:53:38.752546 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:53:38.756346 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:53:38.764040 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.64505106, "process_user_time": 4.543033, "process_kernel_time": 0.191621, "process_mem_max_rss": "95564", "process_in_blocks": "248", "process_out_blocks": "16"}
[0m09:53:38.769718 [debug] [MainThread]: Command `dbt debug` succeeded at 09:53:38.768942 after 0.65 seconds
[0m09:53:38.773461 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:53:38.776871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4310505b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430d1802b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f430d1a5490>]}
[0m09:53:38.781091 [debug] [MainThread]: Flushing usage events
[0m09:53:47.447531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf1bb7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf01651f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf0165cd0>]}


============================== 09:53:47.453633 | 5b416d39-249d-4606-974f-e77a969c6d07 ==============================
[0m09:53:47.453633 [info ] [MainThread]: Running with dbt=1.7.13
[0m09:53:47.455330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/traffic_data/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:53:47.810995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b416d39-249d-4606-974f-e77a969c6d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf342ad60>]}
[0m09:53:48.002804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b416d39-249d-4606-974f-e77a969c6d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaee9073d0>]}
[0m09:53:48.004472 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m09:53:48.027868 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m09:53:48.098959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:53:48.100981 [debug] [MainThread]: Partial parsing: updated file: traffic_data://models/vehicle_info.sql
[0m09:53:48.401509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m09:53:48.415064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b416d39-249d-4606-974f-e77a969c6d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaedc86b50>]}
[0m09:53:48.442423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b416d39-249d-4606-974f-e77a969c6d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaee8ea130>]}
[0m09:53:48.443832 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:53:48.445021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b416d39-249d-4606-974f-e77a969c6d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaee804790>]}
[0m09:53:48.450987 [info ] [MainThread]: 
[0m09:53:48.456184 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:53:48.460327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m09:53:48.494964 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m09:53:48.496220 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m09:53:48.497239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:48.526639 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m09:53:48.530293 [debug] [ThreadPool]: On list_traffic: Close
[0m09:53:48.536177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic_traffic_schema'
[0m09:53:48.550779 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:53:48.551975 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m09:53:48.552974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:48.575902 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:53:48.576975 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m09:53:48.577928 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m09:53:48.585009 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m09:53:48.588070 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m09:53:48.589606 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m09:53:48.605047 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:48.607272 [debug] [MainThread]: On master: BEGIN
[0m09:53:48.608660 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:48.631733 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:53:48.632958 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:48.634855 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:53:48.644824 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m09:53:48.649264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b416d39-249d-4606-974f-e77a969c6d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaedc86d00>]}
[0m09:53:48.651813 [debug] [MainThread]: On master: ROLLBACK
[0m09:53:48.654226 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:48.655356 [debug] [MainThread]: On master: BEGIN
[0m09:53:48.656936 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:53:48.658027 [debug] [MainThread]: On master: COMMIT
[0m09:53:48.659053 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:48.660052 [debug] [MainThread]: On master: COMMIT
[0m09:53:48.661256 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:53:48.662175 [debug] [MainThread]: On master: Close
[0m09:53:48.664442 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m09:53:48.666256 [info ] [MainThread]: 
[0m09:53:48.672218 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m09:53:48.673778 [info ] [Thread-1  ]: 1 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m09:53:48.675546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m09:53:48.676769 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m09:53:48.697606 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m09:53:48.701846 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 09:53:48.677506 => 09:53:48.699767
[0m09:53:48.704573 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m09:53:48.790142 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m09:53:48.792154 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:53:48.793319 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m09:53:48.794433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:53:48.816387 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:53:48.818521 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:53:48.820016 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVG(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m09:53:48.825256 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:53:48.844073 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:53:48.845381 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m09:53:48.847748 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:53:48.855712 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:53:48.857005 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m09:53:48.859190 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:53:48.894627 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m09:53:48.895904 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:53:48.897021 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m09:53:48.918683 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:53:48.940270 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m09:53:48.950111 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m09:53:48.951651 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m09:53:48.963147 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:53:48.968176 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 09:53:48.706455 => 09:53:48.967271
[0m09:53:48.970722 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m09:53:48.973514 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b416d39-249d-4606-974f-e77a969c6d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaecbdf940>]}
[0m09:53:48.976045 [info ] [Thread-1  ]: 1 of 3 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.30s]
[0m09:53:48.978101 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m09:53:48.980402 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m09:53:48.981705 [info ] [Thread-3  ]: 2 of 3 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m09:53:48.984449 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m09:53:48.987143 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m09:53:48.998906 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m09:53:49.001487 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 09:53:48.988643 => 09:53:49.000272
[0m09:53:49.004252 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m09:53:49.071173 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m09:53:49.072707 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:53:49.073735 [debug] [Thread-3  ]: On model.traffic_data.merged_id: BEGIN
[0m09:53:49.074763 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m09:53:49.096126 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m09:53:49.097821 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:53:49.099454 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT 
    v.track_id,
    v.car_type,
    v.traveled_d,
    v.avg_speed,
    t.max_speed,
    t.max_lat_acc,
    t.max_lon_acc,
    t.average_time
    
    FROM vehicles AS v
    JOIN "traffic"."traffic_schema"."trajectory_summary" AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m09:53:50.113058 [debug] [Thread-3  ]: SQL status: SELECT 607 in 1.0 seconds
[0m09:53:50.119716 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:53:50.120833 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id" rename to "merged_id__dbt_backup"
[0m09:53:50.122838 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:53:50.134436 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:53:50.136122 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id__dbt_tmp" rename to "merged_id"
[0m09:53:50.138265 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:53:50.150494 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m09:53:50.151681 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:53:50.152730 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m09:53:50.188259 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m09:53:50.199849 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."merged_id__dbt_backup"
[0m09:53:50.206279 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m09:53:50.208277 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
drop table if exists "traffic"."traffic_schema"."merged_id__dbt_backup" cascade
[0m09:53:50.231044 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:53:50.236417 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 09:53:49.005677 => 09:53:50.235595
[0m09:53:50.237916 [debug] [Thread-3  ]: On model.traffic_data.merged_id: Close
[0m09:53:50.240986 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b416d39-249d-4606-974f-e77a969c6d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaecbdf940>]}
[0m09:53:50.243711 [info ] [Thread-3  ]: 2 of 3 OK created sql table model traffic_schema.merged_id ..................... [[32mSELECT 607[0m in 1.26s]
[0m09:53:50.245612 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m09:53:50.248196 [debug] [Thread-1  ]: Began running node model.traffic_data.vehicle_info
[0m09:53:50.251217 [info ] [Thread-1  ]: 3 of 3 START sql table model traffic_schema.vehicle_info ....................... [RUN]
[0m09:53:50.254379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.traffic_data.trajectory_summary, now model.traffic_data.vehicle_info)
[0m09:53:50.257570 [debug] [Thread-1  ]: Began compiling node model.traffic_data.vehicle_info
[0m09:53:50.268031 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.vehicle_info"
[0m09:53:50.271369 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (compile): 09:53:50.259078 => 09:53:50.269992
[0m09:53:50.275086 [debug] [Thread-1  ]: Began executing node model.traffic_data.vehicle_info
[0m09:53:50.297873 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.vehicle_info"
[0m09:53:50.299751 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:53:50.301012 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: BEGIN
[0m09:53:50.302549 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:53:50.327205 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:53:50.329354 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:53:50.330937 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_info__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_info AS(
    SELECT
    car_type AS "vehicle_type",
    COUNT(car_type) AS "vehicle_count",
    -- AVG(speed) AS "average_speed",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle",
    ROUND(AVG(CAST(average_time AS NUMERIC)), 2) AS "Avergae time by vehicle"

    FROM "traffic"."traffic_schema"."merged_id"
    GROUP BY car_type
)

SELECT * FROM vehicle_info
  );
  
[0m09:53:50.384671 [debug] [Thread-1  ]: SQL status: SELECT 6 in 0.0 seconds
[0m09:53:50.395057 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:53:50.397470 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */
alter table "traffic"."traffic_schema"."vehicle_info" rename to "vehicle_info__dbt_backup"
[0m09:53:50.399949 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:53:50.408255 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:53:50.409469 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */
alter table "traffic"."traffic_schema"."vehicle_info__dbt_tmp" rename to "vehicle_info"
[0m09:53:50.411198 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:53:50.416191 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: COMMIT
[0m09:53:50.417272 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:53:50.418282 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: COMMIT
[0m09:53:50.431088 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:53:50.441004 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_info__dbt_backup"
[0m09:53:50.443671 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m09:53:50.444736 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */
drop table if exists "traffic"."traffic_schema"."vehicle_info__dbt_backup" cascade
[0m09:53:50.453263 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m09:53:50.457105 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (execute): 09:53:50.277116 => 09:53:50.456207
[0m09:53:50.459349 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: Close
[0m09:53:50.462349 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b416d39-249d-4606-974f-e77a969c6d07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec2fedc0>]}
[0m09:53:50.464874 [info ] [Thread-1  ]: 3 of 3 OK created sql table model traffic_schema.vehicle_info .................. [[32mSELECT 6[0m in 0.21s]
[0m09:53:50.467105 [debug] [Thread-1  ]: Finished running node model.traffic_data.vehicle_info
[0m09:53:50.470243 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:50.471678 [debug] [MainThread]: On master: BEGIN
[0m09:53:50.473650 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:50.499967 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:53:50.501128 [debug] [MainThread]: On master: COMMIT
[0m09:53:50.502133 [debug] [MainThread]: Using postgres connection "master"
[0m09:53:50.503225 [debug] [MainThread]: On master: COMMIT
[0m09:53:50.504667 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:53:50.506154 [debug] [MainThread]: On master: Close
[0m09:53:50.511606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:50.514956 [debug] [MainThread]: Connection 'list_traffic' was properly closed.
[0m09:53:50.516490 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_info' was properly closed.
[0m09:53:50.517716 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m09:53:50.519336 [info ] [MainThread]: 
[0m09:53:50.520624 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m09:53:50.523536 [debug] [MainThread]: Command end result
[0m09:53:50.631644 [info ] [MainThread]: 
[0m09:53:50.633040 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:53:50.634297 [info ] [MainThread]: 
[0m09:53:50.635487 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:53:50.637316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.320118, "process_user_time": 5.978873, "process_kernel_time": 0.24428, "process_mem_max_rss": "107756", "process_out_blocks": "2408", "process_in_blocks": "0"}
[0m09:53:50.638927 [debug] [MainThread]: Command `dbt run` succeeded at 09:53:50.638385 after 3.32 seconds
[0m09:53:50.640536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf1bb7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaee8bd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaee7b8910>]}
[0m09:53:50.642137 [debug] [MainThread]: Flushing usage events
[0m16:37:43.353853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef84abea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8300c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8300cd60>]}


============================== 16:37:43.381022 | daf48089-b719-42b0-8ea8-7d96e963818f ==============================
[0m16:37:43.381022 [info ] [MainThread]: Running with dbt=1.7.13
[0m16:37:43.382676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/yohanes/airflow/dbt/traffic_data/logs', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models merged_id.sql', 'send_anonymous_usage_stats': 'True'}
[0m16:37:44.361179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daf48089-b719-42b0-8ea8-7d96e963818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef841fb8b0>]}
[0m16:37:44.563497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'daf48089-b719-42b0-8ea8-7d96e963818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8178ea90>]}
[0m16:37:44.565115 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m16:37:44.609171 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m16:37:44.883757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:44.885556 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:44.888095 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m16:37:44.903642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'daf48089-b719-42b0-8ea8-7d96e963818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef814dab80>]}
[0m16:37:44.989263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daf48089-b719-42b0-8ea8-7d96e963818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8151d910>]}
[0m16:37:44.990483 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:37:44.991579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daf48089-b719-42b0-8ea8-7d96e963818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8151d7c0>]}
[0m16:37:44.995012 [info ] [MainThread]: 
[0m16:37:44.996836 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:37:45.000176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m16:37:45.036799 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m16:37:45.038260 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m16:37:45.039704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:45.063764 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:37:45.066432 [debug] [ThreadPool]: On list_traffic: Close
[0m16:37:45.071192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m16:37:45.086135 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m16:37:45.087477 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m16:37:45.088533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:45.128061 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:37:45.131436 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m16:37:45.134670 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m16:37:45.305028 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:37:45.309681 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m16:37:45.311827 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m16:37:45.323266 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:45.324436 [debug] [MainThread]: On master: BEGIN
[0m16:37:45.325605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:45.347931 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:37:45.349258 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:45.350384 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:37:45.591354 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:37:45.597452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daf48089-b719-42b0-8ea8-7d96e963818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8165eca0>]}
[0m16:37:45.599076 [debug] [MainThread]: On master: ROLLBACK
[0m16:37:45.600531 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:45.601588 [debug] [MainThread]: On master: BEGIN
[0m16:37:45.603298 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:37:45.604357 [debug] [MainThread]: On master: COMMIT
[0m16:37:45.605360 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:45.606380 [debug] [MainThread]: On master: COMMIT
[0m16:37:45.607816 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:37:45.609281 [debug] [MainThread]: On master: Close
[0m16:37:45.612095 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m16:37:45.613525 [info ] [MainThread]: 
[0m16:37:45.638923 [debug] [Thread-1  ]: Began running node model.traffic_data.merged_id
[0m16:37:45.641562 [info ] [Thread-1  ]: 1 of 1 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m16:37:45.643918 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.merged_id)
[0m16:37:45.645465 [debug] [Thread-1  ]: Began compiling node model.traffic_data.merged_id
[0m16:37:45.665979 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m16:37:45.669123 [debug] [Thread-1  ]: Timing info for model.traffic_data.merged_id (compile): 16:37:45.646207 => 16:37:45.667293
[0m16:37:45.670922 [debug] [Thread-1  ]: Began executing node model.traffic_data.merged_id
[0m16:37:45.757014 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m16:37:45.758641 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m16:37:45.759825 [debug] [Thread-1  ]: On model.traffic_data.merged_id: BEGIN
[0m16:37:45.760948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:37:45.782468 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:37:45.783705 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m16:37:45.784820 [debug] [Thread-1  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT 
    v.track_id,
    v.car_type,
    v.traveled_d,
    v.avg_speed,
    t.max_speed,
    t.max_lat_acc,
    t.max_lon_acc,
    t.average_time
    
    FROM vehicles AS v
    JOIN "traffic"."traffic_schema"."trajectory_summary" AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m16:37:48.486566 [debug] [Thread-1  ]: SQL status: SELECT 607 in 3.0 seconds
[0m16:37:48.507571 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m16:37:48.508845 [debug] [Thread-1  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id" rename to "merged_id__dbt_backup"
[0m16:37:48.531874 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:37:48.546377 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m16:37:48.547554 [debug] [Thread-1  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id__dbt_tmp" rename to "merged_id"
[0m16:37:48.549284 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:37:48.598310 [debug] [Thread-1  ]: On model.traffic_data.merged_id: COMMIT
[0m16:37:48.599461 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m16:37:48.600462 [debug] [Thread-1  ]: On model.traffic_data.merged_id: COMMIT
[0m16:37:48.613108 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:37:48.630322 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."merged_id__dbt_backup"
[0m16:37:48.643799 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.merged_id"
[0m16:37:48.645874 [debug] [Thread-1  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
drop table if exists "traffic"."traffic_schema"."merged_id__dbt_backup" cascade
[0m16:37:48.848354 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:37:48.854221 [debug] [Thread-1  ]: Timing info for model.traffic_data.merged_id (execute): 16:37:45.672278 => 16:37:48.853212
[0m16:37:48.856029 [debug] [Thread-1  ]: On model.traffic_data.merged_id: Close
[0m16:37:48.861313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daf48089-b719-42b0-8ea8-7d96e963818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef816cf5b0>]}
[0m16:37:48.864265 [info ] [Thread-1  ]: 1 of 1 OK created sql table model traffic_schema.merged_id ..................... [[32mSELECT 607[0m in 3.22s]
[0m16:37:48.866354 [debug] [Thread-1  ]: Finished running node model.traffic_data.merged_id
[0m16:37:48.869728 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:48.874699 [debug] [MainThread]: On master: BEGIN
[0m16:37:48.877117 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:48.903928 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:37:48.905828 [debug] [MainThread]: On master: COMMIT
[0m16:37:48.907512 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:48.909004 [debug] [MainThread]: On master: COMMIT
[0m16:37:48.910417 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:37:48.911926 [debug] [MainThread]: On master: Close
[0m16:37:48.919310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:48.920570 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m16:37:48.921677 [info ] [MainThread]: 
[0m16:37:48.922973 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.93 seconds (3.93s).
[0m16:37:48.925749 [debug] [MainThread]: Command end result
[0m16:37:48.951245 [info ] [MainThread]: 
[0m16:37:48.953426 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:48.954784 [info ] [MainThread]: 
[0m16:37:48.956096 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:37:48.957897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.701133, "process_user_time": 5.470842, "process_kernel_time": 0.221247, "process_mem_max_rss": "105252", "process_in_blocks": "5720", "process_out_blocks": "1584"}
[0m16:37:48.959840 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:48.959384 after 5.70 seconds
[0m16:37:48.960995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef84abea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef817909a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef841fb8b0>]}
[0m16:37:48.962221 [debug] [MainThread]: Flushing usage events
[0m16:38:14.091212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ccc0e1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cca6202e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cca620d60>]}


============================== 16:38:14.096033 | 4c1eef10-2ba5-4d3f-af32-e72a7dd34f96 ==============================
[0m16:38:14.096033 [info ] [MainThread]: Running with dbt=1.7.13
[0m16:38:14.097279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/yohanes/.dbt', 'log_path': '/home/yohanes/airflow/dbt/traffic_data/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:14.439438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c1eef10-2ba5-4d3f-af32-e72a7dd34f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ccb74d2e0>]}
[0m16:38:14.613878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c1eef10-2ba5-4d3f-af32-e72a7dd34f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc8d9ea90>]}
[0m16:38:14.615563 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m16:38:14.636974 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m16:38:14.700985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:14.702065 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:14.703453 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m16:38:14.714407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c1eef10-2ba5-4d3f-af32-e72a7dd34f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc8aeab80>]}
[0m16:38:14.741104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c1eef10-2ba5-4d3f-af32-e72a7dd34f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc8b56820>]}
[0m16:38:14.742374 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:38:14.744449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c1eef10-2ba5-4d3f-af32-e72a7dd34f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc8b56ac0>]}
[0m16:38:14.748505 [info ] [MainThread]: 
[0m16:38:14.750721 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:38:14.753655 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic'
[0m16:38:14.781917 [debug] [ThreadPool]: Using postgres connection "list_traffic"
[0m16:38:14.783978 [debug] [ThreadPool]: On list_traffic: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic"} */

    select distinct nspname from pg_namespace
  
[0m16:38:14.785699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:14.809892 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:38:14.813037 [debug] [ThreadPool]: On list_traffic: Close
[0m16:38:14.816882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_traffic, now list_traffic_traffic_schema)
[0m16:38:14.829177 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m16:38:14.830327 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m16:38:14.831261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:14.854533 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:38:14.855830 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m16:38:14.857035 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m16:38:14.864249 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:38:14.867593 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m16:38:14.869560 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m16:38:14.886675 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:14.887701 [debug] [MainThread]: On master: BEGIN
[0m16:38:14.888567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:14.910633 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:38:14.912475 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:14.914390 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:38:14.962252 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m16:38:14.966655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c1eef10-2ba5-4d3f-af32-e72a7dd34f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc8a731f0>]}
[0m16:38:14.968101 [debug] [MainThread]: On master: ROLLBACK
[0m16:38:14.969594 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:14.970804 [debug] [MainThread]: On master: BEGIN
[0m16:38:14.972902 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:38:14.974769 [debug] [MainThread]: On master: COMMIT
[0m16:38:14.976231 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:14.977669 [debug] [MainThread]: On master: COMMIT
[0m16:38:14.979389 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:38:14.980887 [debug] [MainThread]: On master: Close
[0m16:38:14.983438 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m16:38:14.985171 [info ] [MainThread]: 
[0m16:38:14.989998 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m16:38:14.992077 [info ] [Thread-1  ]: 1 of 3 START sql view model traffic_schema.trajectory_summary .................. [RUN]
[0m16:38:14.994460 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m16:38:14.995839 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m16:38:15.015225 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m16:38:15.019726 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 16:38:14.996661 => 16:38:15.017907
[0m16:38:15.021640 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m16:38:15.101352 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.trajectory_summary"
[0m16:38:15.103100 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m16:38:15.104159 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: BEGIN
[0m16:38:15.105146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:38:15.125972 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:38:15.127407 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m16:38:15.128574 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */

  create view "traffic"."traffic_schema"."trajectory_summary__dbt_tmp"
    
    
  as (
    WITH trajectory_summary AS(
    SELECT
        track_id,
        MAX(speed) As max_speed,
        MAX(lat_acc) AS max_lat_acc,
        MAX(lon_acc) AS max_lon_acc,
        AVG(time) AS average_time
    
    FROM trajectory
    GROUP BY track_id
)

SELECT * FROM trajectory_summary
  );
[0m16:38:15.232922 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:38:15.248022 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m16:38:15.249391 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary" rename to "trajectory_summary__dbt_backup"
[0m16:38:15.251809 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:38:15.259204 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m16:38:15.260370 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
alter table "traffic"."traffic_schema"."trajectory_summary__dbt_tmp" rename to "trajectory_summary"
[0m16:38:15.262356 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:38:15.295132 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m16:38:15.296296 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m16:38:15.297314 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: COMMIT
[0m16:38:15.316026 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:38:15.338254 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."trajectory_summary__dbt_backup"
[0m16:38:15.347986 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.trajectory_summary"
[0m16:38:15.349675 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.trajectory_summary"} */
drop view if exists "traffic"."traffic_schema"."trajectory_summary__dbt_backup" cascade
[0m16:38:15.405216 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:38:15.411013 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 16:38:15.022844 => 16:38:15.409907
[0m16:38:15.413000 [debug] [Thread-1  ]: On model.traffic_data.trajectory_summary: Close
[0m16:38:15.415403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c1eef10-2ba5-4d3f-af32-e72a7dd34f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc81e5fa0>]}
[0m16:38:15.417010 [info ] [Thread-1  ]: 1 of 3 OK created sql view model traffic_schema.trajectory_summary ............. [[32mCREATE VIEW[0m in 0.42s]
[0m16:38:15.418923 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m16:38:15.421384 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m16:38:15.423378 [info ] [Thread-3  ]: 2 of 3 START sql table model traffic_schema.merged_id .......................... [RUN]
[0m16:38:15.426988 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m16:38:15.428824 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m16:38:15.440605 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m16:38:15.443218 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 16:38:15.430509 => 16:38:15.442443
[0m16:38:15.444329 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m16:38:15.513344 [debug] [Thread-3  ]: Writing runtime sql for node "model.traffic_data.merged_id"
[0m16:38:15.515306 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m16:38:15.516594 [debug] [Thread-3  ]: On model.traffic_data.merged_id: BEGIN
[0m16:38:15.517790 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:38:15.539606 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m16:38:15.540869 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m16:38:15.542056 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */

  
    

  create  table "traffic"."traffic_schema"."merged_id__dbt_tmp"
  
  
    as
  
  (
    

WITH merged_data AS(
    SELECT 
    v.track_id,
    v.car_type,
    v.traveled_d,
    v.avg_speed,
    t.max_speed,
    t.max_lat_acc,
    t.max_lon_acc,
    t.average_time
    
    FROM vehicles AS v
    JOIN "traffic"."traffic_schema"."trajectory_summary" AS t
    ON v.track_id = t.track_id
)

SELECT * FROM merged_data
  );
  
[0m16:38:15.776252 [debug] [Thread-3  ]: SQL status: SELECT 607 in 0.0 seconds
[0m16:38:15.785060 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m16:38:15.786549 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id" rename to "merged_id__dbt_backup"
[0m16:38:15.788796 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:38:15.795719 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m16:38:15.796910 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
alter table "traffic"."traffic_schema"."merged_id__dbt_tmp" rename to "merged_id"
[0m16:38:15.799334 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:38:15.810979 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m16:38:15.812221 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m16:38:15.813329 [debug] [Thread-3  ]: On model.traffic_data.merged_id: COMMIT
[0m16:38:15.839327 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m16:38:15.845272 [debug] [Thread-3  ]: Applying DROP to: "traffic"."traffic_schema"."merged_id__dbt_backup"
[0m16:38:15.852411 [debug] [Thread-3  ]: Using postgres connection "model.traffic_data.merged_id"
[0m16:38:15.854405 [debug] [Thread-3  ]: On model.traffic_data.merged_id: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.merged_id"} */
drop table if exists "traffic"."traffic_schema"."merged_id__dbt_backup" cascade
[0m16:38:15.862353 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:38:15.867980 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 16:38:15.445221 => 16:38:15.866957
[0m16:38:15.869905 [debug] [Thread-3  ]: On model.traffic_data.merged_id: Close
[0m16:38:15.872683 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c1eef10-2ba5-4d3f-af32-e72a7dd34f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc81ffe80>]}
[0m16:38:15.875392 [info ] [Thread-3  ]: 2 of 3 OK created sql table model traffic_schema.merged_id ..................... [[32mSELECT 607[0m in 0.45s]
[0m16:38:15.877297 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m16:38:15.880125 [debug] [Thread-1  ]: Began running node model.traffic_data.vehicle_info
[0m16:38:15.882575 [info ] [Thread-1  ]: 3 of 3 START sql table model traffic_schema.vehicle_info ....................... [RUN]
[0m16:38:15.885359 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.traffic_data.trajectory_summary, now model.traffic_data.vehicle_info)
[0m16:38:15.887720 [debug] [Thread-1  ]: Began compiling node model.traffic_data.vehicle_info
[0m16:38:15.899829 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.vehicle_info"
[0m16:38:15.903927 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (compile): 16:38:15.889454 => 16:38:15.902732
[0m16:38:15.906357 [debug] [Thread-1  ]: Began executing node model.traffic_data.vehicle_info
[0m16:38:15.920697 [debug] [Thread-1  ]: Writing runtime sql for node "model.traffic_data.vehicle_info"
[0m16:38:15.923547 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m16:38:15.924716 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: BEGIN
[0m16:38:15.925710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:38:15.947108 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:38:15.948278 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m16:38:15.949540 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */

  
    

  create  table "traffic"."traffic_schema"."vehicle_info__dbt_tmp"
  
  
    as
  
  (
    

WITH vehicle_info AS(
    SELECT
    car_type AS "vehicle_type",
    COUNT(car_type) AS "vehicle_count",
    -- AVG(speed) AS "average_speed",
    ROUND(AVG(CAST(traveled_d AS NUMERIC)), 2) AS "Average traveled distance",
    ROUND(AVG(CAST(avg_speed AS NUMERIC)), 2) AS "Avergae speed by vehicle",
    ROUND(AVG(CAST(average_time AS NUMERIC)), 2) AS "Avergae time by vehicle"

    FROM "traffic"."traffic_schema"."merged_id"
    GROUP BY car_type
)

SELECT * FROM vehicle_info
  );
  
[0m16:38:16.173408 [debug] [Thread-1  ]: SQL status: SELECT 6 in 0.0 seconds
[0m16:38:16.181126 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m16:38:16.182612 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */
alter table "traffic"."traffic_schema"."vehicle_info" rename to "vehicle_info__dbt_backup"
[0m16:38:16.184779 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:38:16.193801 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m16:38:16.195028 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */
alter table "traffic"."traffic_schema"."vehicle_info__dbt_tmp" rename to "vehicle_info"
[0m16:38:16.196771 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:38:16.201423 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: COMMIT
[0m16:38:16.202504 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m16:38:16.203517 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: COMMIT
[0m16:38:16.218513 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:38:16.228362 [debug] [Thread-1  ]: Applying DROP to: "traffic"."traffic_schema"."vehicle_info__dbt_backup"
[0m16:38:16.231070 [debug] [Thread-1  ]: Using postgres connection "model.traffic_data.vehicle_info"
[0m16:38:16.232338 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "node_id": "model.traffic_data.vehicle_info"} */
drop table if exists "traffic"."traffic_schema"."vehicle_info__dbt_backup" cascade
[0m16:38:16.274128 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:38:16.277505 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (execute): 16:38:15.907367 => 16:38:16.276912
[0m16:38:16.278699 [debug] [Thread-1  ]: On model.traffic_data.vehicle_info: Close
[0m16:38:16.280558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c1eef10-2ba5-4d3f-af32-e72a7dd34f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc81e5be0>]}
[0m16:38:16.282227 [info ] [Thread-1  ]: 3 of 3 OK created sql table model traffic_schema.vehicle_info .................. [[32mSELECT 6[0m in 0.40s]
[0m16:38:16.284129 [debug] [Thread-1  ]: Finished running node model.traffic_data.vehicle_info
[0m16:38:16.287764 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:16.289911 [debug] [MainThread]: On master: BEGIN
[0m16:38:16.291498 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:16.317202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:38:16.318528 [debug] [MainThread]: On master: COMMIT
[0m16:38:16.319530 [debug] [MainThread]: Using postgres connection "master"
[0m16:38:16.320621 [debug] [MainThread]: On master: COMMIT
[0m16:38:16.322062 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:38:16.323068 [debug] [MainThread]: On master: Close
[0m16:38:16.324670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:16.325705 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_info' was properly closed.
[0m16:38:16.326711 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m16:38:16.328225 [info ] [MainThread]: 
[0m16:38:16.329767 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 1.58 seconds (1.58s).
[0m16:38:16.332365 [debug] [MainThread]: Command end result
[0m16:38:16.348610 [info ] [MainThread]: 
[0m16:38:16.349961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:16.351354 [info ] [MainThread]: 
[0m16:38:16.352958 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:38:16.356428 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3898761, "process_user_time": 5.126126, "process_kernel_time": 0.223048, "process_mem_max_rss": "106512", "process_out_blocks": "1640", "process_in_blocks": "0"}
[0m16:38:16.359389 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:16.358953 after 2.39 seconds
[0m16:38:16.360375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ccc0e1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc8cf34c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cc81328b0>]}
[0m16:38:16.361861 [debug] [MainThread]: Flushing usage events
[0m17:54:06.630918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c5d33fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4278220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c4278d90>]}


============================== 17:54:06.651902 | 757d45ed-db81-45f8-b34b-bf9e3de74fd7 ==============================
[0m17:54:06.651902 [info ] [MainThread]: Running with dbt=1.7.13
[0m17:54:06.654351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/yohanes/airflow/dbt/traffic_data/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:06.656329 [info ] [MainThread]: dbt version: 1.7.13
[0m17:54:06.658144 [info ] [MainThread]: python version: 3.8.10
[0m17:54:06.660099 [info ] [MainThread]: python path: /home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/bin/python3
[0m17:54:06.662083 [info ] [MainThread]: os info: Linux-5.15.0-105-generic-x86_64-with-glibc2.29
[0m17:54:06.851789 [info ] [MainThread]: Using profiles dir at /home/yohanes/.dbt
[0m17:54:06.853367 [info ] [MainThread]: Using profiles.yml file at /home/yohanes/.dbt/profiles.yml
[0m17:54:06.854435 [info ] [MainThread]: Using dbt_project.yml file at /home/yohanes/airflow/dbt/traffic_data/dbt_project.yml
[0m17:54:06.855758 [info ] [MainThread]: adapter type: postgres
[0m17:54:06.856798 [info ] [MainThread]: adapter version: 1.7.13
[0m17:54:07.028532 [info ] [MainThread]: Configuration:
[0m17:54:07.029716 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:54:07.030711 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:54:07.031688 [info ] [MainThread]: Required dependencies:
[0m17:54:07.032678 [debug] [MainThread]: Executing "git --help"
[0m17:54:07.043817 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:54:07.045627 [debug] [MainThread]: STDERR: "b''"
[0m17:54:07.047010 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:54:07.048430 [info ] [MainThread]: Connection:
[0m17:54:07.050002 [info ] [MainThread]:   host: localhost
[0m17:54:07.051810 [info ] [MainThread]:   port: 5432
[0m17:54:07.053445 [info ] [MainThread]:   user: postgres
[0m17:54:07.054480 [info ] [MainThread]:   database: traffic
[0m17:54:07.055417 [info ] [MainThread]:   schema: traffic_schema
[0m17:54:07.056345 [info ] [MainThread]:   connect_timeout: 10
[0m17:54:07.057336 [info ] [MainThread]:   role: None
[0m17:54:07.058380 [info ] [MainThread]:   search_path: None
[0m17:54:07.059563 [info ] [MainThread]:   keepalives_idle: 0
[0m17:54:07.060600 [info ] [MainThread]:   sslmode: None
[0m17:54:07.061594 [info ] [MainThread]:   sslcert: None
[0m17:54:07.062540 [info ] [MainThread]:   sslkey: None
[0m17:54:07.063479 [info ] [MainThread]:   sslrootcert: None
[0m17:54:07.064553 [info ] [MainThread]:   application_name: dbt
[0m17:54:07.065642 [info ] [MainThread]:   retries: 1
[0m17:54:07.066889 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m17:54:07.069242 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:54:07.070591 [debug] [MainThread]: Using postgres connection "debug"
[0m17:54:07.071898 [debug] [MainThread]: On debug: select 1 as id
[0m17:54:07.073013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:07.096805 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:54:07.099345 [debug] [MainThread]: On debug: Close
[0m17:54:07.100913 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:54:07.102508 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:54:07.106069 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6142827, "process_user_time": 4.526587, "process_kernel_time": 0.203218, "process_mem_max_rss": "97052", "process_in_blocks": "24", "process_out_blocks": "24"}
[0m17:54:07.108606 [debug] [MainThread]: Command `dbt debug` succeeded at 17:54:07.107634 after 0.62 seconds
[0m17:54:07.111192 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:54:07.114163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c5d33fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c42df3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9c29d3ca0>]}
[0m17:54:07.116461 [debug] [MainThread]: Flushing usage events
[0m18:37:43.613479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f87b1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f6cf0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f6cf0ee0>]}


============================== 18:37:43.636583 | 607fdb77-8a3f-418d-a337-9c5fc2980685 ==============================
[0m18:37:43.636583 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:37:43.638065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/airflow/dbt/traffic_data/logs', 'profiles_dir': '/home/yohanes/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m18:37:43.640240 [error] [MainThread]: Encountered an error:
unhashable type: 'dict'
[0m18:37:43.703344 [error] [MainThread]: Traceback (most recent call last):
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 166, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/config/runtime.py", line 70, in load_profile
    profile = Profile.render(
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/config/profile.py", line 390, in from_raw_profiles
    if profile_name not in raw_profiles:
TypeError: unhashable type: 'dict'

[0m18:37:43.705374 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.24189645, "process_user_time": 4.206061, "process_kernel_time": 0.183566, "process_mem_max_rss": "87808", "process_in_blocks": "288", "process_out_blocks": "16", "command_success": false}
[0m18:37:43.706896 [debug] [MainThread]: Command `dbt docs generate` failed at 18:37:43.706537 after 0.24 seconds
[0m18:37:43.707846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f87b1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f6cf0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f6d5dfa0>]}
[0m18:37:43.708846 [debug] [MainThread]: Flushing usage events
[0m18:37:53.726082 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:38:53.813042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecf2b39a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecd7fe3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecd7feb50>]}


============================== 18:38:53.818050 | ddce97f8-7e5b-410d-8417-305f8d7c5d1d ==============================
[0m18:38:53.818050 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:38:53.819452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/airflow/dbt/traffic_data/logs', 'version_check': 'True', 'profiles_dir': '/home/yohanes/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:38:53.822096 [error] [MainThread]: Encountered an error:
unhashable type: 'dict'
[0m18:38:53.824988 [error] [MainThread]: Traceback (most recent call last):
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 166, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/config/runtime.py", line 70, in load_profile
    profile = Profile.render(
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/config/profile.py", line 390, in from_raw_profiles
    if profile_name not in raw_profiles:
TypeError: unhashable type: 'dict'

[0m18:38:53.827326 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.11430796, "process_user_time": 4.228205, "process_kernel_time": 0.135749, "process_mem_max_rss": "87808", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m18:38:53.829454 [debug] [MainThread]: Command `dbt docs generate` failed at 18:38:53.828967 after 0.12 seconds
[0m18:38:53.830764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecf2b39a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecd86b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecd86bf40>]}
[0m18:38:53.832496 [debug] [MainThread]: Flushing usage events
[0m18:39:03.847466 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:39:21.916439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c42121a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4066f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c4066f9a0>]}


============================== 18:39:21.921781 | 87ab36cf-eaef-4e88-a41e-8dfc2cc924db ==============================
[0m18:39:21.921781 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:39:21.923027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/yohanes/airflow/dbt/traffic_data/logs', 'profiles_dir': '/home/yohanes/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:39:21.925205 [error] [MainThread]: Encountered an error:
unhashable type: 'dict'
[0m18:39:21.926895 [error] [MainThread]: Traceback (most recent call last):
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 166, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/config/runtime.py", line 70, in load_profile
    profile = Profile.render(
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/config/profile.py", line 390, in from_raw_profiles
    if profile_name not in raw_profiles:
TypeError: unhashable type: 'dict'

[0m18:39:21.929865 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.11082344, "process_user_time": 4.18221, "process_kernel_time": 0.159626, "process_mem_max_rss": "87896", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m18:39:21.933628 [debug] [MainThread]: Command `dbt docs generate` failed at 18:39:21.932839 after 0.11 seconds
[0m18:39:21.935630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c42121a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c406dc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c406dcf10>]}
[0m18:39:21.937550 [debug] [MainThread]: Flushing usage events
[0m18:39:31.954272 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:39:50.395300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e65e3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e4b1b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e4b1ba60>]}


============================== 18:39:50.400190 | 2dccacd0-2727-4622-8178-38b33df3ad08 ==============================
[0m18:39:50.400190 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:39:50.401712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/yohanes/airflow/dbt/traffic_data/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:39:50.404872 [error] [MainThread]: Encountered an error:
unhashable type: 'dict'
[0m18:39:50.407568 [error] [MainThread]: Traceback (most recent call last):
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 166, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/config/runtime.py", line 70, in load_profile
    profile = Profile.render(
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/config/profile.py", line 390, in from_raw_profiles
    if profile_name not in raw_profiles:
TypeError: unhashable type: 'dict'

[0m18:39:50.410121 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.11240048, "process_user_time": 4.060463, "process_kernel_time": 0.187467, "process_mem_max_rss": "87584", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m18:39:50.411787 [debug] [MainThread]: Command `dbt docs generate` failed at 18:39:50.411395 after 0.11 seconds
[0m18:39:50.413000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e65e3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e4b1bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e4b8fee0>]}
[0m18:39:50.415196 [debug] [MainThread]: Flushing usage events
[0m18:40:00.429802 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:40:18.424017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17c5b87fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17c40bf4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17c40bfa60>]}


============================== 18:40:18.431047 | 6fd73627-4409-4e59-8080-b41362367777 ==============================
[0m18:40:18.431047 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:40:18.432555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/yohanes/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/airflow/dbt/traffic_data/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:40:19.198450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fd73627-4409-4e59-8080-b41362367777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17c5365190>]}
[0m18:40:19.393847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fd73627-4409-4e59-8080-b41362367777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17c40d3100>]}
[0m18:40:19.396260 [info ] [MainThread]: Registered adapter: postgres=1.7.13
[0m18:40:19.444123 [debug] [MainThread]: checksum: 6c24e2ee36a42cedd7e5de2827d214776eb7a8e8f425f6d8acb06c31add0afef, vars: {}, profile: , target: , version: 1.7.13
[0m18:40:19.657403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:40:19.658481 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:40:19.659876 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.traffic_data.example
[0m18:40:19.671911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fd73627-4409-4e59-8080-b41362367777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17c259fcd0>]}
[0m18:40:19.675868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fd73627-4409-4e59-8080-b41362367777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17c260eaf0>]}
[0m18:40:19.677338 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:40:19.679221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fd73627-4409-4e59-8080-b41362367777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17c260eb20>]}
[0m18:40:19.686652 [info ] [MainThread]: 
[0m18:40:19.689322 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:40:19.691882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_traffic_traffic_schema'
[0m18:40:19.733255 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:40:19.735054 [debug] [ThreadPool]: On list_traffic_traffic_schema: BEGIN
[0m18:40:19.736953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:19.786836 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:40:19.788406 [debug] [ThreadPool]: Using postgres connection "list_traffic_traffic_schema"
[0m18:40:19.789869 [debug] [ThreadPool]: On list_traffic_traffic_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "list_traffic_traffic_schema"} */
select
      'traffic' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'traffic_schema'
    union all
    select
      'traffic' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'traffic_schema'
  
[0m18:40:19.996779 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:40:20.000352 [debug] [ThreadPool]: On list_traffic_traffic_schema: ROLLBACK
[0m18:40:20.002810 [debug] [ThreadPool]: On list_traffic_traffic_schema: Close
[0m18:40:20.015715 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:20.017070 [debug] [MainThread]: On master: BEGIN
[0m18:40:20.018776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:40:20.040958 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:40:20.042672 [debug] [MainThread]: Using postgres connection "master"
[0m18:40:20.044601 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:40:20.097095 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:40:20.101107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fd73627-4409-4e59-8080-b41362367777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17c28328b0>]}
[0m18:40:20.102232 [debug] [MainThread]: On master: ROLLBACK
[0m18:40:20.103462 [debug] [MainThread]: On master: Close
[0m18:40:20.105970 [info ] [MainThread]: Concurrency: 3 threads (target='dev')
[0m18:40:20.107991 [info ] [MainThread]: 
[0m18:40:20.152263 [debug] [Thread-1  ]: Began running node model.traffic_data.trajectory_summary
[0m18:40:20.153950 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_traffic_traffic_schema, now model.traffic_data.trajectory_summary)
[0m18:40:20.155079 [debug] [Thread-1  ]: Began compiling node model.traffic_data.trajectory_summary
[0m18:40:20.169109 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.trajectory_summary"
[0m18:40:20.187753 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (compile): 18:40:20.155779 => 18:40:20.186954
[0m18:40:20.188900 [debug] [Thread-1  ]: Began executing node model.traffic_data.trajectory_summary
[0m18:40:20.190107 [debug] [Thread-1  ]: Timing info for model.traffic_data.trajectory_summary (execute): 18:40:20.189544 => 18:40:20.189563
[0m18:40:20.192026 [debug] [Thread-1  ]: Finished running node model.traffic_data.trajectory_summary
[0m18:40:20.194425 [debug] [Thread-3  ]: Began running node model.traffic_data.merged_id
[0m18:40:20.197346 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.traffic_data.merged_id'
[0m18:40:20.199779 [debug] [Thread-3  ]: Began compiling node model.traffic_data.merged_id
[0m18:40:20.207458 [debug] [Thread-3  ]: Writing injected SQL for node "model.traffic_data.merged_id"
[0m18:40:20.209144 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (compile): 18:40:20.200959 => 18:40:20.208508
[0m18:40:20.210157 [debug] [Thread-3  ]: Began executing node model.traffic_data.merged_id
[0m18:40:20.211322 [debug] [Thread-3  ]: Timing info for model.traffic_data.merged_id (execute): 18:40:20.210781 => 18:40:20.210797
[0m18:40:20.213212 [debug] [Thread-3  ]: Finished running node model.traffic_data.merged_id
[0m18:40:20.215297 [debug] [Thread-1  ]: Began running node model.traffic_data.vehicle_info
[0m18:40:20.217616 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.traffic_data.trajectory_summary, now model.traffic_data.vehicle_info)
[0m18:40:20.219137 [debug] [Thread-1  ]: Began compiling node model.traffic_data.vehicle_info
[0m18:40:20.225623 [debug] [Thread-1  ]: Writing injected SQL for node "model.traffic_data.vehicle_info"
[0m18:40:20.227331 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (compile): 18:40:20.219883 => 18:40:20.226657
[0m18:40:20.228376 [debug] [Thread-1  ]: Began executing node model.traffic_data.vehicle_info
[0m18:40:20.230395 [debug] [Thread-1  ]: Timing info for model.traffic_data.vehicle_info (execute): 18:40:20.229283 => 18:40:20.229308
[0m18:40:20.234179 [debug] [Thread-1  ]: Finished running node model.traffic_data.vehicle_info
[0m18:40:20.236667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:20.237747 [debug] [MainThread]: Connection 'model.traffic_data.vehicle_info' was properly closed.
[0m18:40:20.238641 [debug] [MainThread]: Connection 'model.traffic_data.merged_id' was properly closed.
[0m18:40:20.241183 [debug] [MainThread]: Command end result
[0m18:40:20.469942 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:40:20.471174 [info ] [MainThread]: Building catalog
[0m18:40:20.476066 [debug] [ThreadPool]: Acquiring new postgres connection 'traffic.information_schema'
[0m18:40:20.500458 [debug] [ThreadPool]: Using postgres connection "traffic.information_schema"
[0m18:40:20.502941 [debug] [ThreadPool]: On traffic.information_schema: BEGIN
[0m18:40:20.505068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:20.527788 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:40:20.529595 [debug] [ThreadPool]: Using postgres connection "traffic.information_schema"
[0m18:40:20.531700 [debug] [ThreadPool]: On traffic.information_schema: /* {"app": "dbt", "dbt_version": "1.7.13", "profile_name": "traffic_data", "target_name": "dev", "connection_name": "traffic.information_schema"} */

    
    

    select
        'traffic' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('trajectory_summary')) or (upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('vehicle_info')) or (upper(sch.nspname) = upper('traffic_schema') and
           upper(tbl.relname) = upper('merged_id')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:40:20.640623 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:40:20.646334 [debug] [ThreadPool]: On traffic.information_schema: ROLLBACK
[0m18:40:20.647872 [debug] [ThreadPool]: On traffic.information_schema: Close
[0m18:40:20.675155 [info ] [MainThread]: Catalog written to /home/yohanes/airflow/dbt/traffic_data/target/catalog.json
[0m18:40:20.677231 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.3637261, "process_user_time": 5.037027, "process_kernel_time": 0.230946, "process_mem_max_rss": "104572", "process_in_blocks": "6136", "process_out_blocks": "4544"}
[0m18:40:20.679309 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:40:20.678731 after 2.37 seconds
[0m18:40:20.681009 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:40:20.684865 [debug] [MainThread]: Connection 'traffic.information_schema' was properly closed.
[0m18:40:20.686938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17c5b87fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17c04a5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17c40d3100>]}
[0m18:40:20.689091 [debug] [MainThread]: Flushing usage events
[0m18:40:30.706119 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m18:40:41.768880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eac1c1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa7002e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa700d60>]}


============================== 18:40:41.773761 | 6d160063-5d81-48d1-a31a-d9483c4292ad ==============================
[0m18:40:41.773761 [info ] [MainThread]: Running with dbt=1.7.13
[0m18:40:41.775022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/yohanes/airflow/dbt/traffic_data/logs', 'profiles_dir': '/home/yohanes/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:40:42.140742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d160063-5d81-48d1-a31a-d9483c4292ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eaa747fd0>]}
[0m18:40:42.325801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d160063-5d81-48d1-a31a-d9483c4292ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea8e70a90>]}
[0m18:41:50.310421 [error] [MainThread]: Encountered an error:

[0m18:41:50.462591 [error] [MainThread]: Traceback (most recent call last):
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/home/yohanes/Documents/10academy/week2_2/10ac_city_traffic_data_warehouse_week2/week2_env/lib/python3.8/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.8/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m18:41:50.465011 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 68.81769, "process_user_time": 4.619622, "process_kernel_time": 0.220363, "process_mem_max_rss": "96044", "process_in_blocks": "736", "process_out_blocks": "2960", "command_success": false}
[0m18:41:50.466815 [debug] [MainThread]: Command `dbt docs serve` failed at 18:41:50.466413 after 68.82 seconds
[0m18:41:50.467912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eac1c1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea8d2beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea8d0dc70>]}
[0m18:41:50.469415 [debug] [MainThread]: Flushing usage events
[0m18:42:00.486036 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
